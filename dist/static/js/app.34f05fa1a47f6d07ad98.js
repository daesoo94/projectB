webpackJsonp([1],{"+F07":function(e,t){e.exports={id:"item-sword1",width:16,height:16,animations:{idle:{length:6,row:0}},offset_x:0,offset_y:0}},"+rbd":function(e,t){e.exports={id:"agent",width:24,height:24,animations:{idle_down:{length:2,row:0}},offset_x:-4,offset_y:-8}},"/Ooo":function(e,t){e.exports={id:"king",width:32,height:32,animations:{idle_down:{length:2,row:0}},offset_x:-8,offset_y:-12}},"/c9u":function(e,t,i){"use strict";var n=i("OvRC"),a=i.n(n),r=i("XDXK"),s=function(e,t,i,n,a,s){this.color=t;i=void 0!==i?i:0,n=void 0!==n?n:0,a=void 0!==a?a:1,s=void 0!==s?s:1;r.a.bind(this)(e,i,n,a,s)};(s.prototype=a()(r.a.prototype)).draw=function(e,t,i,n,a){e.fillStyle=this.color,e.fillRect(t,i,n,a)},t.a=s},"/sf/":function(e,t){e.exports={id:"guard",width:25,height:24,animations:{idle_down:{length:2,row:0}},offset_x:-5,offset_y:-8}},"/z/9":function(e,t){e.exports={id:"item-goldensword",width:16,height:16,animations:{idle:{length:6,row:0}},offset_x:0,offset_y:0}},0:function(e,t){},"0U4p":function(e,t){e.exports={id:"snake",width:28,height:28,animations:{atk_right:{length:5,row:0},walk_right:{length:4,row:1},idle_right:{length:4,row:2},atk_up:{length:5,row:3},walk_up:{length:4,row:4},idle_up:{length:4,row:5},atk_down:{length:5,row:6},walk_down:{length:4,row:7},idle_down:{length:6,row:8}},offset_x:-6,offset_y:-10}},"0YEL":function(e,t){e.exports={id:"item-leatherarmor",width:16,height:16,animations:{idle:{length:6,row:0}},offset_x:0,offset_y:0}},"0i05":function(e,t){e.exports={id:"mailarmor",width:32,height:32,animations:{atk_right:{length:5,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:5,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:5,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offset_x:-8,offset_y:-12}},1:function(e,t){},"1ZLN":function(e,t,i){var n={"./agent.json":"+rbd","./arrow.json":"ijQv","./axe.json":"q9QV","./bat.json":"oxPP","./beachnpc.json":"72jo","./bluesword.json":"yWNk","./boss.json":"taTb","./chest.json":"cKQl","./clotharmor.json":"AKwQ","./coder.json":"eOxi","./crab.json":"UcV4","./death.json":"Sqs0","./deathknight.json":"Oy9j","./desertnpc.json":"lUAm","./eye.json":"PznX","./firefox.json":"ujQs","./forestnpc.json":"aNYQ","./goblin.json":"C37V","./goldenarmor.json":"UStB","./goldensword.json":"hemJ","./guard.json":"/sf/","./hand.json":"mJyv","./impact.json":"t9nu","./item-axe.json":"HITf","./item-bluesword.json":"ZBgj","./item-burger.json":"wzZJ","./item-cake.json":"B4O8","./item-clotharmor.json":"LsZA","./item-firepotion.json":"9R10","./item-flask.json":"RgGw","./item-goldenarmor.json":"SML3","./item-goldensword.json":"/z/9","./item-leatherarmor.json":"0YEL","./item-mailarmor.json":"BvGv","./item-morningstar.json":"3SDg","./item-platearmor.json":"n+Rf","./item-redarmor.json":"A0vU","./item-redsword.json":"RZ8U","./item-sword1.json":"+F07","./item-sword2.json":"7fe2","./king.json":"/Ooo","./lavanpc.json":"Tb6K","./leatherarmor.json":"JYMs","./loot.json":"ySG5","./mailarmor.json":"0i05","./morningstar.json":"34Xz","./nyan.json":"47gg","./octocat.json":"lgfl","./ogre.json":"8VIR","./platearmor.json":"L0hz","./priest.json":"ni5p","./rat.json":"zRJz","./redarmor.json":"RVzG","./redsword.json":"IJ/y","./rick.json":"4Alr","./scientist.json":"t0mp","./shadow16.json":"me95","./skeleton.json":"1mYB","./skeleton2.json":"jgxY","./snake.json":"0U4p","./sorcerer.json":"8emz","./sparks.json":"2UF/","./spectre.json":"NxES","./sword.json":"wine","./sword1.json":"vm1t","./sword2.json":"H7Qu","./talk.json":"j8az","./target.json":"Qyla","./villagegirl.json":"KD9h","./villager.json":"e7Fs","./wizard.json":"Lx20"};function a(e){return i(r(e))}function r(e){var t=n[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}a.keys=function(){return Object.keys(n)},a.resolve=r,e.exports=a,a.id="1ZLN"},"1fqz":function(e,t,i){"use strict";var n=i("Zx67"),a=i.n(n),r=i("Zrlr"),s=i.n(r),o=i("zwoO"),h=i.n(o),l=i("Pf15"),c=i.n(l),d=function(e){function t(e,i,n){s()(this,t);var r=h()(this,(t.__proto__||a()(t)).call(this,e,n));return r.name=i,r}return c()(t,e),t}(i("zTqn").a);t.a=d},"1mYB":function(e,t){e.exports={id:"skeleton",width:48,height:48,animations:{atk_right:{length:3,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:4,row:4},idle_up:{length:3,row:5},atk_down:{length:3,row:6},walk_down:{length:4,row:7},idle_down:{length:3,row:8}},offset_x:-16,offset_y:-20}},2:function(e,t){},"2UF/":function(e,t){e.exports={id:"sparks",width:16,height:16,animations:{idle:{length:6,row:0}},offset_x:0,offset_y:0}},3:function(e,t){},"34Xz":function(e,t){e.exports={id:"morningstar",width:38,height:38,animations:{atk_right:{length:5,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:5,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:5,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offset_x:-11,offset_y:-15}},"3SDg":function(e,t){e.exports={id:"item-morningstar",width:16,height:16,animations:{idle:{length:6,row:0}},offset_x:0,offset_y:0}},"47gg":function(e,t){e.exports={id:"nyan",width:49,height:24,animations:{idle_down:{length:6,row:0}},offset_x:-22,offset_y:-6}},"4Alr":function(e,t){e.exports={id:"rick",width:32,height:32,animations:{idle_down:{length:4,row:0}},offset_x:-8,offset_y:-12}},"4Vh3":function(e,t){e.exports={modp1:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a63a3620ffffffffffffffff"},modp2:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece65381ffffffffffffffff"},modp5:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff"},modp14:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff"},modp15:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a93ad2caffffffffffffffff"},modp16:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c934063199ffffffffffffffff"},modp17:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dcc4024ffffffffffffffff"},modp18:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dbe115974a3926f12fee5e438777cb6a932df8cd8bec4d073b931ba3bc832b68d9dd300741fa7bf8afc47ed2576f6936ba424663aab639c5ae4f5683423b4742bf1c978238f16cbe39d652de3fdb8befc848ad922222e04a4037c0713eb57a81a23f0c73473fc646cea306b4bcbc8862f8385ddfa9d4b7fa2c087e879683303ed5bdd3a062b3cf5b3a278a66d2a13f83f44f82ddf310ee074ab6a364597e899a0255dc164f31cc50846851df9ab48195ded7ea1b1d510bd7ee74d73faf36bc31ecfa268359046f4eb879f924009438b481c6cd7889a002ed5ee382bc9190da6fc026e479558e4475677e9aa9e3050e2765694dfc81f56e880b96e7160c980dd98edd3dfffffffffffffffff"}}},"6ZSt":function(e,t){e.exports={"aes-128-ecb":{cipher:"AES",key:128,iv:0,mode:"ECB",type:"block"},"aes-192-ecb":{cipher:"AES",key:192,iv:0,mode:"ECB",type:"block"},"aes-256-ecb":{cipher:"AES",key:256,iv:0,mode:"ECB",type:"block"},"aes-128-cbc":{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},"aes-192-cbc":{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},"aes-256-cbc":{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},aes128:{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},aes192:{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},aes256:{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},"aes-128-cfb":{cipher:"AES",key:128,iv:16,mode:"CFB",type:"stream"},"aes-192-cfb":{cipher:"AES",key:192,iv:16,mode:"CFB",type:"stream"},"aes-256-cfb":{cipher:"AES",key:256,iv:16,mode:"CFB",type:"stream"},"aes-128-cfb8":{cipher:"AES",key:128,iv:16,mode:"CFB8",type:"stream"},"aes-192-cfb8":{cipher:"AES",key:192,iv:16,mode:"CFB8",type:"stream"},"aes-256-cfb8":{cipher:"AES",key:256,iv:16,mode:"CFB8",type:"stream"},"aes-128-cfb1":{cipher:"AES",key:128,iv:16,mode:"CFB1",type:"stream"},"aes-192-cfb1":{cipher:"AES",key:192,iv:16,mode:"CFB1",type:"stream"},"aes-256-cfb1":{cipher:"AES",key:256,iv:16,mode:"CFB1",type:"stream"},"aes-128-ofb":{cipher:"AES",key:128,iv:16,mode:"OFB",type:"stream"},"aes-192-ofb":{cipher:"AES",key:192,iv:16,mode:"OFB",type:"stream"},"aes-256-ofb":{cipher:"AES",key:256,iv:16,mode:"OFB",type:"stream"},"aes-128-ctr":{cipher:"AES",key:128,iv:16,mode:"CTR",type:"stream"},"aes-192-ctr":{cipher:"AES",key:192,iv:16,mode:"CTR",type:"stream"},"aes-256-ctr":{cipher:"AES",key:256,iv:16,mode:"CTR",type:"stream"},"aes-128-gcm":{cipher:"AES",key:128,iv:12,mode:"GCM",type:"auth"},"aes-192-gcm":{cipher:"AES",key:192,iv:12,mode:"GCM",type:"auth"},"aes-256-gcm":{cipher:"AES",key:256,iv:12,mode:"GCM",type:"auth"}}},"72jo":function(e,t){e.exports={id:"beachnpc",width:24,height:24,animations:{idle_down:{length:2,row:0}},offset_x:-4,offset_y:-8}},"7fe2":function(e,t){e.exports={id:"item-sword2",width:16,height:16,animations:{idle:{length:6,row:0}},offset_x:0,offset_y:0}},"8VIR":function(e,t){e.exports={id:"ogre",width:48,height:48,animations:{atk_right:{length:3,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:5,row:4},idle_up:{length:2,row:5},atk_down:{length:3,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8}},offset_x:-16,offset_y:-24}},"8YCc":function(e,t){e.exports={"2.16.840.1.101.3.4.1.1":"aes-128-ecb","2.16.840.1.101.3.4.1.2":"aes-128-cbc","2.16.840.1.101.3.4.1.3":"aes-128-ofb","2.16.840.1.101.3.4.1.4":"aes-128-cfb","2.16.840.1.101.3.4.1.21":"aes-192-ecb","2.16.840.1.101.3.4.1.22":"aes-192-cbc","2.16.840.1.101.3.4.1.23":"aes-192-ofb","2.16.840.1.101.3.4.1.24":"aes-192-cfb","2.16.840.1.101.3.4.1.41":"aes-256-ecb","2.16.840.1.101.3.4.1.42":"aes-256-cbc","2.16.840.1.101.3.4.1.43":"aes-256-ofb","2.16.840.1.101.3.4.1.44":"aes-256-cfb"}},"8emz":function(e,t){e.exports={id:"sorcerer",width:26,height:26,animations:{idle_down:{length:6,row:0}},offset_x:-5,offset_y:-9}},"8qcI":function(e,t,i){"use strict";var n=i("BO1k"),a=i.n(n),r=[],s=!0,o=!1,h=void 0;try{for(var l,c=a()(["deathknight","clotharmor"]);!(s=(l=c.next()).done);s=!0){var d=l.value,f=i("1ZLN")("./"+d+".json");r.push(f)}}catch(e){o=!0,h=e}finally{try{!s&&c.return&&c.return()}finally{if(o)throw h}}t.a=r},"9R10":function(e,t){e.exports={id:"item-firepotion",width:16,height:16,animations:{idle:{length:6,row:0}},offset_x:0,offset_y:0}},A0vU:function(e,t){e.exports={id:"item-redarmor",width:16,height:16,animations:{idle:{length:6,row:0}},offset_x:0,offset_y:0}},AKwQ:function(e,t){e.exports={id:"clotharmor",width:32,height:32,animations:{atk_right:{length:5,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:5,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:5,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offset_x:-8,offset_y:-12}},AeT2:function(e,t,i){"use strict";(function(e){var n=i("C4MV"),a=i.n(n),r=i("uL5Q"),s=i("Rr+P"),o=i("/c9u"),h=i("b8n+"),l=i("tTs3"),c=i("jQdr"),d=(i.n(c),["x","y","width","height","rotation","alpha","visible","pivot","anchor","smoothing","stretch","offset","text","scale","parent","textAlign","assetPath","color","left","right","up","down","ActiveInvoke"]),f=function(e,t){d.forEach(function(i){var n="_proxied_"+i;e[n]=e[i],a()(e,i,{set:function(a){e[i]!==a&&(t.shouldReDraw=!0),e[n]=a},get:function(){return e[n]}})})},u=function(e,t,i){this.displayObjects=[],this.eventListeners={click:[]},this.clearRect=null,this.gameCanvas=e,this.canvas=document.getElementById("foreground"),this.context=this.canvas.getContext("2d"),this.renderOnQuad=i||!1,this.shouldReDraw=!0,this.renderOnQuad&&this.prepareThreeJSScene(),this.resize()};u.anchors=r.a,u.prototype.addCanvasToDom=function(){this.gameCanvas.parentNode.appendChild(this.canvas)},u.prototype.prepareThreeJSScene=function(){this.camera=new e.OrthographicCamera(-this.canvas.width/2,this.canvas.width/2,this.canvas.height/2,-this.canvas.height/2,0,30),this.scene=new e.Scene,this.texture=new e.Texture(this.canvas);var t=new e.MeshBasicMaterial({map:this.texture});t.transparent=!0;var i=new e.PlaneGeometry(this.canvas.width,this.canvas.height);this.plane=new e.Mesh(i,t),this.plane.matrixAutoUpdate=!1,this.scene.add(this.plane)},u.prototype.resize=function(){this.width=800,this.height=400,this.shouldReDraw=!0},u.prototype.draw=function(){if(this.shouldReDraw){this.clearRect||this.context.clearRect(0,0,this.canvas.width,this.canvas.height);for(var e=this.displayObjects.length,t=0;t<e;t++)this.displayObjects[t].render(this.context);this.renderOnQuad&&(this.texture.needsUpdate=!0),this.shouldReDraw=!1}},u.prototype.render=function(e){this.draw(),this.renderOnQuad&&e.render(this.scene,this.camera),this.colorReplace&&(this.context.save(),this.context.fillStyle=this.colorReplace,this.context.globalCompositeOperation="source-atop",this.context.fillRect(0,0,this.canvas.width,this.canvas.height),this.context.restore())},u.prototype.createSprite=function(e,t,i,n,a){var r=new h.a(this,e,t,i,n,a);return this.displayObjects.push(r),f(r,this),r},u.prototype.createSpriteFromSheet=function(e,t,i,n,a,r,s){var o=new h.a(this,e,n,a,r,s,t,i);return this.displayObjects.push(o),f(o,this),o},u.prototype.createRectangle=function(e,t,i,n,a){var r=new o.a(this,e,t,i,n,a);return this.displayObjects.push(r),f(r,this),r},u.prototype.createText=function(e,t,i,n,a){var r=new l.a(this,e,t,i,n,a);return this.displayObjects.push(r),f(r,this),r},u.prototype.createBitmapText=function(e,t,i,n,a,r){var o=new s.a(this,e,t,i,n,a,r);return this.displayObjects.push(o),f(o,this),o},u.prototype.addEventListener=function(e,t,i){this.eventListeners[e].push({callback:t,displayObject:i})},u.prototype.clickHandler=function(e,t){var i={x:e,y:t},n=[];this.eventListeners.click.forEach(function(e){var t=e.displayObject;if(t.shouldReceiveEvents()){var a=t.getBounds();u.isInBoundingBox(i.x,i.y,a.x,a.y,a.width,a.height)&&n.push(e.callback)}});var a=!1;return n.forEach(function(e){e(),a=!0}),a},u.prototype.windowToUISpace=function(e,t){var i=this.gameCanvas.getBoundingClientRect(),n=this.height/i.height;return{x:(e-i.left)*n,y:(t-i.top)*n}},u.prototype.moveToFront=function(e){var t=this.displayObjects.indexOf(e);t>-1&&this.displayObjects.splice(t,1),this.displayObjects.push(e)},u.isInBoundingBox=function(e,t,i,n,a,r){return e>=i&&e<=i+a&&t>=n&&t<=n+r},t.a=u}).call(t,i("Ml+6"))},B4O8:function(e,t){e.exports={id:"item-cake",width:24,height:24,animations:{idle:{length:3,row:0}},offset_x:-4,offset_y:-6}},BvGv:function(e,t){e.exports={id:"item-mailarmor",width:16,height:16,animations:{idle:{length:6,row:0}},offset_x:0,offset_y:0}},C37V:function(e,t){e.exports={id:"goblin",width:26,height:26,animations:{atk_right:{length:3,row:0},walk_right:{length:3,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:3,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offset_x:-5,offset_y:-9}},DwfQ:function(e,t,i){"use strict";(function(e){var n=i("Zx67"),a=i.n(n),r=i("Zrlr"),s=i.n(r),o=i("wxAW"),h=i.n(o),l=i("zwoO"),c=i.n(l),d=i("Pf15"),f=i.n(d),u=function(t){function i(e,t){s()(this,i);var n=c()(this,(i.__proto__||a()(i)).call(this,e,t));return n.load(),n}return f()(i,t),h()(i,[{key:"load",value:function(){var t=new e.BoxBufferGeometry(8,8,8),i=new e.MeshLambertMaterial({color:16777215}),n=new e.Mesh(t,i);t.computeBoundingBox(),this.mesh=n,this.offset={x:0,y:-t.boundingBox.min.y,z:0},this.isLoaded=!0}},{key:"attachPointLight",value:function(t,i,n){var a=new e.PointLight(t,i,n);a.position.set(0,10,0),a.castShadow=!0,this.mesh.add(a)}}]),i}(i("m3jU").a);t.a=u}).call(t,i("Ml+6"))},GoZD:function(e,t,i){"use strict";var n=i("Zrlr"),a=i.n(n),r=i("wxAW"),s=i.n(r);
/**
 * A* (A-Star) algorithm for a path finder
 * @author  Andrea Giammarchi
 * @license Mit Style License
 */
function o(e,t,i,n,a,r,s,o,h,l,c,d,f){return e&&(i&&!h[a][s]&&(d[f++]={x:s,y:a}),n&&!h[a][o]&&(d[f++]={x:o,y:a})),t&&(i&&!h[r][s]&&(d[f++]={x:s,y:r}),n&&!h[r][o]&&(d[f++]={x:o,y:r})),d}function h(e,t,i,n,a,r,s,o,h,l,c,d,f){return e=a>-1,t=r<l,n=o>-1,s<c&&(e&&!h[a][s]&&(d[f++]={x:s,y:a}),t&&!h[r][s]&&(d[f++]={x:s,y:r})),n&&(e&&!h[a][o]&&(d[f++]={x:o,y:a}),t&&!h[r][o]&&(d[f++]={x:o,y:r})),d}function l(e,t,i,n,a,r,s,o,h,l,c,d,f){return d}function c(e,t,i,n,a,r){var s=i-1,o=i+1,h=t+1,l=t-1,c=s>-1&&!n[s][t],d=o<a&&!n[o][t],f=h<r&&!n[i][h],u=l>-1&&!n[i][l],p=[],g=0;return c&&(p[g++]={x:t,y:s}),f&&(p[g++]={x:h,y:i}),d&&(p[g++]={x:t,y:o}),u&&(p[g++]={x:l,y:i}),e(c,d,f,u,s,o,h,l,n,a,r,p,g)}function d(e,t,i,n){return n(i(e.x-t.x),i(e.y-t.y))}function f(e,t,i,n){var a=e.x-t.x,r=e.y-t.y;return n(a*a+r*r)}function u(e,t,i,n){return i(e.x-t.x)+i(e.y-t.y)}var p=function(e,t,i,n){var a,r,s,p,g,m,w,v,b,y=e[0].length,_=e.length,x=y*_,k=Math.abs,S=Math.max,M={},T=[],A=[{x:t[0],y:t[1],f:0,g:0,v:t[0]+t[1]*y}],E=1;switch(i={x:i[0],y:i[1],v:i[0]+i[1]*y},n){case"Diagonal":s=o;case"DiagonalFree":r=d;break;case"Euclidean":s=o;case"EuclideanFree":S=Math.sqrt,r=f;break;default:r=u,s=l}s||(s=h);do{for(m=x,w=0,p=0;p<E;++p)(n=A[p].f)<m&&(m=n,w=p);if((v=A.splice(w,1)[0]).v!=i.v)for(--E,p=0,g=(b=c(s,v.x,v.y,e,_,y)).length;p<g;++p)(a=b[p]).p=v,a.f=a.g=0,a.v=a.x+a.y*y,a.v in M||(a.f=(a.g=v.g+r(a,v,k,S))+r(a,i,k,S),A[E++]=a,M[a.v]=1);else{p=E=0;do{T[p++]=[v.x,v.y]}while(v=v.p);T.reverse()}}while(E);return T},g=function(){function e(t,i){a()(this,e),this.width=t,this.height=i,this.grid=null,this.ignored=[],this.initBlankGrid()}return s()(e,[{key:"initBlankGrid",value:function(){this.blankGrid=[];for(var e=0;e<this.height;e+=1){this.blankGrid[e]=[];for(var t=0;t<this.width;t+=1)this.blankGrid[e][t]=0}}},{key:"findPath",value:function(e,t,i,n,a){var r=[t.gridX,t.gridY],s=[i,n];this.grid=e;var o=p(this.grid,r,s);return 0===o.length&&!0===a&&(o=this.findIncompletePath_(r,s)),o}},{key:"findIncompletePath_",value:function(e,t){for(var i,n=void 0,a=void 0,r=[],s=(i=p(this.blankGrid,e,t)).length-1;s>0;s-=1)if(n=i[s][0],a=i[s][1],0===this.grid[a][n]){r=p(this.grid,e,[n,a]);break}return r}},{key:"ignoreEntity",value:function(e){e&&this.ignored.push(e)}},{key:"clearIgnoreList",value:function(){this.applyIgnoreList_(!1),this.ignored=[]}}]),e}();t.a=g},H7Qu:function(e,t){e.exports={id:"sword2",width:48,height:48,animations:{atk_right:{length:5,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:5,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:5,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offset_x:-16,offset_y:-20}},HITf:function(e,t){e.exports={id:"item-axe",width:16,height:16,animations:{idle:{length:6,row:0}},offset_x:0,offset_y:0}},"IJ/y":function(e,t){e.exports={id:"redsword",width:48,height:48,animations:{atk_right:{length:5,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:5,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:5,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offset_x:-16,offset_y:-20}},ITPp:function(e,t,i){"use strict";var n=i("Zrlr"),a=i.n(n),r=i("wxAW"),s=i.n(r),o=i("7t+N"),h=i.n(o),l=i("rdLu"),c=(i.n(l),function(e){return e%1==0}),d=function(){function e(t){a()(this,e),this.loadMap()}return s()(e,[{key:"loadMap",value:function(){var e=this;h.a.get("static/maps.json",function(t){e._initMap(t),e._generateCollisionGrid(),e.isLoaded=!0},"json")}},{key:"_initMap",value:function(e){this.width=e.width,this.height=e.height,this.data=e.data,this.tilesize=e.tilesize,this.collisions=e.collisions,this.props=e.props}},{key:"_generateCollisionGrid",value:function(){var e=this;this.grid=[];for(var t=0;t<this.height;t++){this.grid[t]=[];for(var i=0;i<this.width;i++)this.grid[t][i]=0}l.each(this.collisions,function(t){var i=e.tileIndexToGridPosition(t+1);e.grid[i.y][i.x]=1})}},{key:"isColliding",value:function(e,t){return!(this.isOutOfBounds(e,t)||!this.grid)&&1===this.grid[t][e]}},{key:"isOutOfBounds",value:function(e,t){return c(e)&&c(t)&&(e<0||e>=this.width||t<0||t>=this.height)}},{key:"tileIndexToGridPosition",value:function(e){return{x:(e-=1)%this.width,y:Math.floor(e/this.width)}}}]),e}();t.a=d},JYMs:function(e,t){e.exports={id:"leatherarmor",width:32,height:32,animations:{atk_right:{length:5,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:5,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:5,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offset_x:-8,offset_y:-12}},KD9h:function(e,t){e.exports={id:"villagegirl",width:24,height:24,animations:{idle_down:{length:2,row:0}},offset_x:-4,offset_y:-8}},KGr3:function(e,t,i){"use strict";(function(e){var n=i("Zrlr"),a=i.n(n);t.a=function t(i,n){a()(this,t),this.game=i,this.map=n;var r=new e.PlaneBufferGeometry(n.width*n.tilesize,n.height*n.tilesize,n.width,n.height),s=new e.MeshStandardMaterial({color:4214848,roughness:.75}),o=new e.Mesh(r,s);o.rotation.order="YXZ",o.rotation.x=-Math.PI/2,o.receiveShadow=!0,r.computeBoundingBox(),i.map.offset={x:r.boundingBox.min.x,y:r.boundingBox.min.y},this.terrain=o}}).call(t,i("Ml+6"))},KYqO:function(e,t){e.exports={_args:[["elliptic@6.4.1","C:\\work\\GitHub\\projectB"]],_development:!0,_from:"elliptic@6.4.1",_id:"elliptic@6.4.1",_inBundle:!1,_integrity:"sha512-BsXLz5sqX8OHcsh7CqBMztyXARmGQ3LWPtGjJi6DiJHq5C/qvi9P3OqgswKSDftbu8+IoI/QDTAm2fFnQ9SZSQ==",_location:"/elliptic",_phantomChildren:{},_requested:{type:"version",registry:!0,raw:"elliptic@6.4.1",name:"elliptic",escapedName:"elliptic",rawSpec:"6.4.1",saveSpec:null,fetchSpec:"6.4.1"},_requiredBy:["/browserify-sign","/create-ecdh"],_resolved:"https://registry.npmjs.org/elliptic/-/elliptic-6.4.1.tgz",_spec:"6.4.1",_where:"C:\\work\\GitHub\\projectB",author:{name:"Fedor Indutny",email:"fedor@indutny.com"},bugs:{url:"https://github.com/indutny/elliptic/issues"},dependencies:{"bn.js":"^4.4.0",brorand:"^1.0.1","hash.js":"^1.0.0","hmac-drbg":"^1.0.0",inherits:"^2.0.1","minimalistic-assert":"^1.0.0","minimalistic-crypto-utils":"^1.0.0"},description:"EC cryptography",devDependencies:{brfs:"^1.4.3",coveralls:"^2.11.3",grunt:"^0.4.5","grunt-browserify":"^5.0.0","grunt-cli":"^1.2.0","grunt-contrib-connect":"^1.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^1.0.1","grunt-mocha-istanbul":"^3.0.1","grunt-saucelabs":"^8.6.2",istanbul:"^0.4.2",jscs:"^2.9.0",jshint:"^2.6.0",mocha:"^2.1.0"},files:["lib"],homepage:"https://github.com/indutny/elliptic",keywords:["EC","Elliptic","curve","Cryptography"],license:"MIT",main:"lib/elliptic.js",name:"elliptic",repository:{type:"git",url:"git+ssh://git@github.com/indutny/elliptic.git"},scripts:{jscs:"jscs benchmarks/*.js lib/*.js lib/**/*.js lib/**/**/*.js test/index.js",jshint:"jscs benchmarks/*.js lib/*.js lib/**/*.js lib/**/**/*.js test/index.js",lint:"npm run jscs && npm run jshint",test:"npm run lint && npm run unit",unit:"istanbul test _mocha --reporter=spec test/index.js",version:"grunt dist && git add dist/"},version:"6.4.1"}},L0hz:function(e,t){e.exports={id:"platearmor",width:32,height:32,animations:{atk_right:{length:5,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:5,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:5,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offset_x:-8,offset_y:-12}},LsZA:function(e,t){e.exports={id:"item-clotharmor",width:16,height:16,animations:{idle:{length:6,row:0}},offset_x:0,offset_y:0}},Lx20:function(e,t){e.exports={id:"wizard",width:26,height:26,animations:{death:{length:3,row:0},atk_right:{length:4,row:1},atk_up:{length:4,row:2},atk_down:{length:4,row:3},walk_right:{length:4,row:4},walk_up:{length:4,row:5},walk_down:{length:4,row:6},idle_right:{length:6,row:7},idle_up:{length:6,row:8},idle_down:{length:6,row:9}},offset_x:-5,offset_y:-9}},"N9/5":function(e,t,i){"use strict";(function(e){var n=i("fZjL"),a=i.n(n),r=i("pFYg"),s=i.n(r),o=i("OvRC"),h=i.n(o),l=i("//Fk"),c=i.n(l),d=i("Zrlr"),f=i.n(d),u=i("wxAW"),p=i.n(u),g=function(){function t(i){f()(this,t),this.manager=void 0!==i?i:e.DefaultLoadingManager,this.dracoLoader=null,this.crossOrigin="anonymous"}return p()(t,[{key:"load",value:function(t,i,n,a){var r,s=this;r=void 0!==this.resourcePath?this.resourcePath:void 0!==this.path?this.path:e.LoaderUtils.extractUrlBase(t),s.manager.itemStart(t);var o=function(e){a?a(e):console.error(e),s.manager.itemError(t),s.manager.itemEnd(t)},h=new e.FileLoader(s.manager);h.setPath(this.path),h.setResponseType("arraybuffer"),h.load(t,function(e){try{s.parse(e,r,function(e){i(e),s.manager.itemEnd(t)},o)}catch(e){o(e)}},n,o)}},{key:"setCrossOrigin",value:function(e){return this.crossOrigin=e,this}},{key:"setPath",value:function(e){return this.path=e,this}},{key:"setResourcePath",value:function(e){return this.resourcePath=e,this}},{key:"setDRACOLoader",value:function(e){return this.dracoLoader=e,this}},{key:"parse",value:function(t,i,n,a){var r,s={};if("string"==typeof t)r=t;else if(e.LoaderUtils.decodeText(new Uint8Array(t,0,4))===_){try{s[w.KHR_BINARY_GLTF]=new function(t){this.name=w.KHR_BINARY_GLTF,this.content=null,this.body=null;var i=new DataView(t,0,x);if(this.header={magic:e.LoaderUtils.decodeText(new Uint8Array(t.slice(0,4))),version:i.getUint32(4,!0),length:i.getUint32(8,!0)},this.header.magic!==_)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected. Use LegacyGLTFLoader instead.");var n=new DataView(t,x),a=0;for(;a<n.byteLength;){var r=n.getUint32(a,!0);a+=4;var s=n.getUint32(a,!0);if(a+=4,s===k.JSON){var o=new Uint8Array(t,x+a,r);this.content=e.LoaderUtils.decodeText(o)}else if(s===k.BIN){var h=x+a;this.body=t.slice(h,h+r)}a+=r}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}(t)}catch(e){return void(a&&a(e))}r=s[w.KHR_BINARY_GLTF].content}else r=e.LoaderUtils.decodeText(new Uint8Array(t));var o=JSON.parse(r);if(void 0===o.asset||o.asset.version[0]<2)a&&a(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported. Use LegacyGLTFLoader instead."));else{if(o.extensionsUsed)for(var h=0;h<o.extensionsUsed.length;++h){var l=o.extensionsUsed[h],c=o.extensionsRequired||[];switch(l){case w.KHR_LIGHTS_PUNCTUAL:s[l]=new b(o);break;case w.KHR_MATERIALS_UNLIT:s[l]=new y(o);break;case w.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:s[l]=new T(o);break;case w.KHR_DRACO_MESH_COMPRESSION:s[l]=new S(o,this.dracoLoader);break;case w.MSFT_TEXTURE_DDS:s[w.MSFT_TEXTURE_DDS]=new v;break;case w.KHR_TEXTURE_TRANSFORM:s[w.KHR_TEXTURE_TRANSFORM]=new M(o);break;default:c.indexOf(l)>=0&&console.warn('THREE.GLTFLoader: Unknown extension "'+l+'".')}}var d=new ee(o,s,{path:i||this.resourcePath||"",crossOrigin:this.crossOrigin,manager:this.manager});d.parse(function(e,t,i,a,r){var o={scene:e,scenes:t,cameras:i,animations:a,asset:r.asset,parser:d,userData:{}};Z(s,o,r),n(o)},a)}}}]),t}();t.a=g;var m=function(){function e(){f()(this,e),this.objects={}}return p()(e,[{key:"get",value:function(e){return this.objects[e]}},{key:"add",value:function(e,t){this.objects[e]=t}},{key:"remove",value:function(e){delete this.objects[e]}},{key:"removeAll",value:function(){this.objects={}}}]),e}(),w={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",MSFT_TEXTURE_DDS:"MSFT_texture_dds"};function v(){if(!e.DDSLoader)throw new Error("THREE.GLTFLoader: Attempting to load .dds texture without importing THREE.DDSLoader");this.name=w.MSFT_TEXTURE_DDS,this.ddsLoader=new e.DDSLoader}function b(e){this.name=w.KHR_LIGHTS_PUNCTUAL;var t=e.extensions&&e.extensions[w.KHR_LIGHTS_PUNCTUAL]||{};this.lightDefs=t.lights||[]}function y(e){this.name=w.KHR_MATERIALS_UNLIT}b.prototype.loadLight=function(t){var i,n=this.lightDefs[t],a=new e.Color(16777215);void 0!==n.color&&a.fromArray(n.color);var r=void 0!==n.range?n.range:0;switch(n.type){case"directional":(i=new e.DirectionalLight(a)).target.position.set(0,0,-1),i.add(i.target);break;case"point":(i=new e.PointLight(a)).distance=r;break;case"spot":(i=new e.SpotLight(a)).distance=r,n.spot=n.spot||{},n.spot.innerConeAngle=void 0!==n.spot.innerConeAngle?n.spot.innerConeAngle:0,n.spot.outerConeAngle=void 0!==n.spot.outerConeAngle?n.spot.outerConeAngle:Math.PI/4,i.angle=n.spot.outerConeAngle,i.penumbra=1-n.spot.innerConeAngle/n.spot.outerConeAngle,i.target.position.set(0,0,-1),i.add(i.target);break;default:throw new Error('THREE.GLTFLoader: Unexpected light type, "'+n.type+'".')}return i.position.set(0,0,0),i.decay=2,void 0!==n.intensity&&(i.intensity=n.intensity),i.name=n.name||"light_"+t,c.a.resolve(i)},y.prototype.getMaterialType=function(t){return e.MeshBasicMaterial},y.prototype.extendParams=function(t,i,n){var a=[];t.color=new e.Color(1,1,1),t.opacity=1;var r=i.pbrMetallicRoughness;if(r){if(Array.isArray(r.baseColorFactor)){var s=r.baseColorFactor;t.color.fromArray(s),t.opacity=s[3]}void 0!==r.baseColorTexture&&a.push(n.assignTexture(t,"map",r.baseColorTexture))}return c.a.all(a)};var _="glTF",x=12,k={JSON:1313821514,BIN:5130562};function S(t,i){if(!i)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=w.KHR_DRACO_MESH_COMPRESSION,this.json=t,this.dracoLoader=i,e.DRACOLoader.getDecoderModule()}function M(e){this.name=w.KHR_TEXTURE_TRANSFORM}function T(){return{name:w.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return e.ShaderMaterial},extendParams:function(t,i,n){var a=i.extensions[this.name],r=e.ShaderLib.standard,s=e.UniformsUtils.clone(r.uniforms),o=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),h=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),l=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),d=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),f=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb;","material.specularRoughness = clamp( 1.0 - glossinessFactor, 0.04, 1.0 );","material.specularColor = specularFactor.rgb;"].join("\n"),u=r.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",o).replace("#include <metalnessmap_pars_fragment>",h).replace("#include <roughnessmap_fragment>",l).replace("#include <metalnessmap_fragment>",d).replace("#include <lights_physical_fragment>",f);delete s.roughness,delete s.metalness,delete s.roughnessMap,delete s.metalnessMap,s.specular={value:(new e.Color).setHex(1118481)},s.glossiness={value:.5},s.specularMap={value:null},s.glossinessMap={value:null},t.vertexShader=r.vertexShader,t.fragmentShader=u,t.uniforms=s,t.defines={STANDARD:""},t.color=new e.Color(1,1,1),t.opacity=1;var p=[];if(Array.isArray(a.diffuseFactor)){var g=a.diffuseFactor;t.color.fromArray(g),t.opacity=g[3]}if(void 0!==a.diffuseTexture&&p.push(n.assignTexture(t,"map",a.diffuseTexture)),t.emissive=new e.Color(0,0,0),t.glossiness=void 0!==a.glossinessFactor?a.glossinessFactor:1,t.specular=new e.Color(1,1,1),Array.isArray(a.specularFactor)&&t.specular.fromArray(a.specularFactor),void 0!==a.specularGlossinessTexture){var m=a.specularGlossinessTexture;p.push(n.assignTexture(t,"glossinessMap",m)),p.push(n.assignTexture(t,"specularMap",m))}return c.a.all(p)},createMaterial:function(t){var i=new e.ShaderMaterial({defines:t.defines,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader,uniforms:t.uniforms,fog:!0,lights:!0,opacity:t.opacity,transparent:t.transparent});return i.isGLTFSpecularGlossinessMaterial=!0,i.color=t.color,i.map=void 0===t.map?null:t.map,i.lightMap=null,i.lightMapIntensity=1,i.aoMap=void 0===t.aoMap?null:t.aoMap,i.aoMapIntensity=1,i.emissive=t.emissive,i.emissiveIntensity=1,i.emissiveMap=void 0===t.emissiveMap?null:t.emissiveMap,i.bumpMap=void 0===t.bumpMap?null:t.bumpMap,i.bumpScale=1,i.normalMap=void 0===t.normalMap?null:t.normalMap,t.normalScale&&(i.normalScale=t.normalScale),i.displacementMap=null,i.displacementScale=1,i.displacementBias=0,i.specularMap=void 0===t.specularMap?null:t.specularMap,i.specular=t.specular,i.glossinessMap=void 0===t.glossinessMap?null:t.glossinessMap,i.glossiness=t.glossiness,i.alphaMap=null,i.envMap=void 0===t.envMap?null:t.envMap,i.envMapIntensity=1,i.refractionRatio=.98,i.extensions.derivatives=!0,i},cloneMaterial:function(e){var t=e.clone();t.isGLTFSpecularGlossinessMaterial=!0;for(var i=this.specularGlossinessParams,n=0,a=i.length;n<a;n++)t[i[n]]=e[i[n]];return t},refreshUniforms:function(e,t,i,n,a,r){if(!0===a.isGLTFSpecularGlossinessMaterial){var s,o=a.uniforms,h=a.defines;o.opacity.value=a.opacity,o.diffuse.value.copy(a.color),o.emissive.value.copy(a.emissive).multiplyScalar(a.emissiveIntensity),o.map.value=a.map,o.specularMap.value=a.specularMap,o.alphaMap.value=a.alphaMap,o.lightMap.value=a.lightMap,o.lightMapIntensity.value=a.lightMapIntensity,o.aoMap.value=a.aoMap,o.aoMapIntensity.value=a.aoMapIntensity,a.map?s=a.map:a.specularMap?s=a.specularMap:a.displacementMap?s=a.displacementMap:a.normalMap?s=a.normalMap:a.bumpMap?s=a.bumpMap:a.glossinessMap?s=a.glossinessMap:a.alphaMap?s=a.alphaMap:a.emissiveMap&&(s=a.emissiveMap),void 0!==s&&(s.isWebGLRenderTarget&&(s=s.texture),!0===s.matrixAutoUpdate&&s.updateMatrix(),o.uvTransform.value.copy(s.matrix)),a.envMap&&(o.envMap.value=a.envMap,o.envMapIntensity.value=a.envMapIntensity,o.flipEnvMap.value=a.envMap.isCubeTexture?-1:1,o.reflectivity.value=a.reflectivity,o.refractionRatio.value=a.refractionRatio,o.maxMipLevel.value=e.properties.get(a.envMap).__maxMipLevel),o.specular.value.copy(a.specular),o.glossiness.value=a.glossiness,o.glossinessMap.value=a.glossinessMap,o.emissiveMap.value=a.emissiveMap,o.bumpMap.value=a.bumpMap,o.normalMap.value=a.normalMap,o.displacementMap.value=a.displacementMap,o.displacementScale.value=a.displacementScale,o.displacementBias.value=a.displacementBias,null!==o.glossinessMap.value&&void 0===h.USE_GLOSSINESSMAP&&(h.USE_GLOSSINESSMAP="",h.USE_ROUGHNESSMAP=""),null===o.glossinessMap.value&&void 0!==h.USE_GLOSSINESSMAP&&(delete h.USE_GLOSSINESSMAP,delete h.USE_ROUGHNESSMAP)}}}}function A(t,i,n,a){e.Interpolant.call(this,t,i,n,a)}S.prototype.decodePrimitive=function(e,t){var i=this.json,n=this.dracoLoader,a=e.extensions[this.name].bufferView,r=e.extensions[this.name].attributes,s={},o={},h={};for(var l in r)l in B&&(s[B[l]]=r[l]);for(l in e.attributes)if(void 0!==B[l]&&void 0!==r[l]){var d=i.accessors[e.attributes[l]],f=C[d.componentType];h[B[l]]=f,o[B[l]]=!0===d.normalized}return t.getDependency("bufferView",a).then(function(e){return new c.a(function(t){n.decodeDracoFile(e,function(e){for(var i in e.attributes){var n=e.attributes[i],a=o[i];void 0!==a&&(n.normalized=a)}t(e)},s,h)})})},M.prototype.extendTexture=function(e,t){return e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),e.needsUpdate=!0,e},A.prototype=h()(e.Interpolant.prototype),A.prototype.constructor=A,A.prototype.copySampleValue_=function(e){for(var t=this.resultBuffer,i=this.sampleValues,n=this.valueSize,a=e*n*3+n,r=0;r!==n;r++)t[r]=i[a+r];return t},A.prototype.beforeStart_=A.prototype.copySampleValue_,A.prototype.afterEnd_=A.prototype.copySampleValue_,A.prototype.interpolate_=function(e,t,i,n){for(var a=this.resultBuffer,r=this.sampleValues,s=this.valueSize,o=2*s,h=3*s,l=n-t,c=(i-t)/l,d=c*c,f=d*c,u=e*h,p=u-h,g=-2*f+3*d,m=f-d,w=1-g,v=m-d+c,b=0;b!==s;b++){var y=r[p+b+s],_=r[p+b+o]*l,x=r[u+b+s],k=r[u+b]*l;a[b]=w*y+v*_+g*x+m*k}return a};var E=0,R=1,L=2,F=3,I=4,D=5,j=6,C=(Number,e.Matrix3,e.Matrix4,e.Vector2,e.Vector3,e.Vector4,e.Texture,{5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array}),P={9728:e.NearestFilter,9729:e.LinearFilter,9984:e.NearestMipMapNearestFilter,9985:e.LinearMipMapNearestFilter,9986:e.NearestMipMapLinearFilter,9987:e.LinearMipMapLinearFilter},O={33071:e.ClampToEdgeWrapping,33648:e.MirroredRepeatWrapping,10497:e.RepeatWrapping},G=(e.BackSide,e.FrontSide,e.NeverDepth,e.LessDepth,e.EqualDepth,e.LessEqualDepth,e.GreaterEqualDepth,e.NotEqualDepth,e.GreaterEqualDepth,e.AlwaysDepth,e.AddEquation,e.SubtractEquation,e.ReverseSubtractEquation,e.ZeroFactor,e.OneFactor,e.SrcColorFactor,e.OneMinusSrcColorFactor,e.SrcAlphaFactor,e.OneMinusSrcAlphaFactor,e.DstAlphaFactor,e.OneMinusDstAlphaFactor,e.DstColorFactor,e.OneMinusDstColorFactor,e.SrcAlphaSaturateFactor,{SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16}),B={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},U={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},H={CUBICSPLINE:e.InterpolateSmooth,LINEAR:e.InterpolateLinear,STEP:e.InterpolateDiscrete},N="OPAQUE",z="MASK",V="BLEND",K={"image/png":e.RGBAFormat,"image/jpeg":e.RGBFormat};function X(e,t){return"string"!=typeof e||""===e?"":/^(https?:)?\/\//i.test(e)?e:/^data:.*,.*$/i.test(e)?e:/^blob:.*$/i.test(e)?e:t+e}function Z(e,t,i){for(var n in i.extensions)void 0===e[n]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[n]=i.extensions[n])}function Y(e,t){void 0!==t.extras&&("object"===s()(t.extras)?e.userData=t.extras:console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function W(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(var i=0,n=t.weights.length;i<n;i++)e.morphTargetInfluences[i]=t.weights[i];if(t.extras&&Array.isArray(t.extras.targetNames)){var a=t.extras.targetNames;if(e.morphTargetInfluences.length===a.length){e.morphTargetDictionary={};for(i=0,n=a.length;i<n;i++)e.morphTargetDictionary[a[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function q(e,t){if(a()(e).length!==a()(t).length)return!1;for(var i in e)if(e[i]!==t[i])return!1;return!0}function Q(e){var t=e.extensions&&e.extensions[w.KHR_DRACO_MESH_COMPRESSION];return t?"draco:"+t.bufferView+":"+t.indices+":"+J(t.attributes):e.indices+":"+J(e.attributes)+":"+e.mode}function J(e){for(var t="",i=a()(e).sort(),n=0,r=i.length;n<r;n++)t+=i[n]+":"+e[i[n]]+";";return t}function $(t){if(t.isInterleavedBufferAttribute){for(var i=t.count,n=t.itemSize,a=t.array.slice(0,i*n),r=0,s=0;r<i;++r)a[s++]=t.getX(r),n>=2&&(a[s++]=t.getY(r)),n>=3&&(a[s++]=t.getZ(r)),n>=4&&(a[s++]=t.getW(r));return new e.BufferAttribute(a,n,t.normalized)}return t.clone()}function ee(t,i,n){this.json=t||{},this.extensions=i||{},this.options=n||{},this.cache=new m,this.primitiveCache={},this.multiplePrimitivesCache={},this.multiPassGeometryCache={},this.textureLoader=new e.TextureLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new e.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer")}function te(e,t,i){var n=t.attributes,a=[];function r(t,n){return i.getDependency("accessor",t).then(function(t){e.addAttribute(n,t)})}for(var s in n){var o=B[s];o&&(o in e.attributes||a.push(r(n[s],o)))}if(void 0!==t.indices&&!e.index){var h=i.getDependency("accessor",t.indices).then(function(t){e.setIndex(t)});a.push(h)}return Y(e,t),c.a.all(a).then(function(){return void 0!==t.targets?function(e,t,i){for(var n=!1,a=!1,r=0,s=t.length;r<s&&(void 0!==(l=t[r]).POSITION&&(n=!0),void 0!==l.NORMAL&&(a=!0),!n||!a);r++);if(!n&&!a)return c.a.resolve(e);var o=[],h=[];for(r=0,s=t.length;r<s;r++){var l=t[r];if(n){var d=void 0!==l.POSITION?i.getDependency("accessor",l.POSITION).then(function(e){return $(e)}):e.attributes.position;o.push(d)}a&&(d=void 0!==l.NORMAL?i.getDependency("accessor",l.NORMAL).then(function(e){return $(e)}):e.attributes.normal,h.push(d))}return c.a.all([c.a.all(o),c.a.all(h)]).then(function(i){for(var r=i[0],s=i[1],o=0,h=t.length;o<h;o++){var l=t[o],c="morphTarget"+o;if(n&&void 0!==l.POSITION){var d=r[o];d.name=c;for(var f=e.attributes.position,u=0,p=d.count;u<p;u++)d.setXYZ(u,d.getX(u)+f.getX(u),d.getY(u)+f.getY(u),d.getZ(u)+f.getZ(u))}if(a&&void 0!==l.NORMAL){var g=s[o];g.name=c;var m=e.attributes.normal;for(u=0,p=g.count;u<p;u++)g.setXYZ(u,g.getX(u)+m.getX(u),g.getY(u)+m.getY(u),g.getZ(u)+m.getZ(u))}}return n&&(e.morphAttributes.position=r),a&&(e.morphAttributes.normal=s),e})}(e,t.targets,i):e})}ee.prototype.parse=function(e,t){var i=this.json;this.cache.removeAll(),this.markDefs(),this.getMultiDependencies(["scene","animation","camera"]).then(function(t){var n=t.scenes||[],a=n[i.scene||0],r=t.animations||[],s=t.cameras||[];e(a,n,s,r,i)}).catch(t)},ee.prototype.markDefs=function(){for(var e=this.json.nodes||[],t=this.json.skins||[],i=this.json.meshes||[],n={},a={},r=0,s=t.length;r<s;r++)for(var o=t[r].joints,h=0,l=o.length;h<l;h++)e[o[h]].isBone=!0;for(var c=0,d=e.length;c<d;c++){var f=e[c];void 0!==f.mesh&&(void 0===n[f.mesh]&&(n[f.mesh]=a[f.mesh]=0),n[f.mesh]++,void 0!==f.skin&&(i[f.mesh].isSkinnedMesh=!0))}this.json.meshReferences=n,this.json.meshUses=a},ee.prototype.getDependency=function(e,t){var i=e+":"+t,n=this.cache.get(i);if(!n){switch(e){case"scene":n=this.loadScene(t);break;case"node":n=this.loadNode(t);break;case"mesh":n=this.loadMesh(t);break;case"accessor":n=this.loadAccessor(t);break;case"bufferView":n=this.loadBufferView(t);break;case"buffer":n=this.loadBuffer(t);break;case"material":n=this.loadMaterial(t);break;case"texture":n=this.loadTexture(t);break;case"skin":n=this.loadSkin(t);break;case"animation":n=this.loadAnimation(t);break;case"camera":n=this.loadCamera(t);break;case"light":n=this.extensions[w.KHR_LIGHTS_PUNCTUAL].loadLight(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(i,n)}return n},ee.prototype.getDependencies=function(e){var t=this.cache.get(e);if(!t){var i=this,n=this.json[e+("mesh"===e?"es":"s")]||[];t=c.a.all(n.map(function(t,n){return i.getDependency(e,n)})),this.cache.add(e,t)}return t},ee.prototype.getMultiDependencies=function(e){for(var t={},i=[],n=0,a=e.length;n<a;n++){var r=e[n],s=this.getDependencies(r);s=s.then(function(e,i){t[e]=i}.bind(this,r+("mesh"===r?"es":"s"))),i.push(s)}return c.a.all(i).then(function(){return t})},ee.prototype.loadBuffer=function(e){var t=this.json.buffers[e],i=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return c.a.resolve(this.extensions[w.KHR_BINARY_GLTF].body);var n=this.options;return new c.a(function(e,a){i.load(X(t.uri,n.path),e,void 0,function(){a(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})},ee.prototype.loadBufferView=function(e){var t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(e){var i=t.byteLength||0,n=t.byteOffset||0;return e.slice(n,n+i)})},ee.prototype.loadAccessor=function(t){var i=this,n=this.json,a=this.json.accessors[t];if(void 0===a.bufferView&&void 0===a.sparse)return c.a.resolve(null);var r=[];return void 0!==a.bufferView?r.push(this.getDependency("bufferView",a.bufferView)):r.push(null),void 0!==a.sparse&&(r.push(this.getDependency("bufferView",a.sparse.indices.bufferView)),r.push(this.getDependency("bufferView",a.sparse.values.bufferView))),c.a.all(r).then(function(t){var r,s,o=t[0],h=G[a.type],l=C[a.componentType],c=l.BYTES_PER_ELEMENT,d=c*h,f=a.byteOffset||0,u=void 0!==a.bufferView?n.bufferViews[a.bufferView].byteStride:void 0,p=!0===a.normalized;if(u&&u!==d){var g="InterleavedBuffer:"+a.bufferView+":"+a.componentType,m=i.cache.get(g);m||(r=new l(o),m=new e.InterleavedBuffer(r,u/c),i.cache.add(g,m)),s=new e.InterleavedBufferAttribute(m,h,f/c,p)}else r=null===o?new l(a.count*h):new l(o,f,a.count*h),s=new e.BufferAttribute(r,h,p);if(void 0!==a.sparse){var w=G.SCALAR,v=C[a.sparse.indices.componentType],b=a.sparse.indices.byteOffset||0,y=a.sparse.values.byteOffset||0,_=new v(t[1],b,a.sparse.count*w),x=new l(t[2],y,a.sparse.count*h);null!==o&&s.setArray(s.array.slice());for(var k=0,S=_.length;k<S;k++){var M=_[k];if(s.setX(M,x[k*h]),h>=2&&s.setY(M,x[k*h+1]),h>=3&&s.setZ(M,x[k*h+2]),h>=4&&s.setW(M,x[k*h+3]),h>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return s})},ee.prototype.loadTexture=function(t){var i,n=this,a=this.json,r=this.options,s=this.textureLoader,o=window.URL||window.webkitURL,h=a.textures[t],l=h.extensions||{},d=(i=l[w.MSFT_TEXTURE_DDS]?a.images[l[w.MSFT_TEXTURE_DDS].source]:a.images[h.source]).uri,f=!1;return void 0!==i.bufferView&&(d=n.getDependency("bufferView",i.bufferView).then(function(e){f=!0;var t=new Blob([e],{type:i.mimeType});return d=o.createObjectURL(t)})),c.a.resolve(d).then(function(t){var i=e.Loader.Handlers.get(t);return i||(i=l[w.MSFT_TEXTURE_DDS]?n.extensions[w.MSFT_TEXTURE_DDS].ddsLoader:s),new c.a(function(e,n){i.load(X(t,r.path),e,void 0,n)})}).then(function(t){!0===f&&o.revokeObjectURL(d),t.flipY=!1,void 0!==h.name&&(t.name=h.name),i.mimeType in K&&(t.format=K[i.mimeType]);var n=(a.samplers||{})[h.sampler]||{};return t.magFilter=P[n.magFilter]||e.LinearFilter,t.minFilter=P[n.minFilter]||e.LinearMipMapLinearFilter,t.wrapS=O[n.wrapS]||e.RepeatWrapping,t.wrapT=O[n.wrapT]||e.RepeatWrapping,t})},ee.prototype.assignTexture=function(t,i,n){var a=this;return this.getDependency("texture",n.index).then(function(r){switch(i){case"aoMap":case"emissiveMap":case"metalnessMap":case"normalMap":case"roughnessMap":r.format=e.RGBFormat}if(a.extensions[w.KHR_TEXTURE_TRANSFORM]){var s=void 0!==n.extensions?n.extensions[w.KHR_TEXTURE_TRANSFORM]:void 0;s&&(r=a.extensions[w.KHR_TEXTURE_TRANSFORM].extendTexture(r,s))}t[i]=r})},ee.prototype.loadMaterial=function(t){var i,n=this.json,a=this.extensions,r=n.materials[t],s={},o=r.extensions||{},h=[];if(o[w.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var l=a[w.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];i=l.getMaterialType(r),h.push(l.extendParams(s,r,this))}else if(o[w.KHR_MATERIALS_UNLIT]){var d=a[w.KHR_MATERIALS_UNLIT];i=d.getMaterialType(r),h.push(d.extendParams(s,r,this))}else{i=e.MeshStandardMaterial;var f=r.pbrMetallicRoughness||{};if(s.color=new e.Color(1,1,1),s.opacity=1,Array.isArray(f.baseColorFactor)){var u=f.baseColorFactor;s.color.fromArray(u),s.opacity=u[3]}void 0!==f.baseColorTexture&&h.push(this.assignTexture(s,"map",f.baseColorTexture)),s.metalness=void 0!==f.metallicFactor?f.metallicFactor:1,s.roughness=void 0!==f.roughnessFactor?f.roughnessFactor:1,void 0!==f.metallicRoughnessTexture&&(h.push(this.assignTexture(s,"metalnessMap",f.metallicRoughnessTexture)),h.push(this.assignTexture(s,"roughnessMap",f.metallicRoughnessTexture)))}!0===r.doubleSided&&(s.side=e.DoubleSide);var p=r.alphaMode||N;return p===V?s.transparent=!0:(s.transparent=!1,p===z&&(s.alphaTest=void 0!==r.alphaCutoff?r.alphaCutoff:.5)),void 0!==r.normalTexture&&i!==e.MeshBasicMaterial&&(h.push(this.assignTexture(s,"normalMap",r.normalTexture)),s.normalScale=new e.Vector2(1,1),void 0!==r.normalTexture.scale&&s.normalScale.set(r.normalTexture.scale,r.normalTexture.scale)),void 0!==r.occlusionTexture&&i!==e.MeshBasicMaterial&&(h.push(this.assignTexture(s,"aoMap",r.occlusionTexture)),void 0!==r.occlusionTexture.strength&&(s.aoMapIntensity=r.occlusionTexture.strength)),void 0!==r.emissiveFactor&&i!==e.MeshBasicMaterial&&(s.emissive=(new e.Color).fromArray(r.emissiveFactor)),void 0!==r.emissiveTexture&&i!==e.MeshBasicMaterial&&h.push(this.assignTexture(s,"emissiveMap",r.emissiveTexture)),c.a.all(h).then(function(){var t;return t=i===e.ShaderMaterial?a[w.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(s):new i(s),void 0!==r.name&&(t.name=r.name),t.map&&(t.map.encoding=e.sRGBEncoding),t.emissiveMap&&(t.emissiveMap.encoding=e.sRGBEncoding),t.specularMap&&(t.specularMap.encoding=e.sRGBEncoding),Y(t,r),r.extensions&&Z(a,t,r),t})},ee.prototype.loadGeometries=function(t){var i,n=this,a=this.extensions,r=this.primitiveCache,s=function(e){if(e.length<2)return!1;var t=e[0],i=t.targets||[];if(void 0===t.indices)return!1;for(var n=1,a=e.length;n<a;n++){var r=e[n];if(t.mode!==r.mode)return!1;if(void 0===r.indices)return!1;if(r.extensions&&r.extensions[w.KHR_DRACO_MESH_COMPRESSION])return!1;if(!q(t.attributes,r.attributes))return!1;var s=r.targets||[];if(i.length!==s.length)return!1;for(var o=0,h=i.length;o<h;o++)if(!q(i[o],s[o]))return!1}return!0}(t);function o(e){return a[w.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,n).then(function(t){return te(t,e,n)})}s&&(i=t,t=[t[0]]);for(var h=[],l=0,d=t.length;l<d;l++){var f,u=t[l],p=Q(u),g=r[p];if(g)h.push(g.promise);else f=u.extensions&&u.extensions[w.KHR_DRACO_MESH_COMPRESSION]?o(u):te(new e.BufferGeometry,u,n),r[p]={primitive:u,promise:f},h.push(f)}return c.a.all(h).then(function(a){if(s){var r=a[0],o=n.multiPassGeometryCache,h=function(e,t){for(var i=e.uuid,n=0,a=t.length;n<a;n++)i+=n+Q(t[n]);return i}(r,i);if(null!==(g=o[h]))return[g.geometry];var l=new e.BufferGeometry;for(var d in l.name=r.name,l.userData=r.userData,r.attributes)l.addAttribute(d,r.attributes[d]);for(var d in r.morphAttributes)l.morphAttributes[d]=r.morphAttributes[d];for(var f=[],u=0,p=i.length;u<p;u++)f.push(n.getDependency("accessor",i[u].indices));return c.a.all(f).then(function(e){for(var t=[],n=0,a=0,s=i.length;a<s;a++){for(var c=e[a],d=0,f=c.count;d<f;d++)t.push(c.array[d]);l.addGroup(n,c.count,a),n+=c.count}return l.setIndex(t),o[h]={geometry:l,baseGeometry:r,primitives:i},[l]})}if(a.length>1&&void 0!==e.BufferGeometryUtils){for(u=1,p=t.length;u<p;u++)if(t[0].mode!==t[u].mode)return a;var g;o=n.multiplePrimitivesCache,h=function(e){for(var t="",i=0,n=e.length;i<n;i++)t+=":"+e[i].uuid;return t}(a);if(g=o[h]){if(null!==g.geometry)return[g.geometry]}else{l=e.BufferGeometryUtils.mergeBufferGeometries(a,!0);if(o[h]={geometry:l,baseGeometries:a},null!==l)return[l]}}return a})},ee.prototype.loadMesh=function(t){for(var i=this,n=this.json,r=this.extensions,s=n.meshes[t],o=s.primitives,h=[],l=0,d=o.length;l<d;l++){var f=void 0===o[l].material?new e.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:e.FrontSide}):this.getDependency("material",o[l].material);h.push(f)}return c.a.all(h).then(function(n){return i.loadGeometries(o).then(function(h){for(var l=1===h.length&&h[0].groups.length>0,c=[],d=0,f=h.length;d<f;d++){var u,p=h[d],g=o[d],m=l?n:n[d];if(g.mode===I||g.mode===D||g.mode===j||void 0===g.mode)!0===(u=!0===s.isSkinnedMesh?new e.SkinnedMesh(p,m):new e.Mesh(p,m)).isSkinnedMesh&&u.normalizeSkinWeights(),g.mode===D?u.drawMode=e.TriangleStripDrawMode:g.mode===j&&(u.drawMode=e.TriangleFanDrawMode);else if(g.mode===R)u=new e.LineSegments(p,m);else if(g.mode===F)u=new e.Line(p,m);else if(g.mode===L)u=new e.LineLoop(p,m);else{if(g.mode!==E)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+g.mode);u=new e.Points(p,m)}a()(u.geometry.morphAttributes).length>0&&W(u,s),u.name=s.name||"mesh_"+t,h.length>1&&(u.name+="_"+d),Y(u,s),c.push(u);for(var v=l?u.material:[u.material],b=void 0!==p.attributes.tangent,y=void 0!==p.attributes.color,_=void 0===p.attributes.normal,x=!0===u.isSkinnedMesh,k=a()(p.morphAttributes).length>0,S=k&&void 0!==p.morphAttributes.normal,M=0,T=v.length;M<T;M++){m=v[M];if(u.isPoints){var A="PointsMaterial:"+m.uuid,C=i.cache.get(A);C||(C=new e.PointsMaterial,e.Material.prototype.copy.call(C,m),C.color.copy(m.color),C.map=m.map,C.lights=!1,i.cache.add(A,C)),m=C}else if(u.isLine){A="LineBasicMaterial:"+m.uuid;var P=i.cache.get(A);P||(P=new e.LineBasicMaterial,e.Material.prototype.copy.call(P,m),P.color.copy(m.color),P.lights=!1,i.cache.add(A,P)),m=P}if(b||y||_||x||k){A="ClonedMaterial:"+m.uuid+":";m.isGLTFSpecularGlossinessMaterial&&(A+="specular-glossiness:"),x&&(A+="skinning:"),b&&(A+="vertex-tangents:"),y&&(A+="vertex-colors:"),_&&(A+="flat-shading:"),k&&(A+="morph-targets:"),S&&(A+="morph-normals:");var O=i.cache.get(A);O||(O=m.isGLTFSpecularGlossinessMaterial?r[w.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].cloneMaterial(m):m.clone(),x&&(O.skinning=!0),b&&(O.vertexTangents=!0),y&&(O.vertexColors=e.VertexColors),_&&(O.flatShading=!0),k&&(O.morphTargets=!0),S&&(O.morphNormals=!0),i.cache.add(A,O)),m=O}v[M]=m,m.aoMap&&void 0===p.attributes.uv2&&void 0!==p.attributes.uv&&(console.log("THREE.GLTFLoader: Duplicating UVs to support aoMap."),p.addAttribute("uv2",new e.BufferAttribute(p.attributes.uv.array,2))),m.isGLTFSpecularGlossinessMaterial&&(u.onBeforeRender=r[w.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].refreshUniforms)}u.material=l?v:v[0]}if(1===c.length)return c[0];var G=new e.Group;for(d=0,f=c.length;d<f;d++)G.add(c[d]);return G})})},ee.prototype.loadCamera=function(t){var i,n=this.json.cameras[t],a=n[n.type];if(a)return"perspective"===n.type?i=new e.PerspectiveCamera(e.Math.radToDeg(a.yfov),a.aspectRatio||1,a.znear||1,a.zfar||2e6):"orthographic"===n.type&&(i=new e.OrthographicCamera(a.xmag/-2,a.xmag/2,a.ymag/2,a.ymag/-2,a.znear,a.zfar)),void 0!==n.name&&(i.name=n.name),Y(i,n),c.a.resolve(i);console.warn("THREE.GLTFLoader: Missing camera parameters.")},ee.prototype.loadSkin=function(e){var t=this.json.skins[e],i={joints:t.joints};return void 0===t.inverseBindMatrices?c.a.resolve(i):this.getDependency("accessor",t.inverseBindMatrices).then(function(e){return i.inverseBindMatrices=e,i})},ee.prototype.loadAnimation=function(t){for(var i=this.json.animations[t],n=[],a=[],r=[],s=[],o=[],h=0,l=i.channels.length;h<l;h++){var d=i.channels[h],f=i.samplers[d.sampler],u=d.target,p=void 0!==u.node?u.node:u.id,g=void 0!==i.parameters?i.parameters[f.input]:f.input,m=void 0!==i.parameters?i.parameters[f.output]:f.output;n.push(this.getDependency("node",p)),a.push(this.getDependency("accessor",g)),r.push(this.getDependency("accessor",m)),s.push(f),o.push(u)}return c.a.all([c.a.all(n),c.a.all(a),c.a.all(r),c.a.all(s),c.a.all(o)]).then(function(n){for(var a=n[0],r=n[1],s=n[2],o=n[3],h=n[4],l=[],c=0,d=a.length;c<d;c++){var f=a[c],u=r[c],p=s[c],g=o[c],m=h[c];if(void 0!==f){var w;switch(f.updateMatrix(),f.matrixAutoUpdate=!0,U[m.path]){case U.weights:w=e.NumberKeyframeTrack;break;case U.rotation:w=e.QuaternionKeyframeTrack;break;case U.position:case U.scale:default:w=e.VectorKeyframeTrack}var v=f.name?f.name:f.uuid,b=void 0!==g.interpolation?H[g.interpolation]:e.InterpolateLinear,y=[];U[m.path]===U.weights?f.traverse(function(e){!0===e.isMesh&&e.morphTargetInfluences&&y.push(e.name?e.name:e.uuid)}):y.push(v);for(var _=0,x=y.length;_<x;_++){var k=new w(y[_]+"."+U[m.path],e.AnimationUtils.arraySlice(u.array,0),e.AnimationUtils.arraySlice(p.array,0),b);"CUBICSPLINE"===g.interpolation&&(k.createInterpolant=function(e){return new A(this.times,this.values,this.getValueSize()/3,e)},k.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),l.push(k)}}}var S=void 0!==i.name?i.name:"animation_"+t;return new e.AnimationClip(S,void 0,l)})},ee.prototype.loadNode=function(t){var i=this.json,n=this.extensions,a=this,r=i.meshReferences,s=i.meshUses,o=i.nodes[t];return(!0===o.isBone?c.a.resolve(new e.Bone):void 0!==o.mesh?a.getDependency("mesh",o.mesh).then(function(e){var t;if(r[o.mesh]>1){var i=s[o.mesh]++;(t=e.clone()).name+="_instance_"+i,t.onBeforeRender=e.onBeforeRender;for(var n=0,a=t.children.length;n<a;n++)t.children[n].name+="_instance_"+i,t.children[n].onBeforeRender=e.children[n].onBeforeRender}else t=e;return void 0!==o.weights&&t.traverse(function(e){if(e.isMesh)for(var t=0,i=o.weights.length;t<i;t++)e.morphTargetInfluences[t]=o.weights[t]}),t}):void 0!==o.camera?a.getDependency("camera",o.camera):o.extensions&&o.extensions[w.KHR_LIGHTS_PUNCTUAL]&&void 0!==o.extensions[w.KHR_LIGHTS_PUNCTUAL].light?a.getDependency("light",o.extensions[w.KHR_LIGHTS_PUNCTUAL].light):c.a.resolve(new e.Object3D)).then(function(t){if(void 0!==o.name&&(t.name=e.PropertyBinding.sanitizeNodeName(o.name)),Y(t,o),o.extensions&&Z(n,t,o),void 0!==o.matrix){var i=new e.Matrix4;i.fromArray(o.matrix),t.applyMatrix(i)}else void 0!==o.translation&&t.position.fromArray(o.translation),void 0!==o.rotation&&t.quaternion.fromArray(o.rotation),void 0!==o.scale&&t.scale.fromArray(o.scale);return t})},ee.prototype.loadScene=function(){function t(i,n,a,r){var s=a.nodes[i];return r.getDependency("node",i).then(function(t){return void 0===s.skin?t:r.getDependency("skin",s.skin).then(function(e){for(var t=[],n=0,a=(i=e).joints.length;n<a;n++)t.push(r.getDependency("node",i.joints[n]));return c.a.all(t)}).then(function(n){for(var a=!0===t.isGroup?t.children:[t],r=0,s=a.length;r<s;r++){for(var o=a[r],h=[],l=[],c=0,d=n.length;c<d;c++){var f=n[c];if(f){h.push(f);var u=new e.Matrix4;void 0!==i.inverseBindMatrices&&u.fromArray(i.inverseBindMatrices.array,16*c),l.push(u)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',i.joints[c])}o.bind(new e.Skeleton(h,l),o.matrixWorld)}return t});var i}).then(function(e){n.add(e);var i=[];if(s.children)for(var o=s.children,h=0,l=o.length;h<l;h++){var d=o[h];i.push(t(d,e,a,r))}return c.a.all(i)})}var i=this.json,n=this.extensions,a=this.json.scenes[0],r=new e.Scene;void 0!==a.name&&(r.name=a.name),Y(r,a),a.extensions&&Z(n,r,a);for(var s=a.nodes||[],o=[],h=0,l=s.length;h<l;h++)o.push(t(s[h],r,i,this));return c.a.all(o).then(function(){return r})}}).call(t,i("Ml+6"))},NHnr:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){var t,n,a,r=i("cbRa"),s=i("c6m3");t=new r.a,n=new s.a,a=document.getElementById("canvas"),n.init(a),t.setGame(n),e("#foreground").click(function(t){var i=e("#canvas").offset(),a={};a.x=t.pageX-i.left,a.y=t.pageY-i.top,n.click(a.x,a.y)}),t.start("TEST")}.call(t,i("7t+N"))},NxES:function(e,t){e.exports={id:"spectre",width:34,height:34,animations:{atk_right:{length:8,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:6,row:3},walk_up:{length:8,row:4},idle_up:{length:8,row:5},atk_down:{length:6,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offset_x:-9,offset_y:-13}},Oy9j:function(e,t){e.exports={id:"deathknight",width:42,height:42,animations:{atk_right:{length:5,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:5,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:5,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offset_x:-13,offset_y:-17}},PznX:function(e,t){e.exports={id:"eye",width:40,height:48,animations:{atk_right:{length:6,row:0},walk_right:{length:4,row:1},idle_right:{length:14,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:14,row:5},atk_down:{length:8,row:6},walk_down:{length:4,row:7},idle_down:{length:14,row:8}},offset_x:-12,offset_y:-18}},QDfD:function(e,t){e.exports={"1.3.132.0.10":"secp256k1","1.3.132.0.33":"p224","1.2.840.10045.3.1.1":"p192","1.2.840.10045.3.1.7":"p256","1.3.132.0.34":"p384","1.3.132.0.35":"p521"}},Qyla:function(e,t){e.exports={id:"target",width:16,height:16,animations:{move:{length:4,row:0},atk:{length:4,row:1}}}},RVzG:function(e,t){e.exports={id:"redarmor",width:32,height:32,animations:{atk_right:{length:5,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:5,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:5,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offset_x:-8,offset_y:-12}},RZ8U:function(e,t){e.exports={id:"item-redsword",width:16,height:16,animations:{idle:{length:6,row:0}},offset_x:0,offset_y:0}},RgGw:function(e,t){e.exports={id:"item-flask",width:16,height:16,animations:{idle:{length:6,row:0}},offset_x:0,offset_y:0}},"Rr+P":function(e,t,i){"use strict";var n=i("fZjL"),a=i.n(n),r=i("pFYg"),s=i.n(r),o=i("OvRC"),h=i.n(o),l=i("XDXK"),c=function(e,t,i,n,a,r,s){this.parseSheet(r,s),this.scale=void 0!==i?i:1,this.setText(t);n=void 0!==n?n:0,a=void 0!==a?a:0;var o=this.calculateDimensions();l.a.bind(this)(e,n,a,o.width,o.height),this.pivot.x=0,this.pivot.y=0};(c.prototype=h()(l.a.prototype)).setText=function(e){if(this.text!==e){this.text=void 0!==e?e.toString():"",this.characters=this.text.split("");var t=this.calculateDimensions();this.width=t.width,this.height=t.height}},c.prototype.parseSheet=function(e,t){if(void 0===e&&!this.sheet)throw new Error("Sheet image path missing when creating sprite from sheet");if(void 0===t&&!this.sheetData)throw new Error("Sheet data path missing when creating sprite from sheet");if(!e&&this.sheet||(this.sheet=AssetLoader.getAssetById(e)),!t&&this.sheetData||(this.sheetData=AssetLoader.getAssetById(t)),"object"!==s()(this.sheetData))throw new Error("Invalid sheet data "+t+" -- not an object");this.characterData={};for(var i=a()(this.sheetData),n=i.length,r=0;r<n;r++){var o=i[r],h=this.sheetData[o];h.uv0[0]=Math.min(1,Math.max(0,h.uv0[0])),h.uv0[1]=Math.min(1,Math.max(0,h.uv0[1])),h.uv1[0]=Math.min(1,Math.max(0,h.uv1[0])),h.uv1[1]=Math.min(1,Math.max(0,h.uv1[1])),this.characterData[o]={x:Math.round(h.uv0[0]*this.sheet.width),y:Math.round((1-h.uv0[1])*this.sheet.height),width:Math.round((h.uv1[0]-h.uv0[0])*this.sheet.width),height:Math.round((h.uv0[1]-h.uv1[1])*this.sheet.height)};var l=this.characterData[o];l.width=Math.max(1e-5,l.width),l.height=Math.max(1e-5,l.height)}},c.prototype.calculateDimensions=function(){for(var e={width:0,height:0},t=this.characters.length,i=0;i<t;i++){var n=this.characters[i];this.characterData[n]||(n=a()(this.characterData)[0]);var r=this.characterData[n];e.width+=r?r.width:0,e.height=Math.max(e.height,r?r.height:0)}return e.width*=this.scale,e.height*=this.scale,e},c.prototype.draw=function(e,t,i){for(var n=this.characters.length,a=0;a<n;a++){var r=this.characters[a],s=this.drawCharacter(e,r,t,i);t=s.x+s.width,i=s.y}},c.prototype.drawCharacter=function(e,t,i,n){var a=this.characterData[t],r=!1;void 0===a&&(a={width:6,height:6},r=!0);var s=a.width*this.scale,o=a.height*this.scale;return r||e.drawImage(this.sheet,a.x,a.y,a.width,a.height,i,n,s,o),{x:i,y:n,width:s,height:o}},t.a=c},SML3:function(e,t){e.exports={id:"item-goldenarmor",width:16,height:16,animations:{idle:{length:6,row:0}},offset_x:0,offset_y:0}},Sqs0:function(e,t){e.exports={id:"death",width:24,height:24,animations:{death:{length:6,row:0}},offset_x:-4,offset_y:-4}},TAbc:function(e,t,i){"use strict";var n=i("Zrlr"),a=i.n(n),r=i("wxAW"),s=i.n(r),o=function(){function e(){a()(this,e),this.startValue=0,this.endValue=0,this.duration=0,this.inProgress=!1}return s()(e,[{key:"start",value:function(e,t,i,n,a,r){this.startTime=e,this.updateFunction=t,this.stopFunction=i,this.startValue=n,this.endValue=a,this.duration=r,this.inProgress=!0,this.count=0}},{key:"step",value:function(e){if(this.inProgress)if(this.count>0)this.count-=1,log.debug(e+": jumped frame");else{var t=e-this.startTime;t>this.duration&&(t=this.duration);var i=this.endValue-this.startValue,n=this.startValue+i/this.duration*t;n=Math.round(n),t===this.duration||n===this.endValue?(this.stop(),this.stopFunction&&this.stopFunction()):this.updateFunction&&this.updateFunction(n)}}},{key:"restart",value:function(e,t,i){this.start(e,this.updateFunction,this.stopFunction,t,i,this.duration),this.step(e)}},{key:"stop",value:function(){this.inProgress=!1}}]),e}();t.a=o},Tb6K:function(e,t){e.exports={id:"lavanpc",width:24,height:24,animations:{idle_down:{length:2,row:0}},offset_x:-4,offset_y:-8}},UStB:function(e,t){e.exports={id:"goldenarmor",width:32,height:32,animations:{atk_right:{length:5,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:5,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:5,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offset_x:-8,offset_y:-12}},UcV4:function(e,t){e.exports={id:"crab",width:32,height:32,animations:{death:{length:8,row:0},atk_right:{length:7,row:1},walk_right:{length:6,row:2},idle_right:{length:4,row:3},atk_up:{length:8,row:4},idle_up:{length:4,row:5},walk_up:{length:6,row:6},atk_down:{length:8,row:7},walk_down:{length:6,row:8},idle_down:{length:7,row:9}},offset_x:-8,offset_y:-8}},"X+Uv":function(e,t,i){"use strict";(function(e){var n=i("Zrlr"),a=i.n(n),r=i("wxAW"),s=i.n(r),o=i("yh7f"),h=i("DwfQ"),l=i("ZQ2e"),c=i("zTqn"),d=function(){function t(){a()(this,t)}return s()(t,null,[{key:"createEntity",value:function(i,n,a){if(i){if(!e.isFunction(t.builders[i]))throw Error(i+" is not a valid Entity type");return t.builders[i](n,a)}}}]),t}();d.builders=[],d.builders[o.a.Entities.DEATHKNIGHT]=function(e){return new c.a(e,o.a.Entities.DEATHKNIGHT)},d.builders[o.a.Entities.CHEST]=function(e){return new l.a(e)},d.builders[o.a.Entities.FIRE]=function(e){var t=new h.a(e,o.a.Entities.FIRE);return t.attachPointLight(16760992,1),t},t.a=d}).call(t,i("rdLu"))},XDXK:function(e,t,i){"use strict";var n=i("fZjL"),a=i.n(n),r=i("uL5Q"),s=function(e,t,i,n,a){this.ui=e,this.x=void 0!==t?t:0,this.y=void 0!==i?i:0,this.width=void 0!==n?n:0,this.height=void 0!==a?a:0,this.rotation=0,this.alpha=1,this.visible=!0,this.pivot={x:.5,y:.5},this.anchor={x:r.a.left,y:r.a.top},this.smoothing=!0,this.stretch={x:!1,y:!1},this.offset={left:0,top:0,right:0,bottom:0},this.parent=void 0};s.prototype.getBounds=function(){var e=this.determinePositionInCanvas(),t=this.determineDimensionsInCanvas();return{x:e.x,y:e.y,width:t.width,height:t.height}},s.prototype.getParentBounds=function(){if(void 0===this.parent)return{x:0,y:0,width:this.ui.width,height:this.ui.height};if(this.parent instanceof s)return this.parent.getBounds();throw new Error("DisplayObject.parent should always be an instance of DisplayObject")},s.prototype.determinePositionInCanvas=function(){var e={x:"number"==typeof this.x?this.x:0,y:"number"==typeof this.y?this.y:0};return e=this.adjustPositionForAnchor(e.x,e.y),e=this.adjustPositionForPivot(e.x,e.y)},s.prototype.determineDimensionsInCanvas=function(){return{width:"number"==typeof this.width?this.width:0,height:"number"==typeof this.height?this.height:0}},s.prototype.adjustPositionForAnchor=function(e,t){var i=this.getParentBounds();return this.anchor.x===r.a.left?e+=i.x:this.anchor.x===r.a.right?e+=i.x+i.width-this.width:this.anchor.x===r.a.center&&(e+=i.x+i.width/2-this.width/2),this.anchor.y===r.a.top?t+=i.y:this.anchor.y===r.a.bottom?t+=i.y+i.height-this.height:this.anchor.y===r.a.center&&(t+=i.y+i.height/2-this.height/2),{x:e,y:t}},s.prototype.getOffsetInCanvas=function(){for(var e,t={left:this.offset.left,top:this.offset.top,right:this.offset.right,bottom:this.offset.bottom},i=a()(t),n=i.length,r=0;r<n;r++){var s=i[r],o=t[s];if("number"!=typeof o){e=e||this.getParentBounds();var h=parseFloat(o.match(/^([0-9\.]+)%$/)[1]);t[s]=h/100*e.width}}return t},s.prototype.adjustPositionForPivot=function(e,t){return{x:e-=this.width*this.pivot.x,y:t-=this.height*this.pivot.y}},s.prototype.shouldReceiveEvents=function(){return this.visible},s.prototype.onClick=function(e){this.ui.addEventListener("click",e,this)},s.prototype.render=function(e){if(this.visible){e.save();var t=this.getBounds();e.globalAlpha=this.alpha,void 0!==e.mozImageSmoothingEnabled&&(e.mozImageSmoothingEnabled=this.smoothing),void 0!==e.webkitImageSmoothingEnabled&&(e.webkitImageSmoothingEnabled=this.smoothing),void 0!==e.msImageSmoothingEnabled&&(e.msImageSmoothingEnabled=this.smoothing),void 0!==e.imageSmoothingEnabled&&(e.imageSmoothingEnabled=this.smoothing),this.draw(e,t.x,t.y,t.width,t.height),e.restore()}},s.draw=function(e,t,i,n,a){},Object.defineProperty(s.prototype,"_proxied_visible",{get:function(){return!(this.parent&&this.parent!==this&&!this.parent.visible)&&this._visible},set:function(e){return this._visible=e}}),t.a=s},YAyI:function(e,t,i){"use strict";var n=i("Zx67"),a=i.n(n),r=i("Zrlr"),s=i.n(r),o=i("zwoO"),h=i.n(o),l=i("Pf15"),c=i.n(l),d=i("wxAW"),f=i.n(d),u=function(){function e(){s()(this,e)}return f()(e,[{key:"begin",value:function(){this.begin_callback&&this.begin_callback()}},{key:"end",value:function(){this.end_callback&&this.end_callback()}},{key:"click",value:function(e,t){this.click_callback&&this.click_callback(e,t)}},{key:"onBegin",value:function(e){this.begin_callback=e}},{key:"onEnd",value:function(e){this.end_callback=e}},{key:"transitionTo",value:function(e){}},{key:"onClick",value:function(e){this.click_callback=e}},{key:"onUpdate",value:function(e){this.update_callback=e}},{key:"update",value:function(){this.update_callback&&this.update_callback()}}]),e}(),p=(i("VI/i"),function(){function e(t){s()(this,e),this.image=t,this.x=0,this.y=0,this.attackRange=32,this.moveSpeed=1,this.offset={x:0,y:0},this.target=null,this.flipX=!1,this.anims={idle:{animRow:2,animFrameCount:2},walk:{animRow:1,animFrameCount:4},attack:{animRow:0,animFrameCount:5}},this.currentFrame=0,this.currentFrameMax=2,this.currentRow=2,this.state="idle",this.utime=Date.now()+200,this.tilesize=32,this.health=100,this.Maxhealth=100}return f()(e,[{key:"setAnim",value:function(e){this.state!==e&&(this.state=e,this.currentFrame=0,this.currentRow=this.anims[e].animRow,this.currentFrameMax=this.anims[e].animFrameCount)}},{key:"render",value:function(e){e.save(),e.translate(this.x+this.offset.x,this.y+this.offset.y),this.flipX&&(e.translate(this.tilesize,0),e.scale(-1,1)),e.drawImage(this.image,this.currentFrame*this.tilesize,this.currentRow*this.tilesize,this.tilesize,this.tilesize,0,0,this.tilesize,this.tilesize);var t=this.tilesize;e.fillStyle="#000",e.fillRect(-1,-4,t+2,4),e.fillStyle="#F00",e.fillRect(0,-3,t*this.health/this.Maxhealth,2),e.restore()}},{key:"update",value:function(){var e=!1;if(this.utime<=Date.now()&&(this.utime+=200,this.currentFrame=(this.currentFrame+1)%this.currentFrameMax,3==this.currentFrame&&"attack"===this.state&&(e=!0)),this.target){var t=this.target.x-this.x;Math.abs(t)>this.attackRange?(t>0?this.x+=this.moveSpeed:this.x-=this.moveSpeed,this.setAnim("walk")):(this.setAnim("attack"),e&&(this.animFrameCount,this.target.health=Math.max(0,this.target.health-10)))}}}]),e}()),g=(function(e){function t(e){s()(this,t);var i=h()(this,(t.__proto__||a()(t)).call(this)),n=document.getElementById("foreground").getContext("2d"),r=new p(e.sprites.clotharmor),o=new p(e.sprites.deathknight);return r.x=200,r.y=200,r.offset.y=5,r.target=o,o.x=600,o.y=200,o.tilesize=42,o.target=r,o.flipX=!0,i.onUpdate(function(){r.update(),o.update();n.fillStyle="#ffffff",n.fillRect(147,117,506,206),n.fillStyle="#606060",n.fillRect(150,120,500,200),n.fillStyle="#101010",n.fillRect(150,232,500,87),r.render(n),o.render(n),0===o.health&&(r.target=null,r.setAnim("idle"),n.font="50px Arial",n.fillStyle="white",n.textAlign="center",n.fillText("Victory",400,160))}),i}c()(t,e)}(u),function(e){function t(e,i){s()(this,t);var n=h()(this,(t.__proto__||a()(t)).call(this));return n.game=e,n.kind=i,n.onBegin(function(){"enter"===i&&(e.player.mesh.visible=!1,n.skipFrame=60)}),n.onUpdate(function(){"enter"===i&&(n.skipFrame>0?--n.skipFrame:e.player.mesh.visible?e.player.isFading:(e.player.mesh.visible=!0,e.player.mesh.material.transparent=!0,e.player.mesh.material.opacity=0,e.player.fadeIn(e.currentTime)))}),n}return c()(t,e),t}(u));t.a=g},ZBgj:function(e,t){e.exports={id:"item-bluesword",width:16,height:16,animations:{idle:{length:6,row:0}},offset_x:0,offset_y:0}},ZQ2e:function(e,t,i){"use strict";var n=i("Zx67"),a=i.n(n),r=i("Zrlr"),s=i.n(r),o=i("zwoO"),h=i.n(o),l=i("Pf15"),c=i.n(l),d=i("yh7f"),f=function(e){function t(e){return s()(this,t),h()(this,(t.__proto__||a()(t)).call(this,e,d.a.Entities.CHEST))}return c()(t,e),t}(i("DwfQ").a);t.a=f},aNYQ:function(e,t){e.exports={id:"forestnpc",width:24,height:24,animations:{idle_down:{length:2,row:0}},offset_x:-4,offset_y:-8}},"b8n+":function(e,t,i){"use strict";var n=i("pFYg"),a=i.n(n),r=i("OvRC"),s=i.n(r),o=i("XDXK"),h=function(e,t,i,n,a,r,s,h){this.setAssetPath(t,s,h);i=void 0!==i?i:0,n=void 0!==n?n:0,a=void 0!==a?a:null,r=void 0!==r?r:null;this.asset?(a=null!==a?a:this.asset.width,r=null!==r?r:this.asset.height):this.sheet&&this.sheetImageData&&(a=null!==a?a:this.sheetImageData.frame.w,r=null!==r?r:this.sheetImageData.frame.h),o.a.bind(this)(e,i,n,a,r)};(h.prototype=s()(o.a.prototype)).draw=function(e,t,i,n,a){this.sheet&&this.sheetImageData?e.drawImage(this.sheet,this.sheetImageData.frame.x,this.sheetImageData.frame.y,this.sheetImageData.frame.w,this.sheetImageData.frame.h,t,i,n,a):e.drawImage(this.asset,t,i,n,a)},h.prototype.setAssetPath=function(e,t,i){this.assetPath=e,void 0!==t||this.sheet?(this.asset=null,this.parseSheet(e,t,i)):(this.asset=AssetLoader.getAssetById(e),this.sheet=null)},h.prototype.parseSheet=function(e,t,i){if(void 0===i&&!this.sheetData)throw new Error("Sheet data path missing when creating sprite from sheet");if(!t&&this.sheet||(this.sheet=AssetLoader.getAssetById(t)),!i&&this.sheetData||(this.sheetData=AssetLoader.getAssetById(i)),"object"!==a()(this.sheetData))throw new Error("Invalid sheet data "+i+" -- not an object");if(!this.sheetData.frames)throw new Error("Invalid sheet data "+i+" -- does not have frames");var n;if(this.sheetData.frames.forEach(function(t){t.filename===e&&(n=t)}),!n)throw new Error('Asset "'+e+'" does not exist in sheet "'+i+'"');this.sheetImageData=n},t.a=h},c6m3:function(e,t,i){"use strict";(function(e,n){var a=i("BO1k"),r=i.n(a),s=i("Zrlr"),o=i.n(s),h=i("wxAW"),l=i.n(h),c=i("1fqz"),d=i("fzpQ"),f=i("ITPp"),u=i("GoZD"),p=i("m3jU"),g=i("X+Uv"),m=i("N9/5"),w=i("wVBE"),v=i.n(w),b=i("ZQ2e"),y=i("YAyI"),_=i("AeT2"),x=i("KGr3"),k=i("8qcI"),S=function(){function t(){o()(this,t)}return l()(t,[{key:"init",value:function(t){var i=t.width,n=t.height;this.canvas=t;var a=new e.WebGLRenderer({canvas:t});a.shadowMap.enabled=!0,a.setPixelRatio(window.devicePixelRatio),a.setSize(i,n);var r=new e.PerspectiveCamera(30,t.width/t.height,1,1e3);r.position.set(0,100,250);var s=new _.a(t,n);this.renderer=a,this.camera=r,this.ui=s;var o=new e.Scene;this.scene=o,r.lookAt(new e.Vector3(0,0,0)),new v.a(r,a.domElement),this.entities={},this.entityGrid=null,this.phase=null,this.nextPhase=null}},{key:"tick",value:function(){this.currentTime=(new Date).getTime(),this.updater.update(),this.ui.render(),this.renderer.render(this.scene,this.camera),this.isStopped||requestAnimationFrame(this.tick.bind(this))}},{key:"start",value:function(){this.tick()}},{key:"stop",value:function(){this.isStopped=!0}},{key:"run",value:function(t){var i=this;this.loadSprites(),this.loadMap(),this.loadModel(),this.updater=new d.a(this);var n=setInterval(function(){if(i.map.isLoaded&&i.isSpritesLoaded()&&i.model){for(clearInterval(n);i.scene.children.length>0;)i.scene.remove(i.scene.children[0]);var a=new x.a(i,i.map);i.world=a,i.scene.add(a.terrain),i.initEntityGrid(),p.a.setGridSize(i.map.tilesize);var s=new e.HemisphereLight(16777215,16777215,1);s.color.setHSL(.6,1,.6),s.groundColor.setHSL(.095,1,.75),s.position.set(0,50,0),i.scene.add(s);var o=2,h=!0,l=!1,d=void 0;try{for(var f,m=r()(i.map.props);!(h=(f=m.next()).done);h=!0){var w=f.value,v=g.a.createEntity(w.kind,o++,"");v.setGridPosition(w.x,w.y),v instanceof b.a&&(v.mesh=i.model.scene.clone(),v.mesh.scale.set(3,3,3)),i.addEntity(v),i.scene.add(v.mesh)}}catch(e){l=!0,d=e}finally{try{!h&&m.return&&m.return()}finally{if(l)throw d}}i.pathfinder=new u.a(i.map.width,i.map.height);var _=new c.a(1,t,"");_.setSprite(i.sprites.clotharmor),_.buildMesh(),_.onRequestPath(function(e,t){return i.findPath(_,e,t)}),_.onStopPathing(function(e,t){if(_.target instanceof b.a){var n=_.target;_.target=null,requestAnimationFrame(function(){i.removeEntity(n),i.scene.remove(n.mesh)})}}),_.setGridPosition(3,3),_.idle(),i.addEntity(_),i.unregisterEntityPosition(_),i.player=_,i.nextPhase=new y.a(i,"enter"),i.scene.add(i.player.mesh),i.start()}},100)}},{key:"loadSprites",value:function(){var e={},t=function(t){var i={data:t,image:null,isLoaded:!1};e[t.id]=i;var n=new Image;n.src="static/"+t.id+".png",n.onload=function(){i.image=n,i.isLoaded=!0,i.width=n.width/3,i.height=n.height/3}},i=!0,n=!1,a=void 0;try{for(var s,o=r()(k.a);!(i=(s=o.next()).done);i=!0){t(s.value)}}catch(e){n=!0,a=e}finally{try{!i&&o.return&&o.return()}finally{if(n)throw a}}this.sprites=e}},{key:"loadMap",value:function(){this.map=new f.a}},{key:"loadModel",value:function(){var e=this;(new m.a).load("static/treasure.glb",function(t){e.model=t},void 0,function(e){console.error(e)})}},{key:"isSpritesLoaded",value:function(){return!n.any(this.sprites,function(e){return!e.isLoaded})}},{key:"initEntityGrid",value:function(){this.entityGrid=[];for(var e=0;e<this.map.height;e+=1){this.entityGrid[e]=[];for(var t=0;t<this.map.width;t+=1)this.entityGrid[e][t]={}}}},{key:"addEntity",value:function(e){void 0===this.entities[e.id]&&(this.entities[e.id]=e,this.registerEntityPosition(e))}},{key:"removeEntity",value:function(e){e.id in this.entities&&(this.unregisterEntityPosition(e),delete this.entities[e.id])}},{key:"registerEntityPosition",value:function(e){var t=e.gridX,i=e.gridY;this.entityGrid[i][t][e.id]=e}},{key:"unregisterEntityPosition",value:function(e){var t=e.gridX,i=e.gridY;this.entityGrid[i][t][e.id]&&delete this.entityGrid[i][t][e.id]}},{key:"getEntityAt",value:function(e,t){if(this.map.isOutOfBounds(e,t)||!this.entityGrid)return null;var i=this.entityGrid[t][e],a=null;return n.size(i)>0&&(a=i[n.keys(i)[0]]),a}},{key:"getItemAt",value:function(e,t){return null}},{key:"getGridPosition",value:function(e,t){var i=this.map.tilesize;return{x:Math.floor((e.x-t.min.x)/i),y:Math.floor((e.z-t.min.y)/i)}}},{key:"click",value:function(t,i){if(this.ui&&this.ui.clickHandler(t,i))return;this.phase&&this.phase.click(t,i);var n=new e.Vector2;this.renderer.getSize(n);var a=new e.Vector2;a.x=t/n.x*2-1,a.y=-i/n.y*2+1;var s=new e.Raycaster;s.setFromCamera(a,this.camera);var o=s.intersectObjects(this.scene.children),h=!0,l=!1,c=void 0;try{for(var d,f=r()(o);!(h=(d=f.next()).done);h=!0){var u=d.value,p=this.getGridPosition(u.point,this.world.terrain.geometry.boundingBox),g=this.getEntityAt(p.x,p.y);g instanceof b.a?(this.player.setTarget(g),this.player.follow(g)):this.player.go(p.x,p.y)}}catch(e){l=!0,c=e}finally{try{!h&&f.return&&f.return()}finally{if(l)throw c}}}},{key:"forEachEntity",value:function(e){n.each(this.entities,function(t){e(t)})}},{key:"findPath",value:function(e,t,i){return this.map.isColliding(t,i)?[]:this.pathfinder&&e?this.pathfinder.findPath(this.map.grid,e,t,i,!1):[]}}]),t}();t.a=S}).call(t,i("Ml+6"),i("rdLu"))},cKQl:function(e,t){e.exports={id:"chest",width:16,height:16,animations:{idle_down:{length:1,row:0}},offset_x:0,offset_y:0}},cbRa:function(e,t,i){"use strict";var n=i("Zrlr"),a=i.n(n),r=i("wxAW"),s=i.n(r),o=function(){function e(){a()(this,e)}return s()(e,[{key:"setGame",value:function(e){this.game=e}},{key:"center",value:function(){window.scrollTo(0,1)}},{key:"start",value:function(e){this.center(),this.game.run()}}]),e}();t.a=o},e7Fs:function(e,t){e.exports={id:"villager",width:24,height:24,animations:{idle_down:{length:2,row:0}},offset_x:-4,offset_y:-8}},eOxi:function(e,t){e.exports={id:"coder",width:24,height:24,animations:{idle_down:{length:2,row:0}},offset_x:-4,offset_y:-7}},ejIc:function(e,t){e.exports={sha224WithRSAEncryption:{sign:"rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},"RSA-SHA224":{sign:"ecdsa/rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},sha256WithRSAEncryption:{sign:"rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},"RSA-SHA256":{sign:"ecdsa/rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},sha384WithRSAEncryption:{sign:"rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},"RSA-SHA384":{sign:"ecdsa/rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},sha512WithRSAEncryption:{sign:"rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA512":{sign:"ecdsa/rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA1":{sign:"rsa",hash:"sha1",id:"3021300906052b0e03021a05000414"},"ecdsa-with-SHA1":{sign:"ecdsa",hash:"sha1",id:""},sha256:{sign:"ecdsa",hash:"sha256",id:""},sha224:{sign:"ecdsa",hash:"sha224",id:""},sha384:{sign:"ecdsa",hash:"sha384",id:""},sha512:{sign:"ecdsa",hash:"sha512",id:""},"DSA-SHA":{sign:"dsa",hash:"sha1",id:""},"DSA-SHA1":{sign:"dsa",hash:"sha1",id:""},DSA:{sign:"dsa",hash:"sha1",id:""},"DSA-WITH-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-WITH-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-WITH-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-WITH-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-RIPEMD160":{sign:"dsa",hash:"rmd160",id:""},ripemd160WithRSA:{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},"RSA-RIPEMD160":{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},md5WithRSAEncryption:{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"},"RSA-MD5":{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"}}},fzpQ:function(e,t,i){"use strict";var n=i("BO1k"),a=i.n(n),r=i("Zrlr"),s=i.n(r),o=i("wxAW"),h=i.n(o),l=i("zTqn"),c=i("yh7f"),d=function(){function e(t){s()(this,e),this.game=t}return h()(e,[{key:"update",value:function(){this.updateEntities(),this.updateTransitions(),this.updatePhase()}},{key:"updateEntities",value:function(){var e=this;this.game.forEachEntity(function(t){t instanceof l.a&&(e.updateCharacter(t),e.updateAnimation(t)),e.updateEntityFading(t)})}},{key:"updateCharacter",value:function(e){var t=Math.round(16/Math.round(e.moveSpeed/(1e3/60)));e.isMoving()&&!1===e.movement.inProgress&&(e.orientation===c.a.Orientations.LEFT?e.movement.start(this.game.currentTime,function(t){e.x=t,e.hasMoved()},function(){e.x=e.movement.endValue,e.hasMoved(),e.nextStep()},e.x-t,e.x-16,e.moveSpeed):e.orientation===c.a.Orientations.RIGHT?e.movement.start(this.game.currentTime,function(t){e.x=t,e.hasMoved()},function(){e.x=e.movement.endValue,e.hasMoved(),e.nextStep()},e.x+t,e.x+16,e.moveSpeed):e.orientation===c.a.Orientations.UP?e.movement.start(this.game.currentTime,function(t){e.y=t,e.hasMoved()},function(){e.y=e.movement.endValue,e.hasMoved(),e.nextStep()},e.y-t,e.y-16,e.moveSpeed):e.orientation===c.a.Orientations.DOWN&&e.movement.start(this.game.currentTime,function(t){e.y=t,e.hasMoved()},function(){e.y=e.movement.endValue,e.hasMoved(),e.nextStep()},e.y+t,e.y+16,e.moveSpeed))}},{key:"updateAnimation",value:function(e){var t=e.currentAnimation;t&&t.update(this.game.currentTime)&&t.currentFrame&&((e.flipSpriteX&&e.mesh.material.map.repeat.x>0||!e.flipSpriteX&&e.mesh.material.map.repeat.x<0)&&(e.mesh.material.map.repeat.x=-e.mesh.material.map.repeat.x),e.mesh.material.map.repeat.x>0?e.mesh.material.map.offset.set(t.currentFrame.x/e.sprite.width,-(e.sprite.height-t.currentFrame.y-t.height)/e.sprite.height):e.mesh.material.map.offset.set(-(e.sprite.width-t.currentFrame.x-t.width)/e.sprite.width,-(e.sprite.height-t.currentFrame.y-t.height)/e.sprite.height))}},{key:"updateTransitions",value:function(){var e=this,t=this.game.map.offset.x+this.game.map.tilesize/2,i=this.game.map.offset.y+this.game.map.tilesize/2;this.game.forEachEntity(function(n){var r=n.movement;if(r&&r.inProgress&&r.step(e.game.currentTime),n.mesh&&n.mesh.position.set(t+n.x+n.offset.x,0+n.offset.y,i+n.y+n.offset.z),n.shatters){var s=!0,o=!1,h=void 0;try{for(var l,c=a()(n.shatters);!(s=(l=c.next()).done);s=!0){var d=l.value;d._pos_init||(d.position.x+=n.mesh.position.x,d.position.z+=n.mesh.position.z,d._pos_init=!0,d.shatterTick=100*Math.random());--d.shatterTick,d.shatterTick<0&&(Math.abs(n.mesh.position.x-d.position.x)<1?d.position.x=n.mesh.position.x:d.position.x+=1/(n.mesh.position.x-d.position.x),Math.abs(n.mesh.position.y-d.position.y)<3?d.position.y=n.mesh.position.y:d.position.y+=3/(n.mesh.position.y-d.position.y),Math.abs(n.mesh.position.z-d.position.z)<1?d.position.z=n.mesh.position.z:d.position.z+=1/(n.mesh.position.z-d.position.z))}}catch(e){o=!0,h=e}finally{try{!s&&c.return&&c.return()}finally{if(o)throw h}}}}),this.game.mesh__&&(this.game.mesh__.position.copy(this.game.player.mesh.position),this.game.mesh__.position.y=11)}},{key:"updateEntityFading",value:function(e){if(e&&e.isFading){var t=this.game.currentTime-e.startFadingTime;t>1e3?(e.isFading=!1,e.mesh&&(e.mesh.material.opacity=1)):e.mesh&&(e.mesh.material.opacity=t/1e3)}}},{key:"updatePhase",value:function(){this.game.nextPhase&&(this.game.phase?(this.game.phase.end(),this.game.phase=null):(this.game.phase=this.game.nextPhase,this.game.nextPhase=null,this.game.phase.begin())),this.game.phase&&this.game.phase.update()}}]),e}();t.a=d},hemJ:function(e,t){e.exports={id:"goldensword",width:48,height:48,animations:{atk_right:{length:5,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:5,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:5,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offset_x:-16,offset_y:-20}},ijQv:function(e,t){e.exports={id:"arrow",width:14,height:14,animations:{idle_down:{length:1,row:0}}}},j8az:function(e,t){e.exports={id:"talk",width:14,height:14,animations:{idle_down:{length:1,row:0}}}},jQdr:function(e,t){var i=/firefox/i.test(navigator.userAgent);e.exports.isFirefox=i},jgxY:function(e,t){e.exports={id:"skeleton2",width:48,height:48,animations:{atk_right:{length:3,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:3,row:6},walk_down:{length:4,row:7},idle_down:{length:3,row:8}},offset_x:-16,offset_y:-20}},lUAm:function(e,t){e.exports={id:"desertnpc",width:24,height:24,animations:{idle_down:{length:2,row:0}},offset_x:-4,offset_y:-8}},lgfl:function(e,t){e.exports={id:"octocat",width:32,height:32,animations:{idle_down:{length:4,row:0}},offset_x:-8,offset_y:-12}},m3jU:function(e,t,i){"use strict";var n=i("Zrlr"),a=i.n(n),r=i("wxAW"),s=i.n(r),o=function(){function e(t,i){a()(this,e),this.id=t,this.kind=i,this.isLoaded=!1}return s()(e,[{key:"setPosition",value:function(e,t){this.x=e,this.y=t}},{key:"setGridPosition",value:function(t,i){this.gridX=t,this.gridY=i,this.setPosition(t*e.gridSize,i*e.gridSize)}},{key:"fadeIn",value:function(e){this.isFading=!0,this.startFadingTime=e}}],[{key:"setGridSize",value:function(t){e.gridSize=t}}]),e}();t.a=o},mJyv:function(e,t){e.exports={id:"hand",width:14,height:14,animations:{idle_down:{length:1,row:0}}}},me95:function(e,t){e.exports={id:"shadow16",width:16,height:16}},"n+Rf":function(e,t){e.exports={id:"item-platearmor",width:16,height:16,animations:{idle:{length:6,row:0}},offset_x:0,offset_y:0}},ni5p:function(e,t){e.exports={id:"priest",width:24,height:24,animations:{idle_down:{length:2,row:0}},offset_x:-4,offset_y:-8}},oxPP:function(e,t){e.exports={id:"bat",width:32,height:48,animations:{atk_right:{length:5,row:0},walk_right:{length:5,row:1},idle_right:{length:5,row:2},atk_up:{length:5,row:3},walk_up:{length:5,row:4},idle_up:{length:5,row:5},atk_down:{length:5,row:6},walk_down:{length:5,row:7},idle_down:{length:5,row:8}},offset_x:-8,offset_y:-24}},q9QV:function(e,t){e.exports={id:"axe",width:48,height:48,animations:{atk_right:{length:5,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:5,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:5,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offset_x:-16,offset_y:-20}},t0mp:function(e,t){e.exports={id:"scientist",width:24,height:24,animations:{idle_down:{length:2,row:0}},offset_x:-4,offset_y:-8}},t9nu:function(e,t){e.exports={id:"impact",width:16,height:16,animations:{idle:{length:1,row:0}},offset_x:0,offset_y:0}},tTs3:function(e,t,i){"use strict";var n=i("OvRC"),a=i.n(n),r=i("XDXK"),s=function(e,t,i,n,a,s,o){this.textAlign="left",this.textBaseline="alphabetic",this.text=void 0!==t?t:"",this.size=void 0!==i?i:12,this.font=void 0!==n?n:"Arial",this.color=void 0!==a?a:"#000000",this.lineHeight=1;s=void 0!==s?s:0,o=void 0!==o?o:0;r.a.bind(this)(e,s,o)};(s.prototype=a()(r.a.prototype)).draw=function(e,t,i){e.font=this.size+"px "+this.font,e.fillStyle=this.color,e.textAlign=this.textAlign,e.textBaseline=this.textBaseline;var n=this.text.split("\n"),a=0;"center"===this.textVerticalAlign?a=n.length/2-.5:"bottom"===this.textVerticalAlign&&(a=n.length-1);for(var r=0;r<n.length;r++){var s=n[r],o=i+(r-a)*(this.size*this.lineHeight);e.fillText(s,t,o)}},t.a=s},taTb:function(e,t){e.exports={id:"boss",width:64,height:72,animations:{atk_right:{length:6,row:0},walk_right:{length:3,row:1},idle_right:{length:4,row:2},atk_up:{length:5,row:3},walk_up:{length:4,row:4},idle_up:{length:4,row:5},atk_down:{length:6,row:6},walk_down:{length:4,row:7},idle_down:{length:4,row:8},"Group 5":{length:3,row:9}},offset_x:-24,offset_y:-36}},uL5Q:function(e,t,i){"use strict";t.a={center:1,left:2,right:3,top:4,bottom:5}},ujQs:function(e,t){e.exports={id:"firefox",width:32,height:32,animations:{atk_right:{length:5,row:0},walk_right:{length:4,row:1},idle_right:{length:5,row:2},atk_up:{length:5,row:3},walk_up:{length:8,row:4},idle_up:{length:2,row:5},atk_down:{length:5,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offset_x:-8,offset_y:-12}},vm1t:function(e,t){e.exports={id:"sword1",width:32,height:32,animations:{atk_right:{length:5,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:5,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:5,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offset_x:-8,offset_y:-12}},wV90:function(e,t,i){"use strict";new Int32Array(4096)},wVoP:function(e,t,i){"use strict";var n=i("Zrlr"),a=i.n(n),r=i("wxAW"),s=i.n(r),o=function(){function e(t,i,n,r,s){a()(this,e),this.name=t,this.length=i,this.row=n,this.width=r,this.height=s,this.reset()}return s()(e,[{key:"tick",value:function(){var e=this.currentFrame.index;if(e=e<this.length-1?e+1:0,this.count>0&&0===e&&(this.count-=1,0===this.count))return this.currentFrame.index=0,void this.endcount_callback();this.currentFrame.x=this.width*e,this.currentFrame.y=this.height*this.row,this.currentFrame.index=e}},{key:"setSpeed",value:function(e){this.speed=e}},{key:"setCount",value:function(e,t){this.count=e,this.endcount_callback=t}},{key:"isTimeToAnimate",value:function(e){return e-this.lastTime>this.speed}},{key:"update",value:function(e){return 0===this.lastTime&&"atk"===this.name.substr(0,3)&&(this.lastTime=e),!!this.isTimeToAnimate(e)&&(this.lastTime=e,this.tick(),!0)}},{key:"reset",value:function(){this.lastTime=0,this.currentFrame={index:0,x:0,y:this.row*this.height}}}]),e}();t.a=o},wine:function(e,t){e.exports={id:"sword",width:14,height:14,animations:{idle_down:{length:1,row:0}}}},wzZJ:function(e,t){e.exports={id:"item-burger",width:16,height:16,animations:{idle:{length:6,row:0}},offset_x:0,offset_y:0}},ySG5:function(e,t){e.exports={id:"loot",width:14,height:14,animations:{idle_down:{length:1,row:0}}}},yWNk:function(e,t){e.exports={id:"bluesword",width:48,height:48,animations:{atk_right:{length:5,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:5,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:5,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offset_x:-16,offset_y:-20}},yh7f:function(e,t,i){"use strict";t.a={Orientations:{UP:1,DOWN:2,LEFT:3,RIGHT:4},Entities:{PLAYER:1,FIRE:2,CHEST:3,DEATHKNIGHT:4},BattleState:{BEGIN:1,MAIN:2,END:3}}},zRJz:function(e,t){e.exports={id:"rat",width:48,height:48,animations:{death:{length:4,row:0},atk_right:{length:6,row:1},walk_right:{length:3,row:2},idle_right:{length:2,row:3},atk_up:{length:4,row:4},walk_up:{length:4,row:5},idle_up:{length:4,row:6},atk_down:{length:4,row:7},walk_down:{length:4,row:8},idle_down:{length:4,row:9}}}},zTqn:function(e,t,i){"use strict";(function(e,n){var a=i("Zx67"),r=i.n(a),s=i("Zrlr"),o=i.n(s),h=i("wxAW"),l=i.n(h),c=i("zwoO"),d=i.n(c),f=i("Pf15"),u=i.n(f),p=(i("wV90"),i("m3jU")),g=i("TAbc"),m=i("yh7f"),w=i("wVoP"),v=function(t){function i(e,t){o()(this,i);var n=d()(this,(i.__proto__||r()(i)).call(this,e,t));return n.nextGridX=-1,n.nextGridY=-1,n.orientation=m.a.Orientations.DOWN,n.movement=new g.a,n.path=null,n.newDestination=null,n.adjacentTiles={},n.animations={},n.currentAnimation=null,n.flipSpriteX=!1,n.flipSpriteY=!1,n.moveSpeed=120,n.walkSpeed=100,n.idleSpeed=450,n}return u()(i,t),l()(i,[{key:"setSprite",value:function(e){for(var t in this.sprite=e,e.data.animations){var i=e.data.animations[t];this.animations[t]=new w.a(t,i.length,i.row,e.data.width,e.data.height)}}},{key:"getAnimationByName",value:function(e){if(e in this.animations)return this.animations[e]}},{key:"setAnimation",value:function(e,t,i,n){if(!this.currentAnimation||this.currentAnimation.name!==e){var a=this.getAnimationByName(e);a&&(this.currentAnimation=a,"atk"===e.substr(0,3)&&this.currentAnimation.reset(),this.currentAnimation.setSpeed(t),this.currentAnimation.setCount(i||0,n||function(){this.idle()}))}}},{key:"animate",value:function(t,i,n,a){var r=this.orientation;this.currentAnimation&&"death"===this.currentAnimation.name||(this.flipSpriteX=!1,this.flipSpriteY=!1,e.indexOf(["atk","walk","idle"],t)>=0&&(t+="_"+(r===m.a.Orientations.LEFT?"right":function(e){switch(e){case m.a.Orientations.LEFT:return"left";case m.a.Orientations.RIGHT:return"right";case m.a.Orientations.UP:return"up";case m.a.Orientations.DOWN:return"down"}}(r)),this.flipSpriteX=this.orientation===m.a.Orientations.LEFT),this.setAnimation(t,i,n,a))}},{key:"buildMesh",value:function(){if(this.sprite){var e=new n.PlaneGeometry(32,32);e.computeFaceNormals(),e.computeBoundingBox();var t=new n.Texture;t.image=this.sprite.image,t.format=n.RGBAFormat,t.needsUpdate=!0,t.wrapS=t.wrapT=n.RepeatWrapping;var i=this.sprite.width/this.sprite.data.width,a=this.sprite.height/this.sprite.data.height;t.repeat.set(1/i,-1/a),t.magFilter=n.NearestFilter,t.minFilter=n.NearestFilter;var r=new n.MeshStandardMaterial({map:t,transparent:!0}),s=new n.Mesh(e,r),o=new n.SphereGeometry(this.sprite.data.width/5,32,32),h=new n.MeshBasicMaterial({transparent:!0,opacity:0}),l=new n.Mesh(o,h);l.scale.set(1,2,1),l.castShadow=!0,s.add(l),this.mesh=s,this.offset={x:0,y:-this.sprite.data.offset_y||0,z:0}}}},{key:"requestPathfindingTo",value:function(e,t){return this.request_path_callback?this.request_path_callback(e,t):[]}},{key:"onRequestPath",value:function(e){this.request_path_callback=e}},{key:"onStartPathing",value:function(e){this.start_pathing_callback=e}},{key:"onStopPathing",value:function(e){this.stop_pathing_callback=e}},{key:"onBeforeStep",value:function(e){this.before_step_callback=e}},{key:"onStep",value:function(e){this.step_callback=e}},{key:"isMoving",value:function(){return!(null===this.path)}},{key:"hasMoved",value:function(){this.hasmoved_callback&&this.hasmoved_callback(this)}},{key:"hasNextStep",value:function(){return this.path.length-1>this.step}},{key:"hasChangedItsPath",value:function(){return!(null===this.newDestination)}},{key:"setOrientation",value:function(e){e&&(this.orientation=e)}},{key:"idle",value:function(e){this.setOrientation(e),this.animate("idle",this.idleSpeed)}},{key:"walk",value:function(e){this.setOrientation(e),this.animate("walk",this.walkSpeed)}},{key:"go",value:function(e,t){this.followingMode&&(this.followingMode=!1,this.target=null),this.moveTo(e,t)}},{key:"follow",value:function(e){e&&(this.followingMode=!0,this.moveTo(e.gridX,e.gridY))}},{key:"moveTo",value:function(e,t){if(this.destination={gridX:e,gridY:t},this.isMoving())this.continueTo(e,t);else{var i=this.requestPathfindingTo(e,t);this.followPath(i)}}},{key:"stop",value:function(){this.isMoving()&&(this.interrupted=!0)}},{key:"continueTo",value:function(e,t){this.newDestination={x:e,y:t}}},{key:"updateMovement",value:function(){var e=this.path,t=this.step;e[t][0]<e[t-1][0]&&this.walk(m.a.Orientations.LEFT),e[t][0]>e[t-1][0]&&this.walk(m.a.Orientations.RIGHT),e[t][1]<e[t-1][1]&&this.walk(m.a.Orientations.UP),e[t][1]>e[t-1][1]&&this.walk(m.a.Orientations.DOWN)}},{key:"followPath",value:function(e){e.length>1&&(this.path=e,this.step=0,this.followingMode&&e.pop(),this.start_pathing_callback&&this.start_pathing_callback(e),this.nextStep())}},{key:"nextStep",value:function(){var e=!1;if(this.isMoving()){if(this.before_step_callback&&this.before_step_callback(),this.updatePositionOnGrid(),this.interrupted)e=!0,this.interrupted=!1;else if(this.hasNextStep()&&(this.nextGridX=this.path[this.step+1][0],this.nextGridY=this.path[this.step+1][1]),this.step_callback&&this.step_callback(),this.hasChangedItsPath()){var t=this.newDestination.x,i=this.newDestination.y,n=this.requestPathfindingTo(t,i);this.newDestination=null,n.length<2?e=!0:this.followPath(n)}else this.hasNextStep()?(this.step+=1,this.updateMovement()):e=!0;e&&(this.path=null,this.idle(),this.stop_pathing_callback&&this.stop_pathing_callback(this.gridX,this.gridY))}}},{key:"updatePositionOnGrid",value:function(){this.setGridPosition(this.path[this.step][0],this.path[this.step][1])}},{key:"setTarget",value:function(e){this.target!==e&&(this.target=e)}}]),i}(p.a);t.a=v}).call(t,i("rdLu"),i("Ml+6"))}},["NHnr"]);
//# sourceMappingURL=app.34f05fa1a47f6d07ad98.js.map