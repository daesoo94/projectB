{"version":3,"sources":["webpack:///./src/assets/item-sword1.json","webpack:///./src/assets/agent.json","webpack:///./src/assets/king.json","webpack:///./src/lib/three-ui/Rectangle.js","webpack:///./src/assets/guard.json","webpack:///./src/assets/item-goldensword.json","webpack:///./src/assets/snake.json","webpack:///./src/assets/item-leatherarmor.json","webpack:///./src/assets/mailarmor.json","webpack:///./src/assets ^\\.\\/.*\\.json$","webpack:///./src/js/player.js","webpack:///./src/assets/skeleton.json","webpack:///./src/assets/sparks.json","webpack:///./src/assets/morningstar.json","webpack:///./src/assets/item-morningstar.json","webpack:///./src/assets/nyan.json","webpack:///./src/assets/rick.json","webpack:///./node_modules/diffie-hellman/lib/primes.json","webpack:///./node_modules/browserify-aes/modes/list.json","webpack:///./src/assets/beachnpc.json","webpack:///./src/assets/item-sword2.json","webpack:///./src/assets/ogre.json","webpack:///./node_modules/parse-asn1/aesid.json","webpack:///./src/assets/sorcerer.json","webpack:///./src/js/sprites.js","webpack:///./src/assets/item-firepotion.json","webpack:///./src/assets/item-redarmor.json","webpack:///./src/assets/clotharmor.json","webpack:///./src/lib/three-ui/ThreeUI.js","webpack:///./src/assets/item-cake.json","webpack:///./src/assets/item-mailarmor.json","webpack:///./src/assets/goblin.json","webpack:///./src/js/prop.js","webpack:///./src/assets/test2.json","webpack:///./src/lib/astar.js","webpack:///./src/js/pathfinder.js","webpack:///./src/assets/sword2.json","webpack:///./src/assets/item-axe.json","webpack:///./src/assets/redsword.json","webpack:///./src/assets/test4.json","webpack:///./src/js/map.js","webpack:///./src/assets/leatherarmor.json","webpack:///./src/assets/villagegirl.json","webpack:///./src/js/gameworld.js","webpack:///./node_modules/elliptic/package.json","webpack:///./src/assets/platearmor.json","webpack:///./src/assets/item-clotharmor.json","webpack:///./src/assets/wizard.json","webpack:///./src/js/gltfloader.js","webpack:///./src/main.js","webpack:///./src/assets/spectre.json","webpack:///./src/js/movieclip.js","webpack:///./src/assets/deathknight.json","webpack:///./src/assets/eye.json","webpack:///./node_modules/browserify-sign/browser/curves.json","webpack:///./src/assets/target.json","webpack:///./src/assets/redarmor.json","webpack:///./src/assets/item-redsword.json","webpack:///./src/assets/item-flask.json","webpack:///./src/lib/three-ui/BitmapText.js","webpack:///./src/assets/item-goldenarmor.json","webpack:///./src/assets/death.json","webpack:///./src/js/transition.js","webpack:///./src/assets/lavanpc.json","webpack:///./src/assets/goldenarmor.json","webpack:///./src/assets/crab.json","webpack:///./src/js/entityfactory.js","webpack:///./src/lib/three-ui/DisplayObject.js","webpack:///./src/js/phase.js","webpack:///./src/js/battle2.js","webpack:///./src/js/cutscene.js","webpack:///./src/assets/item-bluesword.json","webpack:///./src/js/chest.js","webpack:///./src/assets/forestnpc.json","webpack:///./src/lib/three-ui/Sprite.js","webpack:///./src/js/game.js","webpack:///./src/assets/chest.json","webpack:///./src/js/app.js","webpack:///./src/assets/villager.json","webpack:///./src/assets/coder.json","webpack:///./node_modules/browserify-sign/browser/algorithms.json","webpack:///./src/assets/test1.json","webpack:///./src/js/updater.js","webpack:///./src/assets/goldensword.json","webpack:///./src/assets/arrow.json","webpack:///./src/assets/talk.json","webpack:///./src/lib/three-ui/utils/browserDetection.js","webpack:///./src/assets/skeleton2.json","webpack:///./src/assets/desertnpc.json","webpack:///./src/assets/octocat.json","webpack:///./src/js/entity.js","webpack:///./src/assets/hand.json","webpack:///./src/assets/shadow16.json","webpack:///./src/assets/item-platearmor.json","webpack:///./src/assets/priest.json","webpack:///./src/assets/bat.json","webpack:///./src/assets/axe.json","webpack:///./src/lib/bokehshader2.js","webpack:///./src/assets/test3.json","webpack:///./src/assets/scientist.json","webpack:///./src/assets/impact.json","webpack:///./src/lib/three-ui/Text.js","webpack:///./src/assets/boss.json","webpack:///./src/lib/three-ui/anchors.js","webpack:///./src/assets/firefox.json","webpack:///./src/assets/sword1.json","webpack:///./src/lib/voxel.js","webpack:///./src/js/animation.js","webpack:///./src/assets/sword.json","webpack:///./src/assets/item-burger.json","webpack:///./src/assets/loot.json","webpack:///./src/assets/bluesword.json","webpack:///./src/share/gametypes.js","webpack:///./src/assets/rat.json","webpack:///./src/js/character.js"],"names":["module","exports","id","width","height","animations","idle","length","row","offset_x","offset_y","idle_down","Rectangle","ui","color","x","y","this","DisplayObject","bind","prototype","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_create___default","draw","context","fillStyle","fillRect","atk_right","walk_right","idle_right","atk_up","walk_up","idle_up","atk_down","walk_down","map","./agent.json","./arrow.json","./axe.json","./bat.json","./beachnpc.json","./bluesword.json","./boss.json","./chest.json","./clotharmor.json","./coder.json","./crab.json","./death.json","./deathknight.json","./desertnpc.json","./eye.json","./firefox.json","./forestnpc.json","./goblin.json","./goldenarmor.json","./goldensword.json","./guard.json","./hand.json","./impact.json","./item-axe.json","./item-bluesword.json","./item-burger.json","./item-cake.json","./item-clotharmor.json","./item-firepotion.json","./item-flask.json","./item-goldenarmor.json","./item-goldensword.json","./item-leatherarmor.json","./item-mailarmor.json","./item-morningstar.json","./item-platearmor.json","./item-redarmor.json","./item-redsword.json","./item-sword1.json","./item-sword2.json","./king.json","./lavanpc.json","./leatherarmor.json","./loot.json","./mailarmor.json","./morningstar.json","./nyan.json","./octocat.json","./ogre.json","./platearmor.json","./priest.json","./rat.json","./redarmor.json","./redsword.json","./rick.json","./scientist.json","./shadow16.json","./skeleton.json","./skeleton2.json","./snake.json","./sorcerer.json","./sparks.json","./spectre.json","./sword.json","./sword1.json","./sword2.json","./talk.json","./target.json","./test1.json","./test2.json","./test3.json","./test4.json","./villagegirl.json","./villager.json","./wizard.json","webpackContext","req","__webpack_require__","webpackContextResolve","Error","keys","Object","resolve","Player","name","kind","__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_classCallCheck___default","_this","__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_possibleConstructorReturn___default","__proto__","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_get_prototype_of___default","call","Character","modp1","gen","prime","modp2","modp5","modp14","modp15","modp16","modp17","modp18","aes-128-ecb","cipher","key","iv","mode","type","aes-192-ecb","aes-256-ecb","aes-128-cbc","aes-192-cbc","aes-256-cbc","aes128","aes192","aes256","aes-128-cfb","aes-192-cfb","aes-256-cfb","aes-128-cfb8","aes-192-cfb8","aes-256-cfb8","aes-128-cfb1","aes-192-cfb1","aes-256-cfb1","aes-128-ofb","aes-192-ofb","aes-256-ofb","aes-128-ctr","aes-192-ctr","aes-256-ctr","aes-128-gcm","aes-192-gcm","aes-256-gcm","2.16.840.1.101.3.4.1.1","2.16.840.1.101.3.4.1.2","2.16.840.1.101.3.4.1.3","2.16.840.1.101.3.4.1.4","2.16.840.1.101.3.4.1.21","2.16.840.1.101.3.4.1.22","2.16.840.1.101.3.4.1.23","2.16.840.1.101.3.4.1.24","2.16.840.1.101.3.4.1.41","2.16.840.1.101.3.4.1.42","2.16.840.1.101.3.4.1.43","2.16.840.1.101.3.4.1.44","sprites","_step","_iterator","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_get_iterator___default","_iteratorNormalCompletion","next","done","value","data","require","push","dirtyProperties","observeDirtyProperties","object","forEach","prop","proxyKey","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default","set","shouldReDraw","get","ThreeUI","gameCanvas","renderOnQuad","displayObjects","eventListeners","click","clearRect","canvas","document","getElementById","getContext","prepareThreeJSScene","resize","anchors","addCanvasToDom","parentNode","appendChild","camera","THREE","OrthographicCamera","scene","Scene","texture","Texture","material","MeshBasicMaterial","transparent","planeGeo","PlaneGeometry","plane","Mesh","matrixAutoUpdate","add","i","render","needsUpdate","renderer","colorReplace","save","globalCompositeOperation","restore","createSprite","imagePath","displayObject","Sprite","createSpriteFromSheet","sheetImagePath","sheetDataPath","createRectangle","createText","text","font","Text","createBitmapText","size","BitmapText","addEventListener","callback","clickHandler","coords","callbackQueue","listener","shouldReceiveEvents","bounds","getBounds","isInBoundingBox","result","windowToUISpace","getBoundingClientRect","scale","left","top","moveToFront","elIdx","indexOf","splice","boundX","boundY","boundWidth","boundHeight","Prop","__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_possibleConstructorReturn___default","load","geometry","BoxBufferGeometry","MeshLambertMaterial","mesh","computeBoundingBox","offset","boundingBox","min","z","isLoaded","intensity","radius","light","PointLight","position","castShadow","Entity","diagonalSuccessors","$N","$S","$E","$W","N","S","E","W","grid","rows","cols","diagonalSuccessorsFree","nothingToDo","successors","find","diagonal","start","end","f1","f2","euclidean","manhattan","AStar","f","adj","distance","j","max","current","limit","Math","abs","list","open","g","v","sqrt","p","reverse","Pathfinder","classCallCheck_default","ignored","initBlankGrid","blankGrid","entity","findIncomplete","gridX","gridY","path","findIncompletePath_","perfect","incomplete","applyIgnoreList_","attack_ready","attack","isInt","n","Map","game","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_classCallCheck___default","loadMap","$","_initMap","_generateCollisionGrid","GLTFLoader","model","tilesize","collisions","props","_this2","_","each","tileIndex","pos","tileIndexToGridPosition","isOutOfBounds","tileNum","floor","GameWorld","PlaneBufferGeometry","MeshStandardMaterial","opacity","rotation","order","PI","terrain","children","receiveShadow","_from","_id","_inBundle","_integrity","_location","_phantomChildren","_requested","registry","raw","escapedName","rawSpec","saveSpec","fetchSpec","_requiredBy","_resolved","_shasum","_spec","_where","author","email","bugs","url","bundleDependencies","dependencies","bn.js","brorand","hash.js","hmac-drbg","inherits","minimalistic-assert","minimalistic-crypto-utils","deprecated","description","devDependencies","brfs","coveralls","grunt","grunt-browserify","grunt-cli","grunt-contrib-connect","grunt-contrib-copy","grunt-contrib-uglify","grunt-mocha-istanbul","grunt-saucelabs","istanbul","jscs","jshint","mocha","files","homepage","keywords","license","main","repository","scripts","lint","test","unit","version","death","manager","__WEBPACK_IMPORTED_MODULE_4_babel_runtime_helpers_classCallCheck___default","undefined","DefaultLoadingManager","dracoLoader","crossOrigin","onLoad","onProgress","onError","resourcePath","scope","LoaderUtils","extractUrlBase","itemStart","_onError","e","console","error","itemError","itemEnd","loader","FileLoader","setPath","setResponseType","parse","gltf","content","extensions","decodeText","Uint8Array","BINARY_EXTENSION_HEADER_MAGIC","EXTENSIONS","KHR_BINARY_GLTF","body","headerView","DataView","BINARY_EXTENSION_HEADER_LENGTH","header","magic","slice","getUint32","chunkView","chunkIndex","byteLength","chunkLength","chunkType","BINARY_EXTENSION_CHUNK_TYPES","JSON","contentArray","BIN","byteOffset","json","asset","extensionsUsed","extensionName","extensionsRequired","KHR_LIGHTS_PUNCTUAL","GLTFLightsExtension","KHR_MATERIALS_UNLIT","GLTFMaterialsUnlitExtension","KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS","GLTFMaterialsPbrSpecularGlossinessExtension","KHR_DRACO_MESH_COMPRESSION","GLTFDracoMeshCompressionExtension","MSFT_TEXTURE_DDS","GLTFTextureDDSExtension","KHR_TEXTURE_TRANSFORM","GLTFTextureTransformExtension","warn","parser","GLTFParser","scenes","cameras","glTF","userData","addUnknownExtensionsToUserData","GLTFRegistry","objects","DDSLoader","ddsLoader","extension","lightDefs","lights","loadLight","lightIndex","lightNode","lightDef","Color","fromArray","range","DirectionalLight","target","SpotLight","spot","innerConeAngle","outerConeAngle","angle","penumbra","decay","__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default","a","getMaterialType","extendParams","materialParams","pending","metallicRoughness","pbrMetallicRoughness","Array","isArray","baseColorFactor","array","baseColorTexture","assignTexture","all","DRACOLoader","getDecoderModule","specularGlossinessParams","ShaderMaterial","params","pbrSpecularGlossiness","shader","ShaderLib","uniforms","UniformsUtils","clone","specularMapParsFragmentChunk","join","glossinessMapParsFragmentChunk","specularMapFragmentChunk","glossinessMapFragmentChunk","lightPhysicalFragmentChunk","fragmentShader","replace","roughness","metalness","roughnessMap","metalnessMap","specular","setHex","glossiness","specularMap","glossinessMap","vertexShader","defines","STANDARD","diffuseFactor","diffuseTexture","emissive","glossinessFactor","specularFactor","specularGlossinessTexture","specGlossMapDef","createMaterial","fog","isGLTFSpecularGlossinessMaterial","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalScale","displacementMap","displacementScale","displacementBias","alphaMap","envMap","envMapIntensity","refractionRatio","derivatives","cloneMaterial","source","il","refreshUniforms","group","uvScaleMap","diffuse","copy","multiplyScalar","isWebGLRenderTarget","updateMatrix","uvTransform","matrix","flipEnvMap","isCubeTexture","reflectivity","maxMipLevel","properties","__maxMipLevel","USE_GLOSSINESSMAP","USE_ROUGHNESSMAP","GLTFCubicSplineInterpolant","parameterPositions","sampleValues","sampleSize","resultBuffer","Interpolant","decodePrimitive","primitive","bufferViewIndex","bufferView","gltfAttributeMap","attributes","threeAttributeMap","attributeNormalizedMap","attributeTypeMap","attributeName","ATTRIBUTES","accessorDef","accessors","componentType","WEBGL_COMPONENT_TYPES","normalized","getDependency","then","decodeDracoFile","attribute","extendTexture","transform","repeat","texCoord","__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default","constructor","copySampleValue_","index","values","valueSize","beforeStart_","afterEnd_","interpolate_","i1","t0","t","t1","stride","stride2","stride3","td","pp","ppp","offset1","offset0","s2","s3","s0","s1","p0","m0","p1","m1","WEBGL_CONSTANTS","Number","Matrix3","Matrix4","Vector2","Vector3","Vector4","5120","Int8Array","5121","5122","Int16Array","5123","Uint16Array","5125","Uint32Array","5126","Float32Array","WEBGL_FILTERS","9728","NearestFilter","9729","LinearFilter","9984","NearestMipMapNearestFilter","9985","LinearMipMapNearestFilter","9986","NearestMipMapLinearFilter","9987","LinearMipMapLinearFilter","WEBGL_WRAPPINGS","33071","ClampToEdgeWrapping","33648","MirroredRepeatWrapping","10497","RepeatWrapping","WEBGL_TYPE_SIZES","BackSide","FrontSide","NeverDepth","LessDepth","EqualDepth","LessEqualDepth","GreaterEqualDepth","NotEqualDepth","AlwaysDepth","AddEquation","SubtractEquation","ReverseSubtractEquation","ZeroFactor","OneFactor","SrcColorFactor","OneMinusSrcColorFactor","SrcAlphaFactor","OneMinusSrcAlphaFactor","DstAlphaFactor","OneMinusDstAlphaFactor","DstColorFactor","OneMinusDstColorFactor","SrcAlphaSaturateFactor","SCALAR","VEC2","VEC3","VEC4","MAT2","MAT3","MAT4","POSITION","NORMAL","TANGENT","TEXCOORD_0","TEXCOORD_1","COLOR_0","WEIGHTS_0","JOINTS_0","PATH_PROPERTIES","translation","weights","INTERPOLATION","CUBICSPLINE","InterpolateSmooth","LINEAR","InterpolateLinear","STEP","InterpolateDiscrete","ALPHA_MODES","MIME_TYPE_FORMATS","image/png","RGBAFormat","image/jpeg","RGBFormat","resolveURL","knownExtensions","objectDef","gltfExtensions","assignExtrasToUserData","gltfDef","extras","__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_typeof___default","updateMorphTargets","meshDef","morphTargetInfluences","targetNames","morphTargetDictionary","isObjectEqual","b","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default","createPrimitiveKey","primitiveDef","dracoExtension","indices","createAttributesKey","attributesKey","sort","cloneBufferAttribute","isInterleavedBufferAttribute","count","itemSize","getX","getY","getZ","getW","BufferAttribute","options","cache","primitiveCache","multiplePrimitivesCache","multiPassGeometryCache","textureLoader","TextureLoader","setCrossOrigin","fileLoader","addPrimitiveAttributes","assignAttributeAccessor","accessorIndex","accessor","addAttribute","gltfAttributeName","threeAttributeName","setIndex","targets","hasMorphPosition","hasMorphNormal","pendingPositionAccessors","pendingNormalAccessors","normal","morphPositions","morphNormals","positionAttribute","jl","setXYZ","normalAttribute","morphAttributes","addMorphTargets","removeAll","markDefs","getMultiDependencies","catch","nodeDefs","nodes","skinDefs","skins","meshDefs","meshes","meshReferences","meshUses","skinIndex","skinLength","joints","isBone","nodeIndex","nodeLength","nodeDef","skin","isSkinnedMesh","cacheKey","dependency","loadScene","loadNode","loadMesh","loadAccessor","loadBufferView","loadBuffer","loadMaterial","loadTexture","loadSkin","loadAnimation","loadCamera","getDependencies","defs","def","types","results","bufferIndex","bufferDef","buffers","uri","reject","bufferViewDef","bufferViews","buffer","sparse","pendingBufferViews","bufferAttribute","TypedArray","elementBytes","BYTES_PER_ELEMENT","itemBytes","byteStride","ibCacheKey","ib","InterleavedBuffer","InterleavedBufferAttribute","itemSizeIndices","TypedArrayIndices","byteOffsetIndices","byteOffsetValues","sparseIndices","sparseValues","setArray","setX","setY","setZ","setW","textureIndex","URL","window","webkitURL","textureDef","textures","textureExtensions","sourceURI","images","isObjectURL","blob","Blob","mimeType","createObjectURL","Loader","Handlers","revokeObjectURL","flipY","format","sampler","samplers","magFilter","minFilter","wrapS","wrapT","mapName","mapDef","materialIndex","materialType","materialDef","materials","materialExtensions","sgExtension","kmuExtension","metallicFactor","roughnessFactor","metallicRoughnessTexture","doubleSided","side","DoubleSide","alphaMode","alphaTest","alphaCutoff","normalTexture","occlusionTexture","strength","emissiveFactor","emissiveTexture","encoding","sRGBEncoding","loadGeometries","primitives","originalPrimitives","isMultiPass","primitive0","targets0","isMultiPassGeometry","createDracoPrimitive","geometryPromise","cached","promise","BufferGeometry","geometries","baseGeometry","uuid","createMultiPassGeometryKey","pendingIndices","addGroup","BufferGeometryUtils","arrayKey","createArrayKeyBufferGeometry","mergeBufferGeometries","baseGeometries","meshIndex","depthTest","originalMaterials","isMultiMaterial","groups","SkinnedMesh","normalizeSkinWeights","drawMode","TriangleStripDrawMode","TriangleFanDrawMode","LineSegments","Line","LineLoop","Points","useVertexTangents","tangent","useVertexColors","useFlatShading","useSkinning","useMorphTargets","useMorphNormals","isPoints","pointsMaterial","PointsMaterial","Material","isLine","lineMaterial","LineBasicMaterial","cachedMaterial","skinning","vertexTangents","vertexColors","VertexColors","flatShading","morphTargets","uv2","uv","log","onBeforeRender","Group","cameraIndex","cameraDef","PerspectiveCamera","radToDeg","yfov","aspectRatio","znear","zfar","xmag","ymag","skinDef","skinEntry","inverseBindMatrices","animationIndex","animationDef","pendingNodes","pendingInputAccessors","pendingOutputAccessors","pendingSamplers","pendingTargets","channels","channel","node","input","parameters","output","inputAccessors","outputAccessors","tracks","inputAccessor","outputAccessor","TypedKeyframeTrack","NumberKeyframeTrack","QuaternionKeyframeTrack","VectorKeyframeTrack","targetName","interpolation","traverse","isMesh","track","AnimationUtils","arraySlice","createInterpolant","times","getValueSize","isInterpolantFactoryMethodGLTFCubicSpline","AnimationClip","Bone","instanceNum","o","Object3D","PropertyBinding","sanitizeNodeName","applyMatrix","quaternion","buildNodeHierachy","nodeId","parentObject","pendingJoints","jointNodes","isGroup","bones","boneInverses","jointNode","mat","Skeleton","matrixWorld","child","sceneDef","nodeIds","defineProperty","__webpack_exports__","app","__WEBPACK_IMPORTED_MODULE_0__js_app__","__WEBPACK_IMPORTED_MODULE_1__js_game__","App","Game","init","setGame","event","gamePos","mouse","pageX","pageY","keyDown","keyCode","EasingFunction","linear","w","outCubic","inCubic","inOutCubic","inOutSine","cos","outExponential","pow","outBounce","outBack","s","MoveClipPlayMode","Loop","Stop","Destory","MovieClip","_len","arguments","timelines","_key","_timelines","_frame","_playing","_stopHandler","_mode","lastFrame","_didIteratorError","_iteratorError","tl","endFrame","err","return","_lastFrame","startFrame","tweens","handler","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","timeline","dist","weight","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","tween","from","to","easing","image","setRotation","1.3.132.0.10","1.3.132.0.33","1.2.840.10045.3.1.1","1.2.840.10045.3.1.7","1.3.132.0.34","1.3.132.0.35","move","atk","parseSheet","setText","dimensions","calculateDimensions","pivot","toString","characters","split","sheet","sheetData","AssetLoader","getAssetById","characterData","char","round","cData","character","drawCharacter","skipDraw","drawImage","Transition","startValue","endValue","duration","inProgress","currentTime","updateFunction","stopFunction","startTime","debug","elapsed","diff","stop","step","EntityFactory","isFunction","builders","Types","Entities","DEATHKNIGHT","CHEST","Chest","FIRE","attachPointLight","alpha","visible","anchor","smoothing","stretch","right","bottom","parent","determinePositionInCanvas","determineDimensionsInCanvas","getParentBounds","adjustPositionForAnchor","adjustPositionForPivot","parentBounds","center","getOffsetInCanvas","percValue","parseFloat","match","onClick","globalAlpha","_visible","toggle","Phase","begin_callback","end_callback","click_callback","phase","update_callback","GameSprite","attackRange","moveSpeed","flipX","anims","animRow","animFrameCount","walk","currentFrame","currentFrameMax","currentRow","state","utime","Date","now","health","Maxhealth","ctx","translate","healthbarSize","hit","setAnim","Cutscene","Battle","possibleConstructorReturn_default","get_prototype_of_default","player","enemy","onUpdate","update","textAlign","fillText","onBegin","skipFrame","isFading","spriteMesh","fadeIn","assetPath","setAssetPath","sheetImageData","__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_typeof___default","frame","WebGLRenderer","shadowMap","enabled","setPixelRatio","devicePixelRatio","setSize","autoClear","entities","entityGrid","nextPhase","initPostprocessing","postprocessing","depthShader","BokehDepthShader","materialDepth","near","far","shaderSettings","pars","rtTextureDepth","WebGLRenderTarget","rtTextureColor","bokeh_shader","BokehShader","bokeh_uniforms","materialBokeh","RINGS","SAMPLES","quad","lookTarget","reltiveOffset","battlemode","forEachEntity","divideScalar","battle_asset","zoom_effect","sub","scalar","normalize","lookAt","getTime","updater","movie","updateCamera","targetDistance","distanceTo","ldepth","clear","setRenderTarget","overrideMaterial","isStopped","requestAnimationFrame","tick","username","loadSprites","loadModel","Updater","wait","setInterval","isSpritesLoaded","clearInterval","remove","world","initEntityGrid","setGridSize","ambient","AmbientLight","propData","propEntity","createEntity","setGridPosition","addEntity","pathfinder","setSprite","buildMesh","onRequestPath","findPath","onStopPathing","chest","mixer","AnimationMixer","clips","clip","findByName","action","clipAction","setLoop","LoopOnce","clampWhenFinished","play","isRunning","unregisterEntityPosition","_loop","sprite","img","Image","src","onload","SpriteData","_this3","any","registerEntityPosition","intersect","boundingbox","ts","getSize","raycaster","Raycaster","setFromCamera","intersects","intersectObjects","inter","getGridPosition","point","getEntityAt","setTarget","follow","go","_this4","uiimg","animate","setOrientation","Orientations","LEFT","isAttacking","attackerMovie","Timeline","playAndDestroy","removeEntity","timeout","clearTimeout","isColliding","scrollTo","run","sha224WithRSAEncryption","sign","hash","RSA-SHA224","sha256WithRSAEncryption","RSA-SHA256","sha384WithRSAEncryption","RSA-SHA384","sha512WithRSAEncryption","RSA-SHA512","RSA-SHA1","ecdsa-with-SHA1","sha256","sha224","sha384","sha512","DSA-SHA","DSA-SHA1","DSA","DSA-WITH-SHA224","DSA-SHA224","DSA-WITH-SHA256","DSA-SHA256","DSA-WITH-SHA384","DSA-SHA384","DSA-WITH-SHA512","DSA-SHA512","DSA-RIPEMD160","ripemd160WithRSA","RSA-RIPEMD160","md5WithRSAEncryption","RSA-MD5","updateEntities","updateTransitions","updatePhase","updateCharacter","updateAnimation","updateEntityFading","c","isMoving","movement","orientation","hasMoved","nextStep","RIGHT","UP","DOWN","anim","currentAnimation","flipSpriteX","offsetX","offsetZ","m","shatters","block","_pos_init","shatterTick","random","d","mesh__","dt","startFadingTime","begin","isFirefox","navigator","userAgent","setPosition","gridSize","textureWidth","textureHeight","focalDepth","focalLength","fstop","tColor","tDepth","maxblur","showFocus","manualdof","vignetting","depthblur","threshold","gain","bias","fringe","noise","dithering","pentagon","shaderFocus","focusCoords","mNear","mFar","textBaseline","lineHeight","lines","midLinePoint","textVerticalAlign","idx","line","lineY","Group 5","Int32Array","Animation","reset","endcount_callback","speed","onEndCount","time","lastTime","substr","isTimeToAnimate","PLAYER","BattleState","BEGIN","MAIN","END","nextGridX","nextGridY","newDestination","adjacentTiles","flipSpriteY","walkSpeed","idleSpeed","getAnimationByName","setSpeed","setCount","animation","getOrientationAsString","setAnimation","computeFaceNormals","tex","column","request_path_callback","start_pathing_callback","stop_pathing_callback","before_step_callback","step_callback","hasmoved_callback","followingMode","moveTo","destination","continueTo","requestPathfindingTo","followPath","interrupted","pop","updatePositionOnGrid","hasNextStep","hasChangedItsPath","updateMovement"],"mappings":"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KAAM,MAERK,gBAEC,oBAEA,oBAEA,4BACA,4BACA,8BACA,+BAEA,sGACA,kDACA,sCACA,4GAEA,KACA,mGACA,KAEA,gDACA,6CAEA,+CACA,mBAEA,2DACA,wCAEA,8CAEA,oDACA,gDACA,0DACA,+CACA,yDAEA,0EAEA,0DAEA,kDACA,iDACA,uDAEA,4BACA,kDAEA,4BACA,oFACA,6CAEA,yBACA,yDAEA,mDACA,yCAEA,yCACA,iEAEA,0EAEA,2BAEA,mDACA,0CAEA,KACA,4BACA,oDACA,kDACA,KAEA,wDACA,gDAEA,+CAEA,6BACC,qBACA,oCACA,0DACA,0DACA,0DACA,0DACA,0DACA,0DAEA,2BAEA,8CAEA,yBACA,wBAEA,0BACA,0BACA,0BACA,0BAEA,gDAEA,+BAEA,0BACA,+BAEA,gDACA,qBAEA,qCACD,IAEA,8BACC,uBACA,iBACA,mBACA,kBAEA,+DAEA,iCACA,iCACA,iCAEA,iCACA,iCACA,iCAEA,iCACA,iCACA,iCAEA,wEACA,wEACA,wEAGA,6BACC,uDACA,wBACD,IAEA,YACD,IAGA,uCACC,0BAEA,wBACA,yDAEA,wEACA,4EACA,2EAEA,2CACA,sCACA,iDACA,6CACD,IAEA,uDACC,4DACA,sDACA,0DAEA,gDACA,0DAEA,cACD,IAEA,iCACC,0DACD,IAGA,qBACC,gDACA,8EACA,8BACD,IAEA,kGACC,+BACA,4CACA,4BACA,4BACA,iBACA,kBACC,0BACD,IACA,+EACA,8CACD,IAEA,gBACC,4BAEA,uDAEA,iBACA,qBACC,qCACD,IAEA,4BAEA,6BAEA,qBAEC,uDAED,IAEA,iCAEA,oBAEA,mBACC,yCACA,+CACA,iDACA,0BACD,WACC,+CACA,gDACA,yCAEA,yBACA,yBACA,iCAEA,qBACD,IAEA,8BAEA,0CAEA,sFAEA,sCAEA,qDACA,sDAEA,gCAEA,wBAEA,oBACC,6BACA,uCACD,WACC,uCACA,iBACA,mBAEA,qCACC,iBACA,6BAEA,+CACC,+BACA,iEACD,IACA,eACD,IAEA,qCACD,IAEA,mBACC,sCACD,IAEA,oBACC,qBACD,IA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","file":"static/js/app.757c79513b324af796b2.js","sourcesContent":["module.exports = {\"id\":\"item-sword1\",\"width\":16,\"height\":16,\"animations\":{\"idle\":{\"length\":6,\"row\":0}},\"offset_x\":0,\"offset_y\":0}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/item-sword1.json\n// module id = +F07\n// module chunks = 1","module.exports = {\"id\":\"agent\",\"width\":24,\"height\":24,\"animations\":{\"idle_down\":{\"length\":2,\"row\":0}},\"offset_x\":-4,\"offset_y\":-8}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/agent.json\n// module id = +rbd\n// module chunks = 1","module.exports = {\"id\":\"king\",\"width\":32,\"height\":32,\"animations\":{\"idle_down\":{\"length\":2,\"row\":0}},\"offset_x\":-8,\"offset_y\":-12}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/king.json\n// module id = /Ooo\n// module chunks = 1","import DisplayObject from './DisplayObject';\n\n/**\n * Rectangle\n * @extends ThreeUI.DisplayObject\n * \n * Used internally by ThreeUI, shouldn't be used directly\n * Use ThreeUI.createRectangle instead to create rectangles\n * \n * @param {ThreeUI} ui\n * @param {string} color \n * @param {int} x \n * @param {int} y \n * @param {int} width\n * @param {int} height\n */\n\nvar Rectangle = function(ui, color, x, y, width, height) {\n\tthis.color = color;\n\n\tvar x = typeof x !== 'undefined' ? x : 0;\n\tvar y = typeof y !== 'undefined' ? y : 0;\n\tvar width = typeof width !== 'undefined' ? width : 1;\n\tvar height = typeof height !== 'undefined' ? height : 1;\n\n\t// Run DisplayObject constructor on this object\n\tDisplayObject.bind(this)(ui, x, y, width, height);\n};\n\nRectangle.prototype = Object.create(DisplayObject.prototype);\n\n/**\n * Draw this Rectangle onto the provided context\n * Used internally by DisplayObject.render\n * \n * @param {CanvasRenderingContext2D} context\n * @param {int} x\n * @param {int} y\n * @param {int} width\n * @param {int} height\n */\n\nRectangle.prototype.draw = function(context, x, y, width, height) {\n\tcontext.fillStyle = this.color;\n\tcontext.fillRect(x, y, width, height);\n};\n\n// Export Rectangle as module\nexport default Rectangle;\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/three-ui/Rectangle.js","module.exports = {\"id\":\"guard\",\"width\":25,\"height\":24,\"animations\":{\"idle_down\":{\"length\":2,\"row\":0}},\"offset_x\":-5,\"offset_y\":-8}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/guard.json\n// module id = /sf/\n// module chunks = 1","module.exports = {\"id\":\"item-goldensword\",\"width\":16,\"height\":16,\"animations\":{\"idle\":{\"length\":6,\"row\":0}},\"offset_x\":0,\"offset_y\":0}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/item-goldensword.json\n// module id = /z/9\n// module chunks = 1","module.exports = {\"id\":\"snake\",\"width\":28,\"height\":28,\"animations\":{\"atk_right\":{\"length\":5,\"row\":0},\"walk_right\":{\"length\":4,\"row\":1},\"idle_right\":{\"length\":4,\"row\":2},\"atk_up\":{\"length\":5,\"row\":3},\"walk_up\":{\"length\":4,\"row\":4},\"idle_up\":{\"length\":4,\"row\":5},\"atk_down\":{\"length\":5,\"row\":6},\"walk_down\":{\"length\":4,\"row\":7},\"idle_down\":{\"length\":6,\"row\":8}},\"offset_x\":-6,\"offset_y\":-10}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/snake.json\n// module id = 0U4p\n// module chunks = 1","module.exports = {\"id\":\"item-leatherarmor\",\"width\":16,\"height\":16,\"animations\":{\"idle\":{\"length\":6,\"row\":0}},\"offset_x\":0,\"offset_y\":0}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/item-leatherarmor.json\n// module id = 0YEL\n// module chunks = 1","module.exports = {\"id\":\"mailarmor\",\"width\":32,\"height\":32,\"animations\":{\"atk_right\":{\"length\":5,\"row\":0},\"walk_right\":{\"length\":4,\"row\":1},\"idle_right\":{\"length\":2,\"row\":2},\"atk_up\":{\"length\":5,\"row\":3},\"walk_up\":{\"length\":4,\"row\":4},\"idle_up\":{\"length\":2,\"row\":5},\"atk_down\":{\"length\":5,\"row\":6},\"walk_down\":{\"length\":4,\"row\":7},\"idle_down\":{\"length\":2,\"row\":8}},\"offset_x\":-8,\"offset_y\":-12}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/mailarmor.json\n// module id = 0i05\n// module chunks = 1","var map = {\n\t\"./agent.json\": \"+rbd\",\n\t\"./arrow.json\": \"ijQv\",\n\t\"./axe.json\": \"q9QV\",\n\t\"./bat.json\": \"oxPP\",\n\t\"./beachnpc.json\": \"72jo\",\n\t\"./bluesword.json\": \"yWNk\",\n\t\"./boss.json\": \"taTb\",\n\t\"./chest.json\": \"cKQl\",\n\t\"./clotharmor.json\": \"AKwQ\",\n\t\"./coder.json\": \"eOxi\",\n\t\"./crab.json\": \"UcV4\",\n\t\"./death.json\": \"Sqs0\",\n\t\"./deathknight.json\": \"Oy9j\",\n\t\"./desertnpc.json\": \"lUAm\",\n\t\"./eye.json\": \"PznX\",\n\t\"./firefox.json\": \"ujQs\",\n\t\"./forestnpc.json\": \"aNYQ\",\n\t\"./goblin.json\": \"C37V\",\n\t\"./goldenarmor.json\": \"UStB\",\n\t\"./goldensword.json\": \"hemJ\",\n\t\"./guard.json\": \"/sf/\",\n\t\"./hand.json\": \"mJyv\",\n\t\"./impact.json\": \"t9nu\",\n\t\"./item-axe.json\": \"HITf\",\n\t\"./item-bluesword.json\": \"ZBgj\",\n\t\"./item-burger.json\": \"wzZJ\",\n\t\"./item-cake.json\": \"B4O8\",\n\t\"./item-clotharmor.json\": \"LsZA\",\n\t\"./item-firepotion.json\": \"9R10\",\n\t\"./item-flask.json\": \"RgGw\",\n\t\"./item-goldenarmor.json\": \"SML3\",\n\t\"./item-goldensword.json\": \"/z/9\",\n\t\"./item-leatherarmor.json\": \"0YEL\",\n\t\"./item-mailarmor.json\": \"BvGv\",\n\t\"./item-morningstar.json\": \"3SDg\",\n\t\"./item-platearmor.json\": \"n+Rf\",\n\t\"./item-redarmor.json\": \"A0vU\",\n\t\"./item-redsword.json\": \"RZ8U\",\n\t\"./item-sword1.json\": \"+F07\",\n\t\"./item-sword2.json\": \"7fe2\",\n\t\"./king.json\": \"/Ooo\",\n\t\"./lavanpc.json\": \"Tb6K\",\n\t\"./leatherarmor.json\": \"JYMs\",\n\t\"./loot.json\": \"ySG5\",\n\t\"./mailarmor.json\": \"0i05\",\n\t\"./morningstar.json\": \"34Xz\",\n\t\"./nyan.json\": \"47gg\",\n\t\"./octocat.json\": \"lgfl\",\n\t\"./ogre.json\": \"8VIR\",\n\t\"./platearmor.json\": \"L0hz\",\n\t\"./priest.json\": \"ni5p\",\n\t\"./rat.json\": \"zRJz\",\n\t\"./redarmor.json\": \"RVzG\",\n\t\"./redsword.json\": \"IJ/y\",\n\t\"./rick.json\": \"4Alr\",\n\t\"./scientist.json\": \"t0mp\",\n\t\"./shadow16.json\": \"me95\",\n\t\"./skeleton.json\": \"1mYB\",\n\t\"./skeleton2.json\": \"jgxY\",\n\t\"./snake.json\": \"0U4p\",\n\t\"./sorcerer.json\": \"8emz\",\n\t\"./sparks.json\": \"2UF/\",\n\t\"./spectre.json\": \"NxES\",\n\t\"./sword.json\": \"wine\",\n\t\"./sword1.json\": \"vm1t\",\n\t\"./sword2.json\": \"H7Qu\",\n\t\"./talk.json\": \"j8az\",\n\t\"./target.json\": \"Qyla\",\n\t\"./test1.json\": \"esNN\",\n\t\"./test2.json\": \"F+2f\",\n\t\"./test3.json\": \"spbf\",\n\t\"./test4.json\": \"INyW\",\n\t\"./villagegirl.json\": \"KD9h\",\n\t\"./villager.json\": \"e7Fs\",\n\t\"./wizard.json\": \"Lx20\"\n};\nfunction webpackContext(req) {\n\treturn __webpack_require__(webpackContextResolve(req));\n};\nfunction webpackContextResolve(req) {\n\tvar id = map[req];\n\tif(!(id + 1)) // check for number or string\n\t\tthrow new Error(\"Cannot find module '\" + req + \"'.\");\n\treturn id;\n};\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = \"1ZLN\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets ^\\.\\/.*\\.json$\n// module id = 1ZLN\n// module chunks = 1","import Character from './character';\n\nexport default class Player extends Character{\n\n    constructor(id, name, kind) {\n        super(id, kind);\n\n        this.name = name;\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/player.js","module.exports = {\"id\":\"skeleton\",\"width\":48,\"height\":48,\"animations\":{\"atk_right\":{\"length\":3,\"row\":0},\"walk_right\":{\"length\":4,\"row\":1},\"idle_right\":{\"length\":2,\"row\":2},\"atk_up\":{\"length\":3,\"row\":3},\"walk_up\":{\"length\":4,\"row\":4},\"idle_up\":{\"length\":3,\"row\":5},\"atk_down\":{\"length\":3,\"row\":6},\"walk_down\":{\"length\":4,\"row\":7},\"idle_down\":{\"length\":3,\"row\":8}},\"offset_x\":-16,\"offset_y\":-20}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/skeleton.json\n// module id = 1mYB\n// module chunks = 1","module.exports = {\"id\":\"sparks\",\"width\":16,\"height\":16,\"animations\":{\"idle\":{\"length\":6,\"row\":0}},\"offset_x\":0,\"offset_y\":0}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/sparks.json\n// module id = 2UF/\n// module chunks = 1","module.exports = {\"id\":\"morningstar\",\"width\":38,\"height\":38,\"animations\":{\"atk_right\":{\"length\":5,\"row\":0},\"walk_right\":{\"length\":4,\"row\":1},\"idle_right\":{\"length\":2,\"row\":2},\"atk_up\":{\"length\":5,\"row\":3},\"walk_up\":{\"length\":4,\"row\":4},\"idle_up\":{\"length\":2,\"row\":5},\"atk_down\":{\"length\":5,\"row\":6},\"walk_down\":{\"length\":4,\"row\":7},\"idle_down\":{\"length\":2,\"row\":8}},\"offset_x\":-11,\"offset_y\":-15}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/morningstar.json\n// module id = 34Xz\n// module chunks = 1","module.exports = {\"id\":\"item-morningstar\",\"width\":16,\"height\":16,\"animations\":{\"idle\":{\"length\":6,\"row\":0}},\"offset_x\":0,\"offset_y\":0}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/item-morningstar.json\n// module id = 3SDg\n// module chunks = 1","module.exports = {\"id\":\"nyan\",\"width\":49,\"height\":24,\"animations\":{\"idle_down\":{\"length\":6,\"row\":0}},\"offset_x\":-22,\"offset_y\":-6}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/nyan.json\n// module id = 47gg\n// module chunks = 1","module.exports = {\"id\":\"rick\",\"width\":32,\"height\":32,\"animations\":{\"idle_down\":{\"length\":4,\"row\":0}},\"offset_x\":-8,\"offset_y\":-12}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/rick.json\n// module id = 4Alr\n// module chunks = 1","module.exports = {\"modp1\":{\"gen\":\"02\",\"prime\":\"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a63a3620ffffffffffffffff\"},\"modp2\":{\"gen\":\"02\",\"prime\":\"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece65381ffffffffffffffff\"},\"modp5\":{\"gen\":\"02\",\"prime\":\"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff\"},\"modp14\":{\"gen\":\"02\",\"prime\":\"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff\"},\"modp15\":{\"gen\":\"02\",\"prime\":\"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a93ad2caffffffffffffffff\"},\"modp16\":{\"gen\":\"02\",\"prime\":\"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c934063199ffffffffffffffff\"},\"modp17\":{\"gen\":\"02\",\"prime\":\"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dcc4024ffffffffffffffff\"},\"modp18\":{\"gen\":\"02\",\"prime\":\"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dbe115974a3926f12fee5e438777cb6a932df8cd8bec4d073b931ba3bc832b68d9dd300741fa7bf8afc47ed2576f6936ba424663aab639c5ae4f5683423b4742bf1c978238f16cbe39d652de3fdb8befc848ad922222e04a4037c0713eb57a81a23f0c73473fc646cea306b4bcbc8862f8385ddfa9d4b7fa2c087e879683303ed5bdd3a062b3cf5b3a278a66d2a13f83f44f82ddf310ee074ab6a364597e899a0255dc164f31cc50846851df9ab48195ded7ea1b1d510bd7ee74d73faf36bc31ecfa268359046f4eb879f924009438b481c6cd7889a002ed5ee382bc9190da6fc026e479558e4475677e9aa9e3050e2765694dfc81f56e880b96e7160c980dd98edd3dfffffffffffffffff\"}}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/diffie-hellman/lib/primes.json\n// module id = 4Vh3\n// module chunks = 1","module.exports = {\"aes-128-ecb\":{\"cipher\":\"AES\",\"key\":128,\"iv\":0,\"mode\":\"ECB\",\"type\":\"block\"},\"aes-192-ecb\":{\"cipher\":\"AES\",\"key\":192,\"iv\":0,\"mode\":\"ECB\",\"type\":\"block\"},\"aes-256-ecb\":{\"cipher\":\"AES\",\"key\":256,\"iv\":0,\"mode\":\"ECB\",\"type\":\"block\"},\"aes-128-cbc\":{\"cipher\":\"AES\",\"key\":128,\"iv\":16,\"mode\":\"CBC\",\"type\":\"block\"},\"aes-192-cbc\":{\"cipher\":\"AES\",\"key\":192,\"iv\":16,\"mode\":\"CBC\",\"type\":\"block\"},\"aes-256-cbc\":{\"cipher\":\"AES\",\"key\":256,\"iv\":16,\"mode\":\"CBC\",\"type\":\"block\"},\"aes128\":{\"cipher\":\"AES\",\"key\":128,\"iv\":16,\"mode\":\"CBC\",\"type\":\"block\"},\"aes192\":{\"cipher\":\"AES\",\"key\":192,\"iv\":16,\"mode\":\"CBC\",\"type\":\"block\"},\"aes256\":{\"cipher\":\"AES\",\"key\":256,\"iv\":16,\"mode\":\"CBC\",\"type\":\"block\"},\"aes-128-cfb\":{\"cipher\":\"AES\",\"key\":128,\"iv\":16,\"mode\":\"CFB\",\"type\":\"stream\"},\"aes-192-cfb\":{\"cipher\":\"AES\",\"key\":192,\"iv\":16,\"mode\":\"CFB\",\"type\":\"stream\"},\"aes-256-cfb\":{\"cipher\":\"AES\",\"key\":256,\"iv\":16,\"mode\":\"CFB\",\"type\":\"stream\"},\"aes-128-cfb8\":{\"cipher\":\"AES\",\"key\":128,\"iv\":16,\"mode\":\"CFB8\",\"type\":\"stream\"},\"aes-192-cfb8\":{\"cipher\":\"AES\",\"key\":192,\"iv\":16,\"mode\":\"CFB8\",\"type\":\"stream\"},\"aes-256-cfb8\":{\"cipher\":\"AES\",\"key\":256,\"iv\":16,\"mode\":\"CFB8\",\"type\":\"stream\"},\"aes-128-cfb1\":{\"cipher\":\"AES\",\"key\":128,\"iv\":16,\"mode\":\"CFB1\",\"type\":\"stream\"},\"aes-192-cfb1\":{\"cipher\":\"AES\",\"key\":192,\"iv\":16,\"mode\":\"CFB1\",\"type\":\"stream\"},\"aes-256-cfb1\":{\"cipher\":\"AES\",\"key\":256,\"iv\":16,\"mode\":\"CFB1\",\"type\":\"stream\"},\"aes-128-ofb\":{\"cipher\":\"AES\",\"key\":128,\"iv\":16,\"mode\":\"OFB\",\"type\":\"stream\"},\"aes-192-ofb\":{\"cipher\":\"AES\",\"key\":192,\"iv\":16,\"mode\":\"OFB\",\"type\":\"stream\"},\"aes-256-ofb\":{\"cipher\":\"AES\",\"key\":256,\"iv\":16,\"mode\":\"OFB\",\"type\":\"stream\"},\"aes-128-ctr\":{\"cipher\":\"AES\",\"key\":128,\"iv\":16,\"mode\":\"CTR\",\"type\":\"stream\"},\"aes-192-ctr\":{\"cipher\":\"AES\",\"key\":192,\"iv\":16,\"mode\":\"CTR\",\"type\":\"stream\"},\"aes-256-ctr\":{\"cipher\":\"AES\",\"key\":256,\"iv\":16,\"mode\":\"CTR\",\"type\":\"stream\"},\"aes-128-gcm\":{\"cipher\":\"AES\",\"key\":128,\"iv\":12,\"mode\":\"GCM\",\"type\":\"auth\"},\"aes-192-gcm\":{\"cipher\":\"AES\",\"key\":192,\"iv\":12,\"mode\":\"GCM\",\"type\":\"auth\"},\"aes-256-gcm\":{\"cipher\":\"AES\",\"key\":256,\"iv\":12,\"mode\":\"GCM\",\"type\":\"auth\"}}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/browserify-aes/modes/list.json\n// module id = 6ZSt\n// module chunks = 1","module.exports = {\"id\":\"beachnpc\",\"width\":24,\"height\":24,\"animations\":{\"idle_down\":{\"length\":2,\"row\":0}},\"offset_x\":-4,\"offset_y\":-8}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/beachnpc.json\n// module id = 72jo\n// module chunks = 1","module.exports = {\"id\":\"item-sword2\",\"width\":16,\"height\":16,\"animations\":{\"idle\":{\"length\":6,\"row\":0}},\"offset_x\":0,\"offset_y\":0}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/item-sword2.json\n// module id = 7fe2\n// module chunks = 1","module.exports = {\"id\":\"ogre\",\"width\":48,\"height\":48,\"animations\":{\"atk_right\":{\"length\":3,\"row\":0},\"walk_right\":{\"length\":6,\"row\":1},\"idle_right\":{\"length\":2,\"row\":2},\"atk_up\":{\"length\":3,\"row\":3},\"walk_up\":{\"length\":5,\"row\":4},\"idle_up\":{\"length\":2,\"row\":5},\"atk_down\":{\"length\":3,\"row\":6},\"walk_down\":{\"length\":6,\"row\":7},\"idle_down\":{\"length\":2,\"row\":8}},\"offset_x\":-16,\"offset_y\":-24}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/ogre.json\n// module id = 8VIR\n// module chunks = 1","module.exports = {\"2.16.840.1.101.3.4.1.1\":\"aes-128-ecb\",\"2.16.840.1.101.3.4.1.2\":\"aes-128-cbc\",\"2.16.840.1.101.3.4.1.3\":\"aes-128-ofb\",\"2.16.840.1.101.3.4.1.4\":\"aes-128-cfb\",\"2.16.840.1.101.3.4.1.21\":\"aes-192-ecb\",\"2.16.840.1.101.3.4.1.22\":\"aes-192-cbc\",\"2.16.840.1.101.3.4.1.23\":\"aes-192-ofb\",\"2.16.840.1.101.3.4.1.24\":\"aes-192-cfb\",\"2.16.840.1.101.3.4.1.41\":\"aes-256-ecb\",\"2.16.840.1.101.3.4.1.42\":\"aes-256-cbc\",\"2.16.840.1.101.3.4.1.43\":\"aes-256-ofb\",\"2.16.840.1.101.3.4.1.44\":\"aes-256-cfb\"}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/parse-asn1/aesid.json\n// module id = 8YCc\n// module chunks = 1","module.exports = {\"id\":\"sorcerer\",\"width\":26,\"height\":26,\"animations\":{\"idle_down\":{\"length\":6,\"row\":0}},\"offset_x\":-5,\"offset_y\":-9}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/sorcerer.json\n// module id = 8emz\n// module chunks = 1","const sprites = [];\r\nconst names = [\r\n    \"deathknight\",\r\n    \"clotharmor\",\r\n    \"test3\",\r\n    \"test4\",\r\n];\r\n\r\n\r\nfor (const name of names) {\r\n    const data = require(`../assets/${name}.json`);\r\n     sprites.push(data);\r\n    \r\n}\r\n\r\nexport default sprites;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/sprites.js","module.exports = {\"id\":\"item-firepotion\",\"width\":16,\"height\":16,\"animations\":{\"idle\":{\"length\":6,\"row\":0}},\"offset_x\":0,\"offset_y\":0}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/item-firepotion.json\n// module id = 9R10\n// module chunks = 1","module.exports = {\"id\":\"item-redarmor\",\"width\":16,\"height\":16,\"animations\":{\"idle\":{\"length\":6,\"row\":0}},\"offset_x\":0,\"offset_y\":0}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/item-redarmor.json\n// module id = A0vU\n// module chunks = 1","module.exports = {\"id\":\"clotharmor\",\"width\":32,\"height\":32,\"animations\":{\"atk_right\":{\"length\":5,\"row\":0},\"walk_right\":{\"length\":4,\"row\":1},\"idle_right\":{\"length\":2,\"row\":2},\"atk_up\":{\"length\":5,\"row\":3},\"walk_up\":{\"length\":4,\"row\":4},\"idle_up\":{\"length\":2,\"row\":5},\"atk_down\":{\"length\":5,\"row\":6},\"walk_down\":{\"length\":4,\"row\":7},\"idle_down\":{\"length\":2,\"row\":8}},\"offset_x\":-8,\"offset_y\":-12}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/clotharmor.json\n// module id = AKwQ\n// module chunks = 1","import anchors from './anchors.js';\nimport BitmapText from './BitmapText.js';\nimport Rectangle from './Rectangle.js';\nimport Sprite from './Sprite.js';\nimport Text from './Text.js';\n\nimport { isFirefox } from './utils/browserDetection.js';\n\n// All properties that when adjusted will force a redraw of the UI\nvar dirtyProperties = ['x','y','width','height','rotation','alpha','visible','pivot','anchor','smoothing','stretch','offset','text','scale','parent','textAlign','assetPath','color','left','right','up','down','ActiveInvoke'];\n\nvar observeDirtyProperties = function(object, ui) {\n\tdirtyProperties.forEach(function(prop) {\n\t\tvar proxyKey = '_proxied_' + prop;\n\n\t\t// Make sure initial values are set first\n\t\tobject[proxyKey] = object[prop];\n\n\t\tObject.defineProperty(object, prop, {\n\t\t\tset: function(value) {\n\t\t\t\tif (object[prop] !== value) {\n\t\t\t\t\tui.shouldReDraw = true;\n\t\t\t\t}\n\n\t\t\t\tobject[proxyKey] = value;\n\t\t\t},\n\n\t\t\tget: function() {\n\t\t\t\treturn object[proxyKey];\n\t\t\t},\n\t\t});\n\t});\n};\n\n/**\n * ThreeUI\n *\n * UI Class that renders an internal 2d canvas onto a plane\n *\n * @param {HTMLCanvasElement} gameCanvas\n * @param {int} height The pixel height of this UI -- Default: 720\n * @param {bool} renderOnQuad Render on a quad, if false, canvas will be in DOM\n */\n\nvar ThreeUI = function(gameCanvas, height, renderOnQuad) {\n\tthis.displayObjects = [];\n\tthis.eventListeners = {\n\t\tclick: [],\n\t};\n\n\tthis.clearRect = null;\n\tthis.gameCanvas = gameCanvas;\n\tthis.canvas = document.getElementById(\"foreground\");\n\tthis.context = this.canvas.getContext('2d');\n\tthis.renderOnQuad = renderOnQuad || false;\n\tthis.shouldReDraw = true;\n\n\tif (this.renderOnQuad) {\n\t\tthis.prepareThreeJSScene();\n\t} else {\n\t\t//this.addCanvasToDom();\n\t}\n\n\tthis.resize();\n};\n\n/**\n * Attach anchor types to ThreeUI\n */\n\nThreeUI.anchors = anchors;\n\nThreeUI.prototype.addCanvasToDom = function() {\n\tthis.gameCanvas.parentNode.appendChild(this.canvas);\n\n\t// Make sure the gameCanvas has position\n\t/*if (['relative', 'absolute', 'fixed'].indexOf(this.gameCanvas.style.position) === -1) {\n\t\tthis.gameCanvas.style.position = 'relative';\n\t}*/\n\n\t//this.canvas.style.position = 'absolute';\n\t//this.canvas.style.left = 0;\n\t//this.canvas.style.top = 0;\n\t/*this.canvas.style.zIndex = 1;\n\tthis.canvas.style.transformOrigin = '0% 0%';\n\tthis.canvas.style.perspective = '1000px'; // Hardware acceleration!*/\n};\n\n/**\n * Internal method that does all preparations related to ThreeJS, creating the scene, camera, geometry etc.\n */\n\nThreeUI.prototype.prepareThreeJSScene = function() {\n\tthis.camera = new THREE.OrthographicCamera(\n\t\t-this.canvas.width / 2,\n\t\tthis.canvas.width / 2,\n\t\tthis.canvas.height / 2,\n\t\t-this.canvas.height / 2,\n\t\t0, 30\n\t);\n\n\tthis.scene = new THREE.Scene();\n\n\tthis.texture = new THREE.Texture(this.canvas);\n\n\tvar material = new THREE.MeshBasicMaterial({ map: this.texture });\n\tmaterial.transparent = true;\n\n\tvar planeGeo = new THREE.PlaneGeometry(this.canvas.width, this.canvas.height);\n\tthis.plane = new THREE.Mesh(planeGeo, material);\n\tthis.plane.matrixAutoUpdate = false;\n\n\tthis.scene.add(this.plane);\n};\n\n/**\n * Recalculate UI dimensions\n */\n\nThreeUI.prototype.resize = function() {\n\t//var gameCanvasAspect = this.gameCanvas.width / this.gameCanvas.height;\n\t//this.width = this.height * gameCanvasAspect;\n\n\tthis.width = 800;\n\tthis.height = 400;\n\n\t//this.canvas.width = this.width\n\t//this.canvas.height = this.height;\n\n\n\t//var containerWidth = this.gameCanvas.parentNode.getBoundingClientRect().width;\n\t//this.canvas.style.transform = 'scale(' + (containerWidth / this.width) + ')';\n\n\tthis.shouldReDraw = true;\n};\n\n/**\n * Draw the UI\n */\n\nThreeUI.prototype.draw = function() {\n\tif (!this.shouldReDraw) return;\n\n\t// Reset canvas\n\tif (this.clearRect) {\n\t\t//this.context.clearRect(this.clearRect.x, this.clearRect.y, this.clearRect.width, this.clearRect.height);\n\t} else {\n\t\tthis.context.clearRect(0, 0, this.canvas.width, this.canvas.height);\n\t}\n\n\tvar self = this;\n\tvar length = this.displayObjects.length;\n\tfor (var i = 0;i < length;i++) {\n\t\t// 앵커와 위치를 조절한다\n\t\tthis.displayObjects[i].render(self.context);\n\t}\n\n\t// Make sure the texture gets re-drawn\n\tif (this.renderOnQuad) {\n\t\tthis.texture.needsUpdate = true;\n\t}\n\n\tthis.shouldReDraw = false;\n};\n\n/**\n * Render the UI with the provided renderer\n *\n * @param {THREE.WebGLRenderer} renderer\n */\n\nThreeUI.prototype.render = function(renderer) {\n\tthis.draw();\n\n\tif (this.renderOnQuad) {\n\t\trenderer.render(this.scene, this.camera);\n\t}\n\n\tif (this.colorReplace) {\n\t\tthis.context.save();\n\n\t\tthis.context.fillStyle = this.colorReplace\n\t\tthis.context.globalCompositeOperation = 'source-atop';\n\t\tthis.context.fillRect(0, 0, this.canvas.width, this.canvas.height);\n\n\t\tthis.context.restore();\n\t}\n};\n\n/**\n * Create a new Sprite\n *\n * @param {string} imagePath\n * @param {int} x\n * @param {int} y\n * @param {int} width\n * @param {int} height\n *\n * @return {Sprite}\n */\n\nThreeUI.prototype.createSprite = function(imagePath, x, y, width, height) {\n\tvar displayObject = new Sprite(this, imagePath, x, y, width, height);\n\tthis.displayObjects.push(displayObject);\n\tobserveDirtyProperties(displayObject, this);\n\treturn displayObject;\n};\n\n/**\n * Create a new Sprite from a sheet\n *\n * @param {string} imagePath\n * @param {string} sheetImagePath\n * @param {string} sheetDataPath\n * @param {int} x\n * @param {int} y\n * @param {int} width\n * @param {int} height\n *\n * @return {Sprite}\n */\n\nThreeUI.prototype.createSpriteFromSheet = function(imagePath, sheetImagePath, sheetDataPath, x, y, width, height) {\n\tvar displayObject = new Sprite(this, imagePath, x, y, width, height, sheetImagePath, sheetDataPath);\n\tthis.displayObjects.push(displayObject);\n\tobserveDirtyProperties(displayObject, this);\n\treturn displayObject;\n};\n\n/**\n * Create a new Rectangle\n *\n * @param {string} color\n * @param {int} x\n * @param {int} y\n * @param {int} width\n * @param {int} height\n *\n * @return {Rectangle}\n */\n\nThreeUI.prototype.createRectangle = function(color, x, y, width, height) {\n\tvar displayObject = new Rectangle(this, color, x, y, width, height);\n\tthis.displayObjects.push(displayObject);\n\tobserveDirtyProperties(displayObject, this);\n\treturn displayObject;\n};\n\n/**\n * Create a new Text\n *\n * @param {string} text\n * @param {string} font\n * @param {string} color\n * @param {int} x\n * @param {int} y\n *\n * @return {Text}\n */\n\nThreeUI.prototype.createText = function(text, font, color, x, y) {\n\tvar displayObject = new Text(this, text, font, color, x, y);\n\tthis.displayObjects.push(displayObject);\n\tobserveDirtyProperties(displayObject, this);\n\treturn displayObject;\n};\n\n/**\n * Create a new BitmapText\n *\n * @param {string} text\n * @param {string} font\n * @param {string} color\n * @param {int} x\n * @param {int} y\n *\n * @return {BitmapText}\n */\n\nThreeUI.prototype.createBitmapText = function(text, size, x, y, sheetImagePath, sheetDataPath) {\n\tvar displayObject = new BitmapText(this, text, size, x, y, sheetImagePath, sheetDataPath);\n\tthis.displayObjects.push(displayObject);\n\tobserveDirtyProperties(displayObject, this);\n\treturn displayObject;\n};\n\n/**\n * Add a new event listener, called by ThreeUI.DisplayObject\n * Shouldn't be used directly\n *\n * @param {string} type\n * @param {Function} callback This callback is called when the event is triggered, and is passed the DisplayObject as a first argument\n * @param {ThreeUI.DisplayObject} displayObject\n */\n\nThreeUI.prototype.addEventListener = function(type, callback, displayObject) {\n\tthis.eventListeners[type].push({\n\t\tcallback: callback,\n\t\tdisplayObject: displayObject\n\t});\n};\n\n/**\n * Used internally to determine which registered click event listeners should be called upon click\n *\n * @param {MouseEvent} event\n */\n\nThreeUI.prototype.clickHandler = function(x, y) {\n\tconst coords = { x: x, y: y };\n\n\t//coords = this.windowToUISpace(coords.x, coords.y);\n\n\tvar callbackQueue = [];\n\tthis.eventListeners.click.forEach(function(listener) {\n\t\tvar displayObject = listener.displayObject;\n\t\tif (!displayObject.shouldReceiveEvents()) return;\n\n\t\tvar bounds = displayObject.getBounds();\n\n\t\t// 완전히 잘못만들었다...\n\t\t// 제일 자식노드를 찾아서 클릭시켜야 하는데..\n\t\t// 이거 만든 녀석은 바보냐;\n\t\tif (ThreeUI.isInBoundingBox(coords.x, coords.y, bounds.x, bounds.y, bounds.width, bounds.height)) {\n\t\t\t// Put listeners in a queue first, so state changes do not impact checking other click handlers\n\t\t\tcallbackQueue.push(listener.callback);\n\t\t}\n\t});\n\n\tlet result = false;\n\n\tcallbackQueue.forEach(function(callback){\n\t\tcallback();\n\t\tresult = true;\n\t});\n\n\treturn result;\n};\n\n/**\n * Helper method that converts a point to UI space from window space\n *\n * @param {int} x\n * @param {int} y\n *\n * @return {Object} x,y coordinates\n */\n\nThreeUI.prototype.windowToUISpace = function(x, y) {\n\tvar bounds = this.gameCanvas.getBoundingClientRect();\n\tvar scale = this.height / bounds.height;\n\n\treturn {\n\t\tx: (x - bounds.left) * scale,\n\t\ty: (y - bounds.top) * scale,\n\t};\n}\n\n/**\n * Moves a ui element to the back of the displayobject queue\n * which causes it to render above other objects\n *\n * @param {ThreeUI.DisplayObject} displayObject\n */\nThreeUI.prototype.moveToFront = function(displayObject) {\n\tvar elIdx = this.displayObjects.indexOf(displayObject);\n\n\tif (elIdx > -1) {\n\t\tthis.displayObjects.splice(elIdx, 1);\n\t}\n\n\tthis.displayObjects.push(displayObject);\n};\n\n/**\n * Helper method used to determine whether a point is inside of a given bounding box\n *\n * @param {int} x\n * @param {int} y\n * @param {int} boundX\n * @param {int} boundY\n * @param {int} boundWidth\n * @param {int} boundHeight\n *\n * @return {bool}\n */\n\nThreeUI.isInBoundingBox = function(x, y, boundX, boundY, boundWidth, boundHeight) {\n\treturn (\n\t\tx >= boundX &&\n\t\tx <= boundX + boundWidth &&\n\t\ty >= boundY &&\n\t\ty <= boundY + boundHeight\n\t);\n};\n\n// Export ThreeUI as module\nexport default ThreeUI;\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/three-ui/ThreeUI.js","module.exports = {\"id\":\"item-cake\",\"width\":24,\"height\":24,\"animations\":{\"idle\":{\"length\":3,\"row\":0}},\"offset_x\":-4,\"offset_y\":-6}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/item-cake.json\n// module id = B4O8\n// module chunks = 1","module.exports = {\"id\":\"item-mailarmor\",\"width\":16,\"height\":16,\"animations\":{\"idle\":{\"length\":6,\"row\":0}},\"offset_x\":0,\"offset_y\":0}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/item-mailarmor.json\n// module id = BvGv\n// module chunks = 1","module.exports = {\"id\":\"goblin\",\"width\":26,\"height\":26,\"animations\":{\"atk_right\":{\"length\":3,\"row\":0},\"walk_right\":{\"length\":3,\"row\":1},\"idle_right\":{\"length\":2,\"row\":2},\"atk_up\":{\"length\":3,\"row\":3},\"walk_up\":{\"length\":4,\"row\":4},\"idle_up\":{\"length\":2,\"row\":5},\"atk_down\":{\"length\":3,\"row\":6},\"walk_down\":{\"length\":4,\"row\":7},\"idle_down\":{\"length\":2,\"row\":8}},\"offset_x\":-5,\"offset_y\":-9}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/goblin.json\n// module id = C37V\n// module chunks = 1","import Entity from './entity';\r\n\r\nexport default class Prop extends Entity {\r\n    constructor(id, kind) {\r\n        super(id, kind);\r\n        \r\n        this.load();\r\n    }\r\n\r\n    load() {\r\n        // 공통적으로 box 메쉬를 만들어서 사용한다. 일단은 메쉬가 따로 없으므로 ...\r\n        // TODO :load() 데이터를 외부의 데이터를 읽도록 해야한다\r\n        const geometry = new THREE.BoxBufferGeometry( 8, 8, 8 );\r\n        const material\t= new THREE.MeshLambertMaterial({ color: 0xffffff });\r\n        const mesh\t= new THREE.Mesh( geometry, material );\r\n\r\n        geometry.computeBoundingBox();\r\n\r\n        this.mesh = mesh;\r\n        this.offset = {\r\n            x: 0,\r\n            y: -geometry.boundingBox.min.y,\r\n            z: 0,\r\n        }\r\n\r\n        this.isLoaded = true;\r\n    }\r\n\r\n    attachPointLight(color, intensity, radius) {\r\n        var light = new THREE.PointLight(color, intensity, radius);\r\n        light.position.set(0, 10, 0);\r\n        light.castShadow = true;\r\n        this.mesh.add( light );\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/prop.js","module.exports = {\"id\":\"test2\",\"width\":24,\"height\":50,\"animations\":{\"walk_right\":{\"length\":4,\"row\":2},\"idle_right\":{\"length\":4,\"row\":2},\"walk_up\":{\"length\":4,\"row\":1},\"idle_up\":{\"length\":4,\"row\":1},\"walk_down\":{\"length\":4,\"row\":0},\"idle_down\":{\"length\":4,\"row\":0}},\"offset_x\":0,\"offset_y\":-21}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/test2.json\n// module id = F+2f\n// module chunks = 1","/**\r\n * A* (A-Star) algorithm for a path finder\r\n * @author  Andrea Giammarchi\r\n * @license Mit Style License\r\n */\r\n\r\nfunction diagonalSuccessors($N, $S, $E, $W, N, S, E, W, grid, rows, cols, result, i) {\r\n    if($N) {\r\n        $E && !grid[N][E] && (result[i++] = {x:E, y:N});\r\n        $W && !grid[N][W] && (result[i++] = {x:W, y:N});\r\n    }\r\n    if($S){\r\n        $E && !grid[S][E] && (result[i++] = {x:E, y:S});\r\n        $W && !grid[S][W] && (result[i++] = {x:W, y:S});\r\n    }\r\n    return result;\r\n}\r\n\r\nfunction diagonalSuccessorsFree($N, $S, $E, $W, N, S, E, W, grid, rows, cols, result, i) {\r\n    $N = N > -1;\r\n    $S = S < rows;\r\n    $E = E < cols;\r\n    $W = W > -1;\r\n    if($E) {\r\n        $N && !grid[N][E] && (result[i++] = {x:E, y:N});\r\n        $S && !grid[S][E] && (result[i++] = {x:E, y:S});\r\n    }\r\n    if($W) {\r\n        $N && !grid[N][W] && (result[i++] = {x:W, y:N});\r\n        $S && !grid[S][W] && (result[i++] = {x:W, y:S});\r\n    }\r\n    return result;\r\n}\r\n\r\nfunction nothingToDo($N, $S, $E, $W, N, S, E, W, grid, rows, cols, result, i) {\r\n    return result;\r\n}\r\n\r\nfunction successors(find, x, y, grid, rows, cols){\r\n    var\r\n        N = y - 1,\r\n        S = y + 1,\r\n        E = x + 1,\r\n        W = x - 1,\r\n        $N = N > -1 && !grid[N][x],\r\n        $S = S < rows && !grid[S][x],\r\n        $E = E < cols && !grid[y][E],\r\n        $W = W > -1 && !grid[y][W],\r\n        result = [],\r\n        i = 0\r\n    ;\r\n    $N && (result[i++] = {x:x, y:N});\r\n    $E && (result[i++] = {x:E, y:y});\r\n    $S && (result[i++] = {x:x, y:S});\r\n    $W && (result[i++] = {x:W, y:y});\r\n    return find($N, $S, $E, $W, N, S, E, W, grid, rows, cols, result, i);\r\n}\r\n\r\nfunction diagonal(start, end, f1, f2) {\r\n    return f2(f1(start.x - end.x), f1(start.y - end.y));\r\n}\r\n\r\nfunction euclidean(start, end, f1, f2) {\r\n    var\r\n        x = start.x - end.x,\r\n        y = start.y - end.y\r\n    ;\r\n    return f2(x * x + y * y);\r\n}\r\n\r\nfunction manhattan(start, end, f1, f2) {\r\n    return f1(start.x - end.x) + f1(start.y - end.y);\r\n}\r\n\r\nfunction AStar(grid, start, end, f) {\r\n    var\r\n        cols = grid[0].length,\r\n        rows = grid.length,\r\n        limit = cols * rows,\r\n        f1 = Math.abs,\r\n        f2 = Math.max,\r\n        list = {},\r\n        result = [],\r\n        open = [{x:start[0], y:start[1], f:0, g:0, v:start[0]+start[1]*cols}],\r\n        length = 1,\r\n        adj, distance, find, i, j, max, min, current, next\r\n    ;\r\n    end = {x:end[0], y:end[1], v:end[0]+end[1]*cols};\r\n    switch (f) {\r\n        case \"Diagonal\":\r\n            find = diagonalSuccessors;\r\n        case \"DiagonalFree\":\r\n            distance = diagonal;\r\n            break;\r\n        case \"Euclidean\":\r\n            find = diagonalSuccessors;\r\n        case \"EuclideanFree\":\r\n            f2 = Math.sqrt;\r\n            distance = euclidean;\r\n            break;\r\n        default:\r\n            distance = manhattan;\r\n            find = nothingToDo;\r\n            break;\r\n    }\r\n    find || (find = diagonalSuccessorsFree);\r\n    do {\r\n        max = limit;\r\n        min = 0;\r\n        for(i = 0; i < length; ++i) {\r\n            if((f = open[i].f) < max) {\r\n                max = f;\r\n                min = i;\r\n            }\r\n        };\r\n        current = open.splice(min, 1)[0];\r\n        if (current.v != end.v) {\r\n            --length;\r\n            next = successors(find, current.x, current.y, grid, rows, cols);\r\n            for(i = 0, j = next.length; i < j; ++i){\r\n                (adj = next[i]).p = current;\r\n                adj.f = adj.g = 0;\r\n                adj.v = adj.x + adj.y * cols;\r\n                if(!(adj.v in list)){\r\n                    adj.f = (adj.g = current.g + distance(adj, current, f1, f2)) + distance(adj, end, f1, f2);\r\n                    open[length++] = adj;\r\n                    list[adj.v] = 1;\r\n                }\r\n            }\r\n        } else {\r\n            i = length = 0;\r\n            do {\r\n                result[i++] = [current.x, current.y];\r\n            } while (current = current.p);\r\n            result.reverse();\r\n        }\r\n    } while (length);\r\n    return result;\r\n}\r\n\r\nexport default AStar;\n\n\n// WEBPACK FOOTER //\n// ./src/lib/astar.js","import AStar from '../lib/astar';\r\n\r\nexport default class Pathfinder {\r\n    constructor(width, height) {\r\n        this.width = width;\r\n        this.height = height;\r\n        this.grid = null;\r\n        this.ignored = [];\r\n\r\n        this.initBlankGrid();\r\n    }\r\n\r\n    initBlankGrid() {\r\n        this.blankGrid = [];\r\n        for(let i=0; i < this.height; i += 1) {\r\n            this.blankGrid[i] = [];\r\n            for(let j=0; j < this.width; j += 1) {\r\n                this.blankGrid[i][j] = 0;\r\n            }\r\n        }\r\n    }\r\n\r\n    findPath(grid, entity, x, y, findIncomplete) {\r\n        const start = [entity.gridX, entity.gridY];\r\n        const end = [x, y];\r\n\r\n        this.grid = grid;\r\n        let path = AStar(this.grid, start, end);\r\n    \r\n        if(path.length === 0 && findIncomplete === true) {\r\n            // If no path was found, try and find an incomplete one\r\n            // to at least get closer to destination.\r\n            path = this.findIncompletePath_(start, end);\r\n        }\r\n    \r\n        return path;\r\n    }\r\n\r\n    /**\r\n     * Finds a path which leads the closest possible to an unreachable x, y position.\r\n     *\r\n     * Whenever A* returns an empty path, it means that the destination tile is unreachable.\r\n     * We would like the entities to move the closest possible to it though, instead of\r\n     * staying where they are without moving at all. That's why we have this function which\r\n     * returns an incomplete path to the chosen destination.\r\n     *\r\n     * @private\r\n     * @returns {Array} The incomplete path towards the end position\r\n     */\r\n    findIncompletePath_(start, end) {\r\n        let perfect, x, y,\r\n            incomplete = [];\r\n\r\n        perfect = AStar(this.blankGrid, start, end);\r\n    \r\n        for(let i=perfect.length-1; i > 0; i -= 1) {\r\n            x = perfect[i][0];\r\n            y = perfect[i][1];\r\n        \r\n            if(this.grid[y][x] === 0) {\r\n                incomplete = AStar(this.grid, start, [x, y]);\r\n                break;\r\n            }\r\n        }\r\n        return incomplete;\r\n    }\r\n\r\n    /**\r\n     * Removes colliding tiles corresponding to the given entity's position in the pathing grid.\r\n     */\r\n    ignoreEntity(entity) {\r\n        if(entity) {\r\n            this.ignored.push(entity);\r\n        }\r\n    }\r\n\r\n    clearIgnoreList() {\r\n        this.applyIgnoreList_(false);\r\n        this.ignored = [];\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/pathfinder.js","module.exports = {\"id\":\"sword2\",\"width\":48,\"height\":48,\"animations\":{\"atk_right\":{\"length\":5,\"row\":0},\"walk_right\":{\"length\":4,\"row\":1},\"idle_right\":{\"length\":2,\"row\":2},\"atk_up\":{\"length\":5,\"row\":3},\"walk_up\":{\"length\":4,\"row\":4},\"idle_up\":{\"length\":2,\"row\":5},\"atk_down\":{\"length\":5,\"row\":6},\"walk_down\":{\"length\":4,\"row\":7},\"idle_down\":{\"length\":2,\"row\":8}},\"offset_x\":-16,\"offset_y\":-20}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/sword2.json\n// module id = H7Qu\n// module chunks = 1","module.exports = {\"id\":\"item-axe\",\"width\":16,\"height\":16,\"animations\":{\"idle\":{\"length\":6,\"row\":0}},\"offset_x\":0,\"offset_y\":0}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/item-axe.json\n// module id = HITf\n// module chunks = 1","module.exports = {\"id\":\"redsword\",\"width\":48,\"height\":48,\"animations\":{\"atk_right\":{\"length\":5,\"row\":0},\"walk_right\":{\"length\":4,\"row\":1},\"idle_right\":{\"length\":2,\"row\":2},\"atk_up\":{\"length\":5,\"row\":3},\"walk_up\":{\"length\":4,\"row\":4},\"idle_up\":{\"length\":2,\"row\":5},\"atk_down\":{\"length\":5,\"row\":6},\"walk_down\":{\"length\":4,\"row\":7},\"idle_down\":{\"length\":2,\"row\":8}},\"offset_x\":-16,\"offset_y\":-20}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/redsword.json\n// module id = IJ/y\n// module chunks = 1","module.exports = {\"id\":\"test4\",\"width\":72,\"height\":48,\"animations\":{\"attack_ready\":{\"length\":3,\"row\":0},\"attack\":{\"length\":3,\"row\":1}},\"offset_x\":0,\"offset_y\":-22}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/test4.json\n// module id = INyW\n// module chunks = 1","import GLTFLoader from './gltfloader';\r\n\r\nconst isInt = function(n) {\r\n    return (n % 1) === 0;\r\n};\r\n\r\nexport default class Map {\r\n    constructor(game) {\r\n        this.loadMap();\r\n    }\r\n\r\n    loadMap() {\r\n        const filepath = \"static/maps.json\";\r\n        $.get(filepath, (data) => {\r\n            this._initMap(data);\r\n            this._generateCollisionGrid();\r\n\r\n            var loader = new GLTFLoader();\r\n            loader.load(\"static/terrain.gltf\", (model) => {\r\n                this.model = model;\r\n                this.isLoaded = true;\r\n            });\r\n        }, 'json');\r\n    }\r\n\r\n    _initMap(map) {\r\n        this.width = map.width;\r\n        this.height = map.height;\r\n        this.data = map.data;\r\n        this.tilesize = map.tilesize;\r\n        this.collisions = map.collisions;\r\n        this.props = map.props;\r\n    }\r\n\r\n    _generateCollisionGrid() {\r\n        this.grid = [];\r\n        for(let\ti = 0; i < this.height; i++) {\r\n            this.grid[i] = [];\r\n            for(let j = 0; j < this.width; j++) {\r\n                this.grid[i][j] = 0;\r\n            }\r\n        }\r\n\r\n        _.each(this.collisions, (tileIndex) => {\r\n            const pos = this.tileIndexToGridPosition(tileIndex+1);\r\n            this.grid[pos.y][pos.x] = 1;\r\n        });\r\n    }\r\n\r\n    isColliding(x, y) { \r\n        if(this.isOutOfBounds(x, y) || !this.grid) {\r\n            return false;\r\n        }\r\n        return (this.grid[y][x] === 1);\r\n    }\r\n\r\n    isOutOfBounds(x, y) {\r\n        return isInt(x) && isInt(y) && (x < 0 || x >= this.width || y < 0 || y >= this.height);\r\n    }\r\n\r\n    tileIndexToGridPosition(tileNum) {\r\n        // 타일은 0 번은 없는 것이기 때문에 1번부터 시작한다\r\n        tileNum -= 1;\r\n        const x = tileNum % this.width;\r\n        const y = Math.floor(tileNum / this.width);\r\n\r\n        return { x: x, y: y };\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/map.js","module.exports = {\"id\":\"leatherarmor\",\"width\":32,\"height\":32,\"animations\":{\"atk_right\":{\"length\":5,\"row\":0},\"walk_right\":{\"length\":4,\"row\":1},\"idle_right\":{\"length\":2,\"row\":2},\"atk_up\":{\"length\":5,\"row\":3},\"walk_up\":{\"length\":4,\"row\":4},\"idle_up\":{\"length\":2,\"row\":5},\"atk_down\":{\"length\":5,\"row\":6},\"walk_down\":{\"length\":4,\"row\":7},\"idle_down\":{\"length\":2,\"row\":8}},\"offset_x\":-8,\"offset_y\":-12}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/leatherarmor.json\n// module id = JYMs\n// module chunks = 1","module.exports = {\"id\":\"villagegirl\",\"width\":24,\"height\":24,\"animations\":{\"idle_down\":{\"length\":2,\"row\":0}},\"offset_x\":-4,\"offset_y\":-8}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/villagegirl.json\n// module id = KD9h\n// module chunks = 1","export default class GameWorld {\r\n    constructor(game, map) {\r\n        this.game = game;\r\n        this.map = map;\r\n\r\n        const geometry = new THREE.PlaneBufferGeometry(map.width * map.tilesize, map.height * map.tilesize, map.width, map.height );\r\n        const material = new THREE.MeshStandardMaterial( { transparent: true, opacity: 0 } );\r\n        const plane  = new THREE.Mesh( geometry, material );\r\n        plane.rotation.order = 'YXZ';\r\n        plane.rotation.x = -Math.PI/2;\r\n        plane.position.y = 1;\r\n        geometry.computeBoundingBox();\r\n\r\n        game.map.offset = {\r\n            x: geometry.boundingBox.min.x,\r\n            y: geometry.boundingBox.min.y\r\n        };\r\n        this.terrain = plane;\r\n\r\n        if (map.model) {\r\n            const model = map.model.scene.children[0];\r\n            model.receiveShadow = true;\r\n            //model.position.x = 50;\r\n            model.rotation.y = -Math.PI /2;\r\n            model.scale.set(5, 5, 5);\r\n\r\n            this.model = model;\r\n        }\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/gameworld.js","module.exports = {\"_from\":\"elliptic@^6.0.0\",\"_id\":\"elliptic@6.4.1\",\"_inBundle\":false,\"_integrity\":\"sha512-BsXLz5sqX8OHcsh7CqBMztyXARmGQ3LWPtGjJi6DiJHq5C/qvi9P3OqgswKSDftbu8+IoI/QDTAm2fFnQ9SZSQ==\",\"_location\":\"/elliptic\",\"_phantomChildren\":{},\"_requested\":{\"type\":\"range\",\"registry\":true,\"raw\":\"elliptic@^6.0.0\",\"name\":\"elliptic\",\"escapedName\":\"elliptic\",\"rawSpec\":\"^6.0.0\",\"saveSpec\":null,\"fetchSpec\":\"^6.0.0\"},\"_requiredBy\":[\"/browserify-sign\",\"/create-ecdh\"],\"_resolved\":\"https://registry.npmjs.org/elliptic/-/elliptic-6.4.1.tgz\",\"_shasum\":\"c2d0b7776911b86722c632c3c06c60f2f819939a\",\"_spec\":\"elliptic@^6.0.0\",\"_where\":\"D:\\\\langley0@github\\\\projectB\\\\node_modules\\\\browserify-sign\",\"author\":{\"name\":\"Fedor Indutny\",\"email\":\"fedor@indutny.com\"},\"bugs\":{\"url\":\"https://github.com/indutny/elliptic/issues\"},\"bundleDependencies\":false,\"dependencies\":{\"bn.js\":\"^4.4.0\",\"brorand\":\"^1.0.1\",\"hash.js\":\"^1.0.0\",\"hmac-drbg\":\"^1.0.0\",\"inherits\":\"^2.0.1\",\"minimalistic-assert\":\"^1.0.0\",\"minimalistic-crypto-utils\":\"^1.0.0\"},\"deprecated\":false,\"description\":\"EC cryptography\",\"devDependencies\":{\"brfs\":\"^1.4.3\",\"coveralls\":\"^2.11.3\",\"grunt\":\"^0.4.5\",\"grunt-browserify\":\"^5.0.0\",\"grunt-cli\":\"^1.2.0\",\"grunt-contrib-connect\":\"^1.0.0\",\"grunt-contrib-copy\":\"^1.0.0\",\"grunt-contrib-uglify\":\"^1.0.1\",\"grunt-mocha-istanbul\":\"^3.0.1\",\"grunt-saucelabs\":\"^8.6.2\",\"istanbul\":\"^0.4.2\",\"jscs\":\"^2.9.0\",\"jshint\":\"^2.6.0\",\"mocha\":\"^2.1.0\"},\"files\":[\"lib\"],\"homepage\":\"https://github.com/indutny/elliptic\",\"keywords\":[\"EC\",\"Elliptic\",\"curve\",\"Cryptography\"],\"license\":\"MIT\",\"main\":\"lib/elliptic.js\",\"name\":\"elliptic\",\"repository\":{\"type\":\"git\",\"url\":\"git+ssh://git@github.com/indutny/elliptic.git\"},\"scripts\":{\"jscs\":\"jscs benchmarks/*.js lib/*.js lib/**/*.js lib/**/**/*.js test/index.js\",\"jshint\":\"jscs benchmarks/*.js lib/*.js lib/**/*.js lib/**/**/*.js test/index.js\",\"lint\":\"npm run jscs && npm run jshint\",\"test\":\"npm run lint && npm run unit\",\"unit\":\"istanbul test _mocha --reporter=spec test/index.js\",\"version\":\"grunt dist && git add dist/\"},\"version\":\"6.4.1\"}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/elliptic/package.json\n// module id = KYqO\n// module chunks = 1","module.exports = {\"id\":\"platearmor\",\"width\":32,\"height\":32,\"animations\":{\"atk_right\":{\"length\":5,\"row\":0},\"walk_right\":{\"length\":4,\"row\":1},\"idle_right\":{\"length\":2,\"row\":2},\"atk_up\":{\"length\":5,\"row\":3},\"walk_up\":{\"length\":4,\"row\":4},\"idle_up\":{\"length\":2,\"row\":5},\"atk_down\":{\"length\":5,\"row\":6},\"walk_down\":{\"length\":4,\"row\":7},\"idle_down\":{\"length\":2,\"row\":8}},\"offset_x\":-8,\"offset_y\":-12}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/platearmor.json\n// module id = L0hz\n// module chunks = 1","module.exports = {\"id\":\"item-clotharmor\",\"width\":16,\"height\":16,\"animations\":{\"idle\":{\"length\":6,\"row\":0}},\"offset_x\":0,\"offset_y\":0}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/item-clotharmor.json\n// module id = LsZA\n// module chunks = 1","module.exports = {\"id\":\"wizard\",\"width\":26,\"height\":26,\"animations\":{\"death\":{\"length\":3,\"row\":0},\"atk_right\":{\"length\":4,\"row\":1},\"atk_up\":{\"length\":4,\"row\":2},\"atk_down\":{\"length\":4,\"row\":3},\"walk_right\":{\"length\":4,\"row\":4},\"walk_up\":{\"length\":4,\"row\":5},\"walk_down\":{\"length\":4,\"row\":6},\"idle_right\":{\"length\":6,\"row\":7},\"idle_up\":{\"length\":6,\"row\":8},\"idle_down\":{\"length\":6,\"row\":9}},\"offset_x\":-5,\"offset_y\":-9}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/wizard.json\n// module id = Lx20\n// module chunks = 1","export default class GLTFLoader{\r\n\tconstructor(manager) {\r\n        this.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\t\tthis.dracoLoader = null;\r\n        this.crossOrigin = 'anonymous';\r\n    }\r\n\r\n    load( url, onLoad, onProgress, onError ) {\r\n\r\n        var scope = this;\r\n\r\n        var resourcePath;\r\n\r\n        if ( this.resourcePath !== undefined ) {\r\n\r\n            resourcePath = this.resourcePath;\r\n\r\n        } else if ( this.path !== undefined ) {\r\n\r\n            resourcePath = this.path;\r\n\r\n        } else {\r\n\r\n            resourcePath = THREE.LoaderUtils.extractUrlBase( url );\r\n\r\n        }\r\n\r\n        // Tells the LoadingManager to track an extra item, which resolves after\r\n        // the model is fully loaded. This means the count of items loaded will\r\n        // be incorrect, but ensures manager.onLoad() does not fire early.\r\n        scope.manager.itemStart( url );\r\n\r\n        var _onError = function ( e ) {\r\n\r\n            if ( onError ) {\r\n\r\n                onError( e );\r\n\r\n            } else {\r\n\r\n                console.error( e );\r\n\r\n            }\r\n\r\n            scope.manager.itemError( url );\r\n            scope.manager.itemEnd( url );\r\n\r\n        };\r\n\r\n        var loader = new THREE.FileLoader( scope.manager );\r\n\r\n        loader.setPath( this.path );\r\n        loader.setResponseType( 'arraybuffer' );\r\n\r\n        loader.load( url, function ( data ) {\r\n\r\n            try {\r\n\r\n                scope.parse( data, resourcePath, function ( gltf ) {\r\n\r\n                    onLoad( gltf );\r\n\r\n                    scope.manager.itemEnd( url );\r\n\r\n                }, _onError );\r\n\r\n            } catch ( e ) {\r\n\r\n                _onError( e );\r\n\r\n            }\r\n\r\n        }, onProgress, _onError );\r\n\r\n    }\r\n\r\n    setCrossOrigin ( value ) {\r\n\r\n        this.crossOrigin = value;\r\n        return this;\r\n\r\n    }\r\n\r\n    setPath ( value ) {\r\n\r\n        this.path = value;\r\n        return this;\r\n\r\n    }\r\n\r\n    setResourcePath ( value ) {\r\n\r\n        this.resourcePath = value;\r\n        return this;\r\n\r\n    }\r\n\r\n    setDRACOLoader ( dracoLoader ) {\r\n\r\n        this.dracoLoader = dracoLoader;\r\n        return this;\r\n\r\n    }\r\n\r\n    parse ( data, path, onLoad, onError ) {\r\n\r\n        var content;\r\n        var extensions = {};\r\n\r\n        if ( typeof data === 'string' ) {\r\n\r\n            content = data;\r\n\r\n        } else {\r\n\r\n            var magic = THREE.LoaderUtils.decodeText( new Uint8Array( data, 0, 4 ) );\r\n\r\n            if ( magic === BINARY_EXTENSION_HEADER_MAGIC ) {\r\n\r\n                try {\r\n\r\n                    extensions[ EXTENSIONS.KHR_BINARY_GLTF ] = new GLTFBinaryExtension( data );\r\n\r\n                } catch ( error ) {\r\n\r\n                    if ( onError ) onError( error );\r\n                    return;\r\n\r\n                }\r\n\r\n                content = extensions[ EXTENSIONS.KHR_BINARY_GLTF ].content;\r\n\r\n            } else {\r\n\r\n                content = THREE.LoaderUtils.decodeText( new Uint8Array( data ) );\r\n\r\n            }\r\n\r\n        }\r\n\r\n        var json = JSON.parse( content );\r\n\r\n        if ( json.asset === undefined || json.asset.version[ 0 ] < 2 ) {\r\n\r\n            if ( onError ) onError( new Error( 'THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported. Use LegacyGLTFLoader instead.' ) );\r\n            return;\r\n\r\n        }\r\n\r\n        if ( json.extensionsUsed ) {\r\n\r\n            for ( var i = 0; i < json.extensionsUsed.length; ++ i ) {\r\n\r\n                var extensionName = json.extensionsUsed[ i ];\r\n                var extensionsRequired = json.extensionsRequired || [];\r\n\r\n                switch ( extensionName ) {\r\n\r\n                    case EXTENSIONS.KHR_LIGHTS_PUNCTUAL:\r\n                        extensions[ extensionName ] = new GLTFLightsExtension( json );\r\n                        break;\r\n\r\n                    case EXTENSIONS.KHR_MATERIALS_UNLIT:\r\n                        extensions[ extensionName ] = new GLTFMaterialsUnlitExtension( json );\r\n                        break;\r\n\r\n                    case EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:\r\n                        extensions[ extensionName ] = new GLTFMaterialsPbrSpecularGlossinessExtension( json );\r\n                        break;\r\n\r\n                    case EXTENSIONS.KHR_DRACO_MESH_COMPRESSION:\r\n                        extensions[ extensionName ] = new GLTFDracoMeshCompressionExtension( json, this.dracoLoader );\r\n                        break;\r\n\r\n                    case EXTENSIONS.MSFT_TEXTURE_DDS:\r\n                        extensions[ EXTENSIONS.MSFT_TEXTURE_DDS ] = new GLTFTextureDDSExtension();\r\n                        break;\r\n\r\n                    case EXTENSIONS.KHR_TEXTURE_TRANSFORM:\r\n                        extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ] = new GLTFTextureTransformExtension( json );\r\n                        break;\r\n\r\n                    default:\r\n\r\n                        if ( extensionsRequired.indexOf( extensionName ) >= 0 ) {\r\n\r\n                            console.warn( 'THREE.GLTFLoader: Unknown extension \"' + extensionName + '\".' );\r\n\r\n                        }\r\n\r\n                }\r\n\r\n            }\r\n\r\n        }\r\n\r\n        var parser = new GLTFParser( json, extensions, {\r\n\r\n            path: path || this.resourcePath || '',\r\n            crossOrigin: this.crossOrigin,\r\n            manager: this.manager\r\n\r\n        } );\r\n\r\n        parser.parse( function ( scene, scenes, cameras, animations, json ) {\r\n\r\n            var glTF = {\r\n                scene: scene,\r\n                scenes: scenes,\r\n                cameras: cameras,\r\n                animations: animations,\r\n                asset: json.asset,\r\n                parser: parser,\r\n                userData: {}\r\n            };\r\n\r\n            addUnknownExtensionsToUserData( extensions, glTF, json );\r\n\r\n            onLoad( glTF );\r\n\r\n        }, onError );\r\n\r\n    }\r\n\r\n};\r\n\r\n/* GLTFREGISTRY */\r\n\r\nclass GLTFRegistry {\r\n    constructor() {\r\n        this.objects = {};\r\n    }\r\n\r\n    get ( key ) {\r\n\r\n        return this.objects[ key ];\r\n\r\n    }\r\n\r\n    add ( key, object ) {\r\n\r\n        this.objects[ key ] = object;\r\n\r\n    }\r\n\r\n    remove ( key ) {\r\n\r\n        delete this.objects[ key ];\r\n\r\n    }\r\n\r\n    removeAll () {\r\n\r\n        this.objects = {};\r\n\r\n    }\r\n}\r\n\r\n/*********************************/\r\n/********** EXTENSIONS ***********/\r\n/*********************************/\r\n\r\nvar EXTENSIONS = {\r\n    KHR_BINARY_GLTF: 'KHR_binary_glTF',\r\n    KHR_DRACO_MESH_COMPRESSION: 'KHR_draco_mesh_compression',\r\n    KHR_LIGHTS_PUNCTUAL: 'KHR_lights_punctual',\r\n    KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS: 'KHR_materials_pbrSpecularGlossiness',\r\n    KHR_MATERIALS_UNLIT: 'KHR_materials_unlit',\r\n    KHR_TEXTURE_TRANSFORM: 'KHR_texture_transform',\r\n    MSFT_TEXTURE_DDS: 'MSFT_texture_dds'\r\n};\r\n\r\n/**\r\n * DDS Texture Extension\r\n *\r\n * Specification:\r\n * https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/MSFT_texture_dds\r\n *\r\n */\r\nfunction GLTFTextureDDSExtension() {\r\n\r\n    if ( ! THREE.DDSLoader ) {\r\n\r\n        throw new Error( 'THREE.GLTFLoader: Attempting to load .dds texture without importing THREE.DDSLoader' );\r\n\r\n    }\r\n\r\n    this.name = EXTENSIONS.MSFT_TEXTURE_DDS;\r\n    this.ddsLoader = new THREE.DDSLoader();\r\n\r\n}\r\n\r\n/**\r\n * Lights Extension\r\n *\r\n * Specification: PENDING\r\n */\r\nfunction GLTFLightsExtension( json ) {\r\n\r\n    this.name = EXTENSIONS.KHR_LIGHTS_PUNCTUAL;\r\n\r\n    var extension = ( json.extensions && json.extensions[ EXTENSIONS.KHR_LIGHTS_PUNCTUAL ] ) || {};\r\n    this.lightDefs = extension.lights || [];\r\n\r\n}\r\n\r\nGLTFLightsExtension.prototype.loadLight = function ( lightIndex ) {\r\n\r\n    var lightDef = this.lightDefs[ lightIndex ];\r\n    var lightNode;\r\n\r\n    var color = new THREE.Color( 0xffffff );\r\n    if ( lightDef.color !== undefined ) color.fromArray( lightDef.color );\r\n\r\n    var range = lightDef.range !== undefined ? lightDef.range : 0;\r\n\r\n    switch ( lightDef.type ) {\r\n\r\n        case 'directional':\r\n            lightNode = new THREE.DirectionalLight( color );\r\n            lightNode.target.position.set( 0, 0, - 1 );\r\n            lightNode.add( lightNode.target );\r\n            break;\r\n\r\n        case 'point':\r\n            lightNode = new THREE.PointLight( color );\r\n            lightNode.distance = range;\r\n            break;\r\n\r\n        case 'spot':\r\n            lightNode = new THREE.SpotLight( color );\r\n            lightNode.distance = range;\r\n            // Handle spotlight properties.\r\n            lightDef.spot = lightDef.spot || {};\r\n            lightDef.spot.innerConeAngle = lightDef.spot.innerConeAngle !== undefined ? lightDef.spot.innerConeAngle : 0;\r\n            lightDef.spot.outerConeAngle = lightDef.spot.outerConeAngle !== undefined ? lightDef.spot.outerConeAngle : Math.PI / 4.0;\r\n            lightNode.angle = lightDef.spot.outerConeAngle;\r\n            lightNode.penumbra = 1.0 - lightDef.spot.innerConeAngle / lightDef.spot.outerConeAngle;\r\n            lightNode.target.position.set( 0, 0, - 1 );\r\n            lightNode.add( lightNode.target );\r\n            break;\r\n\r\n        default:\r\n            throw new Error( 'THREE.GLTFLoader: Unexpected light type, \"' + lightDef.type + '\".' );\r\n\r\n    }\r\n\r\n    // Some lights (e.g. spot) default to a position other than the origin. Reset the position\r\n    // here, because node-level parsing will only override position if explicitly specified.\r\n    lightNode.position.set( 0, 0, 0 );\r\n\r\n    lightNode.decay = 2;\r\n\r\n    if ( lightDef.intensity !== undefined ) lightNode.intensity = lightDef.intensity;\r\n\r\n    lightNode.name = lightDef.name || ( 'light_' + lightIndex );\r\n\r\n    return Promise.resolve( lightNode );\r\n\r\n};\r\n\r\n/**\r\n * Unlit Materials Extension (pending)\r\n *\r\n * PR: https://github.com/KhronosGroup/glTF/pull/1163\r\n */\r\nfunction GLTFMaterialsUnlitExtension( json ) {\r\n\r\n    this.name = EXTENSIONS.KHR_MATERIALS_UNLIT;\r\n\r\n}\r\n\r\nGLTFMaterialsUnlitExtension.prototype.getMaterialType = function ( material ) {\r\n\r\n    return THREE.MeshBasicMaterial;\r\n\r\n};\r\n\r\nGLTFMaterialsUnlitExtension.prototype.extendParams = function ( materialParams, material, parser ) {\r\n\r\n    var pending = [];\r\n\r\n    materialParams.color = new THREE.Color( 1.0, 1.0, 1.0 );\r\n    materialParams.opacity = 1.0;\r\n\r\n    var metallicRoughness = material.pbrMetallicRoughness;\r\n\r\n    if ( metallicRoughness ) {\r\n\r\n        if ( Array.isArray( metallicRoughness.baseColorFactor ) ) {\r\n\r\n            var array = metallicRoughness.baseColorFactor;\r\n\r\n            materialParams.color.fromArray( array );\r\n            materialParams.opacity = array[ 3 ];\r\n\r\n        }\r\n\r\n        if ( metallicRoughness.baseColorTexture !== undefined ) {\r\n\r\n            pending.push( parser.assignTexture( materialParams, 'map', metallicRoughness.baseColorTexture ) );\r\n\r\n        }\r\n\r\n    }\r\n\r\n    return Promise.all( pending );\r\n\r\n};\r\n\r\n/* BINARY EXTENSION */\r\n\r\nvar BINARY_EXTENSION_BUFFER_NAME = 'binary_glTF';\r\nvar BINARY_EXTENSION_HEADER_MAGIC = 'glTF';\r\nvar BINARY_EXTENSION_HEADER_LENGTH = 12;\r\nvar BINARY_EXTENSION_CHUNK_TYPES = { JSON: 0x4E4F534A, BIN: 0x004E4942 };\r\n\r\nfunction GLTFBinaryExtension( data ) {\r\n\r\n    this.name = EXTENSIONS.KHR_BINARY_GLTF;\r\n    this.content = null;\r\n    this.body = null;\r\n\r\n    var headerView = new DataView( data, 0, BINARY_EXTENSION_HEADER_LENGTH );\r\n\r\n    this.header = {\r\n        magic: THREE.LoaderUtils.decodeText( new Uint8Array( data.slice( 0, 4 ) ) ),\r\n        version: headerView.getUint32( 4, true ),\r\n        length: headerView.getUint32( 8, true )\r\n    };\r\n\r\n    if ( this.header.magic !== BINARY_EXTENSION_HEADER_MAGIC ) {\r\n\r\n        throw new Error( 'THREE.GLTFLoader: Unsupported glTF-Binary header.' );\r\n\r\n    } else if ( this.header.version < 2.0 ) {\r\n\r\n        throw new Error( 'THREE.GLTFLoader: Legacy binary file detected. Use LegacyGLTFLoader instead.' );\r\n\r\n    }\r\n\r\n    var chunkView = new DataView( data, BINARY_EXTENSION_HEADER_LENGTH );\r\n    var chunkIndex = 0;\r\n\r\n    while ( chunkIndex < chunkView.byteLength ) {\r\n\r\n        var chunkLength = chunkView.getUint32( chunkIndex, true );\r\n        chunkIndex += 4;\r\n\r\n        var chunkType = chunkView.getUint32( chunkIndex, true );\r\n        chunkIndex += 4;\r\n\r\n        if ( chunkType === BINARY_EXTENSION_CHUNK_TYPES.JSON ) {\r\n\r\n            var contentArray = new Uint8Array( data, BINARY_EXTENSION_HEADER_LENGTH + chunkIndex, chunkLength );\r\n            this.content = THREE.LoaderUtils.decodeText( contentArray );\r\n\r\n        } else if ( chunkType === BINARY_EXTENSION_CHUNK_TYPES.BIN ) {\r\n\r\n            var byteOffset = BINARY_EXTENSION_HEADER_LENGTH + chunkIndex;\r\n            this.body = data.slice( byteOffset, byteOffset + chunkLength );\r\n\r\n        }\r\n\r\n        // Clients must ignore chunks with unknown types.\r\n\r\n        chunkIndex += chunkLength;\r\n\r\n    }\r\n\r\n    if ( this.content === null ) {\r\n\r\n        throw new Error( 'THREE.GLTFLoader: JSON content not found.' );\r\n\r\n    }\r\n\r\n}\r\n\r\n/**\r\n * DRACO Mesh Compression Extension\r\n *\r\n * Specification: https://github.com/KhronosGroup/glTF/pull/874\r\n */\r\nfunction GLTFDracoMeshCompressionExtension( json, dracoLoader ) {\r\n\r\n    if ( ! dracoLoader ) {\r\n\r\n        throw new Error( 'THREE.GLTFLoader: No DRACOLoader instance provided.' );\r\n\r\n    }\r\n\r\n    this.name = EXTENSIONS.KHR_DRACO_MESH_COMPRESSION;\r\n    this.json = json;\r\n    this.dracoLoader = dracoLoader;\r\n    THREE.DRACOLoader.getDecoderModule();\r\n\r\n}\r\n\r\nGLTFDracoMeshCompressionExtension.prototype.decodePrimitive = function ( primitive, parser ) {\r\n\r\n    var json = this.json;\r\n    var dracoLoader = this.dracoLoader;\r\n    var bufferViewIndex = primitive.extensions[ this.name ].bufferView;\r\n    var gltfAttributeMap = primitive.extensions[ this.name ].attributes;\r\n    var threeAttributeMap = {};\r\n    var attributeNormalizedMap = {};\r\n    var attributeTypeMap = {};\r\n\r\n    for ( var attributeName in gltfAttributeMap ) {\r\n\r\n        if ( ! ( attributeName in ATTRIBUTES ) ) continue;\r\n\r\n        threeAttributeMap[ ATTRIBUTES[ attributeName ] ] = gltfAttributeMap[ attributeName ];\r\n\r\n    }\r\n\r\n    for ( attributeName in primitive.attributes ) {\r\n\r\n        if ( ATTRIBUTES[ attributeName ] !== undefined && gltfAttributeMap[ attributeName ] !== undefined ) {\r\n\r\n            var accessorDef = json.accessors[ primitive.attributes[ attributeName ] ];\r\n            var componentType = WEBGL_COMPONENT_TYPES[ accessorDef.componentType ];\r\n\r\n            attributeTypeMap[ ATTRIBUTES[ attributeName ] ] = componentType;\r\n            attributeNormalizedMap[ ATTRIBUTES[ attributeName ] ] = accessorDef.normalized === true;\r\n\r\n        }\r\n\r\n    }\r\n\r\n    return parser.getDependency( 'bufferView', bufferViewIndex ).then( function ( bufferView ) {\r\n\r\n        return new Promise( function ( resolve ) {\r\n\r\n            dracoLoader.decodeDracoFile( bufferView, function ( geometry ) {\r\n\r\n                for ( var attributeName in geometry.attributes ) {\r\n\r\n                    var attribute = geometry.attributes[ attributeName ];\r\n                    var normalized = attributeNormalizedMap[ attributeName ];\r\n\r\n                    if ( normalized !== undefined ) attribute.normalized = normalized;\r\n\r\n                }\r\n\r\n                resolve( geometry );\r\n\r\n            }, threeAttributeMap, attributeTypeMap );\r\n\r\n        } );\r\n\r\n    } );\r\n\r\n};\r\n\r\n/**\r\n * Texture Transform Extension\r\n *\r\n * Specification:\r\n */\r\nfunction GLTFTextureTransformExtension( json ) {\r\n\r\n    this.name = EXTENSIONS.KHR_TEXTURE_TRANSFORM;\r\n\r\n}\r\n\r\nGLTFTextureTransformExtension.prototype.extendTexture = function ( texture, transform ) {\r\n\r\n    texture = texture.clone();\r\n\r\n    if ( transform.offset !== undefined ) {\r\n\r\n        texture.offset.fromArray( transform.offset );\r\n\r\n    }\r\n\r\n    if ( transform.rotation !== undefined ) {\r\n\r\n        texture.rotation = transform.rotation;\r\n\r\n    }\r\n\r\n    if ( transform.scale !== undefined ) {\r\n\r\n        texture.repeat.fromArray( transform.scale );\r\n\r\n    }\r\n\r\n    if ( transform.texCoord !== undefined ) {\r\n\r\n        console.warn( 'THREE.GLTFLoader: Custom UV sets in \"' + this.name + '\" extension not yet supported.' );\r\n\r\n    }\r\n\r\n    texture.needsUpdate = true;\r\n\r\n    return texture;\r\n\r\n};\r\n\r\n/**\r\n * Specular-Glossiness Extension\r\n *\r\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_pbrSpecularGlossiness\r\n */\r\nfunction GLTFMaterialsPbrSpecularGlossinessExtension() {\r\n\r\n    return {\r\n\r\n        name: EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,\r\n\r\n        specularGlossinessParams: [\r\n            'color',\r\n            'map',\r\n            'lightMap',\r\n            'lightMapIntensity',\r\n            'aoMap',\r\n            'aoMapIntensity',\r\n            'emissive',\r\n            'emissiveIntensity',\r\n            'emissiveMap',\r\n            'bumpMap',\r\n            'bumpScale',\r\n            'normalMap',\r\n            'displacementMap',\r\n            'displacementScale',\r\n            'displacementBias',\r\n            'specularMap',\r\n            'specular',\r\n            'glossinessMap',\r\n            'glossiness',\r\n            'alphaMap',\r\n            'envMap',\r\n            'envMapIntensity',\r\n            'refractionRatio',\r\n        ],\r\n\r\n        getMaterialType: function () {\r\n\r\n            return THREE.ShaderMaterial;\r\n\r\n        },\r\n\r\n        extendParams: function ( params, material, parser ) {\r\n\r\n            var pbrSpecularGlossiness = material.extensions[ this.name ];\r\n\r\n            var shader = THREE.ShaderLib[ 'standard' ];\r\n\r\n            var uniforms = THREE.UniformsUtils.clone( shader.uniforms );\r\n\r\n            var specularMapParsFragmentChunk = [\r\n                '#ifdef USE_SPECULARMAP',\r\n                '\tuniform sampler2D specularMap;',\r\n                '#endif'\r\n            ].join( '\\n' );\r\n\r\n            var glossinessMapParsFragmentChunk = [\r\n                '#ifdef USE_GLOSSINESSMAP',\r\n                '\tuniform sampler2D glossinessMap;',\r\n                '#endif'\r\n            ].join( '\\n' );\r\n\r\n            var specularMapFragmentChunk = [\r\n                'vec3 specularFactor = specular;',\r\n                '#ifdef USE_SPECULARMAP',\r\n                '\tvec4 texelSpecular = texture2D( specularMap, vUv );',\r\n                '\ttexelSpecular = sRGBToLinear( texelSpecular );',\r\n                '\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture',\r\n                '\tspecularFactor *= texelSpecular.rgb;',\r\n                '#endif'\r\n            ].join( '\\n' );\r\n\r\n            var glossinessMapFragmentChunk = [\r\n                'float glossinessFactor = glossiness;',\r\n                '#ifdef USE_GLOSSINESSMAP',\r\n                '\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );',\r\n                '\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture',\r\n                '\tglossinessFactor *= texelGlossiness.a;',\r\n                '#endif'\r\n            ].join( '\\n' );\r\n\r\n            var lightPhysicalFragmentChunk = [\r\n                'PhysicalMaterial material;',\r\n                'material.diffuseColor = diffuseColor.rgb;',\r\n                'material.specularRoughness = clamp( 1.0 - glossinessFactor, 0.04, 1.0 );',\r\n                'material.specularColor = specularFactor.rgb;',\r\n            ].join( '\\n' );\r\n\r\n            var fragmentShader = shader.fragmentShader\r\n                .replace( 'uniform float roughness;', 'uniform vec3 specular;' )\r\n                .replace( 'uniform float metalness;', 'uniform float glossiness;' )\r\n                .replace( '#include <roughnessmap_pars_fragment>', specularMapParsFragmentChunk )\r\n                .replace( '#include <metalnessmap_pars_fragment>', glossinessMapParsFragmentChunk )\r\n                .replace( '#include <roughnessmap_fragment>', specularMapFragmentChunk )\r\n                .replace( '#include <metalnessmap_fragment>', glossinessMapFragmentChunk )\r\n                .replace( '#include <lights_physical_fragment>', lightPhysicalFragmentChunk );\r\n\r\n            delete uniforms.roughness;\r\n            delete uniforms.metalness;\r\n            delete uniforms.roughnessMap;\r\n            delete uniforms.metalnessMap;\r\n\r\n            uniforms.specular = { value: new THREE.Color().setHex( 0x111111 ) };\r\n            uniforms.glossiness = { value: 0.5 };\r\n            uniforms.specularMap = { value: null };\r\n            uniforms.glossinessMap = { value: null };\r\n\r\n            params.vertexShader = shader.vertexShader;\r\n            params.fragmentShader = fragmentShader;\r\n            params.uniforms = uniforms;\r\n            params.defines = { 'STANDARD': '' };\r\n\r\n            params.color = new THREE.Color( 1.0, 1.0, 1.0 );\r\n            params.opacity = 1.0;\r\n\r\n            var pending = [];\r\n\r\n            if ( Array.isArray( pbrSpecularGlossiness.diffuseFactor ) ) {\r\n\r\n                var array = pbrSpecularGlossiness.diffuseFactor;\r\n\r\n                params.color.fromArray( array );\r\n                params.opacity = array[ 3 ];\r\n\r\n            }\r\n\r\n            if ( pbrSpecularGlossiness.diffuseTexture !== undefined ) {\r\n\r\n                pending.push( parser.assignTexture( params, 'map', pbrSpecularGlossiness.diffuseTexture ) );\r\n\r\n            }\r\n\r\n            params.emissive = new THREE.Color( 0.0, 0.0, 0.0 );\r\n            params.glossiness = pbrSpecularGlossiness.glossinessFactor !== undefined ? pbrSpecularGlossiness.glossinessFactor : 1.0;\r\n            params.specular = new THREE.Color( 1.0, 1.0, 1.0 );\r\n\r\n            if ( Array.isArray( pbrSpecularGlossiness.specularFactor ) ) {\r\n\r\n                params.specular.fromArray( pbrSpecularGlossiness.specularFactor );\r\n\r\n            }\r\n\r\n            if ( pbrSpecularGlossiness.specularGlossinessTexture !== undefined ) {\r\n\r\n                var specGlossMapDef = pbrSpecularGlossiness.specularGlossinessTexture;\r\n                pending.push( parser.assignTexture( params, 'glossinessMap', specGlossMapDef ) );\r\n                pending.push( parser.assignTexture( params, 'specularMap', specGlossMapDef ) );\r\n\r\n            }\r\n\r\n            return Promise.all( pending );\r\n\r\n        },\r\n\r\n        createMaterial: function ( params ) {\r\n\r\n            // setup material properties based on MeshStandardMaterial for Specular-Glossiness\r\n\r\n            var material = new THREE.ShaderMaterial( {\r\n                defines: params.defines,\r\n                vertexShader: params.vertexShader,\r\n                fragmentShader: params.fragmentShader,\r\n                uniforms: params.uniforms,\r\n                fog: true,\r\n                lights: true,\r\n                opacity: params.opacity,\r\n                transparent: params.transparent\r\n            } );\r\n\r\n            material.isGLTFSpecularGlossinessMaterial = true;\r\n\r\n            material.color = params.color;\r\n\r\n            material.map = params.map === undefined ? null : params.map;\r\n\r\n            material.lightMap = null;\r\n            material.lightMapIntensity = 1.0;\r\n\r\n            material.aoMap = params.aoMap === undefined ? null : params.aoMap;\r\n            material.aoMapIntensity = 1.0;\r\n\r\n            material.emissive = params.emissive;\r\n            material.emissiveIntensity = 1.0;\r\n            material.emissiveMap = params.emissiveMap === undefined ? null : params.emissiveMap;\r\n\r\n            material.bumpMap = params.bumpMap === undefined ? null : params.bumpMap;\r\n            material.bumpScale = 1;\r\n\r\n            material.normalMap = params.normalMap === undefined ? null : params.normalMap;\r\n            if ( params.normalScale ) material.normalScale = params.normalScale;\r\n\r\n            material.displacementMap = null;\r\n            material.displacementScale = 1;\r\n            material.displacementBias = 0;\r\n\r\n            material.specularMap = params.specularMap === undefined ? null : params.specularMap;\r\n            material.specular = params.specular;\r\n\r\n            material.glossinessMap = params.glossinessMap === undefined ? null : params.glossinessMap;\r\n            material.glossiness = params.glossiness;\r\n\r\n            material.alphaMap = null;\r\n\r\n            material.envMap = params.envMap === undefined ? null : params.envMap;\r\n            material.envMapIntensity = 1.0;\r\n\r\n            material.refractionRatio = 0.98;\r\n\r\n            material.extensions.derivatives = true;\r\n\r\n            return material;\r\n\r\n        },\r\n\r\n        /**\r\n         * Clones a GLTFSpecularGlossinessMaterial instance. The ShaderMaterial.copy() method can\r\n         * copy only properties it knows about or inherits, and misses many properties that would\r\n         * normally be defined by MeshStandardMaterial.\r\n         *\r\n         * This method allows GLTFSpecularGlossinessMaterials to be cloned in the process of\r\n         * loading a glTF model, but cloning later (e.g. by the user) would require these changes\r\n         * AND also updating `.onBeforeRender` on the parent mesh.\r\n         *\r\n         * @param  {THREE.ShaderMaterial} source\r\n         * @return {THREE.ShaderMaterial}\r\n         */\r\n        cloneMaterial: function ( source ) {\r\n\r\n            var target = source.clone();\r\n\r\n            target.isGLTFSpecularGlossinessMaterial = true;\r\n\r\n            var params = this.specularGlossinessParams;\r\n\r\n            for ( var i = 0, il = params.length; i < il; i ++ ) {\r\n\r\n                target[ params[ i ] ] = source[ params[ i ] ];\r\n\r\n            }\r\n\r\n            return target;\r\n\r\n        },\r\n\r\n        // Here's based on refreshUniformsCommon() and refreshUniformsStandard() in WebGLRenderer.\r\n        refreshUniforms: function ( renderer, scene, camera, geometry, material, group ) {\r\n\r\n            if ( material.isGLTFSpecularGlossinessMaterial !== true ) {\r\n\r\n                return;\r\n\r\n            }\r\n\r\n            var uniforms = material.uniforms;\r\n            var defines = material.defines;\r\n\r\n            uniforms.opacity.value = material.opacity;\r\n\r\n            uniforms.diffuse.value.copy( material.color );\r\n            uniforms.emissive.value.copy( material.emissive ).multiplyScalar( material.emissiveIntensity );\r\n\r\n            uniforms.map.value = material.map;\r\n            uniforms.specularMap.value = material.specularMap;\r\n            uniforms.alphaMap.value = material.alphaMap;\r\n\r\n            uniforms.lightMap.value = material.lightMap;\r\n            uniforms.lightMapIntensity.value = material.lightMapIntensity;\r\n\r\n            uniforms.aoMap.value = material.aoMap;\r\n            uniforms.aoMapIntensity.value = material.aoMapIntensity;\r\n\r\n            // uv repeat and offset setting priorities\r\n            // 1. color map\r\n            // 2. specular map\r\n            // 3. normal map\r\n            // 4. bump map\r\n            // 5. alpha map\r\n            // 6. emissive map\r\n\r\n            var uvScaleMap;\r\n\r\n            if ( material.map ) {\r\n\r\n                uvScaleMap = material.map;\r\n\r\n            } else if ( material.specularMap ) {\r\n\r\n                uvScaleMap = material.specularMap;\r\n\r\n            } else if ( material.displacementMap ) {\r\n\r\n                uvScaleMap = material.displacementMap;\r\n\r\n            } else if ( material.normalMap ) {\r\n\r\n                uvScaleMap = material.normalMap;\r\n\r\n            } else if ( material.bumpMap ) {\r\n\r\n                uvScaleMap = material.bumpMap;\r\n\r\n            } else if ( material.glossinessMap ) {\r\n\r\n                uvScaleMap = material.glossinessMap;\r\n\r\n            } else if ( material.alphaMap ) {\r\n\r\n                uvScaleMap = material.alphaMap;\r\n\r\n            } else if ( material.emissiveMap ) {\r\n\r\n                uvScaleMap = material.emissiveMap;\r\n\r\n            }\r\n\r\n            if ( uvScaleMap !== undefined ) {\r\n\r\n                // backwards compatibility\r\n                if ( uvScaleMap.isWebGLRenderTarget ) {\r\n\r\n                    uvScaleMap = uvScaleMap.texture;\r\n\r\n                }\r\n\r\n                if ( uvScaleMap.matrixAutoUpdate === true ) {\r\n\r\n                    uvScaleMap.updateMatrix();\r\n\r\n                }\r\n\r\n                uniforms.uvTransform.value.copy( uvScaleMap.matrix );\r\n\r\n            }\r\n\r\n            if ( material.envMap ) {\r\n\r\n                uniforms.envMap.value = material.envMap;\r\n                uniforms.envMapIntensity.value = material.envMapIntensity;\r\n\r\n                // don't flip CubeTexture envMaps, flip everything else:\r\n                //  WebGLRenderTargetCube will be flipped for backwards compatibility\r\n                //  WebGLRenderTargetCube.texture will be flipped because it's a Texture and NOT a CubeTexture\r\n                // this check must be handled differently, or removed entirely, if WebGLRenderTargetCube uses a CubeTexture in the future\r\n                uniforms.flipEnvMap.value = material.envMap.isCubeTexture ? - 1 : 1;\r\n\r\n                uniforms.reflectivity.value = material.reflectivity;\r\n                uniforms.refractionRatio.value = material.refractionRatio;\r\n\r\n                uniforms.maxMipLevel.value = renderer.properties.get( material.envMap ).__maxMipLevel;\r\n\r\n            }\r\n\r\n            uniforms.specular.value.copy( material.specular );\r\n            uniforms.glossiness.value = material.glossiness;\r\n\r\n            uniforms.glossinessMap.value = material.glossinessMap;\r\n\r\n            uniforms.emissiveMap.value = material.emissiveMap;\r\n            uniforms.bumpMap.value = material.bumpMap;\r\n            uniforms.normalMap.value = material.normalMap;\r\n\r\n            uniforms.displacementMap.value = material.displacementMap;\r\n            uniforms.displacementScale.value = material.displacementScale;\r\n            uniforms.displacementBias.value = material.displacementBias;\r\n\r\n            if ( uniforms.glossinessMap.value !== null && defines.USE_GLOSSINESSMAP === undefined ) {\r\n\r\n                defines.USE_GLOSSINESSMAP = '';\r\n                // set USE_ROUGHNESSMAP to enable vUv\r\n                defines.USE_ROUGHNESSMAP = '';\r\n\r\n            }\r\n\r\n            if ( uniforms.glossinessMap.value === null && defines.USE_GLOSSINESSMAP !== undefined ) {\r\n\r\n                delete defines.USE_GLOSSINESSMAP;\r\n                delete defines.USE_ROUGHNESSMAP;\r\n\r\n            }\r\n\r\n        }\r\n\r\n    };\r\n\r\n}\r\n\r\n/*********************************/\r\n/********** INTERPOLATION ********/\r\n/*********************************/\r\n\r\n// Spline Interpolation\r\n// Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#appendix-c-spline-interpolation\r\nfunction GLTFCubicSplineInterpolant( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\r\n\r\n    THREE.Interpolant.call( this, parameterPositions, sampleValues, sampleSize, resultBuffer );\r\n\r\n}\r\n\r\nGLTFCubicSplineInterpolant.prototype = Object.create( THREE.Interpolant.prototype );\r\nGLTFCubicSplineInterpolant.prototype.constructor = GLTFCubicSplineInterpolant;\r\n\r\nGLTFCubicSplineInterpolant.prototype.copySampleValue_ = function ( index ) {\r\n\r\n    // Copies a sample value to the result buffer. See description of glTF\r\n    // CUBICSPLINE values layout in interpolate_() function below.\r\n\r\n    var result = this.resultBuffer,\r\n        values = this.sampleValues,\r\n        valueSize = this.valueSize,\r\n        offset = index * valueSize * 3 + valueSize;\r\n\r\n    for ( var i = 0; i !== valueSize; i ++ ) {\r\n\r\n        result[ i ] = values[ offset + i ];\r\n\r\n    }\r\n\r\n    return result;\r\n\r\n};\r\n\r\nGLTFCubicSplineInterpolant.prototype.beforeStart_ = GLTFCubicSplineInterpolant.prototype.copySampleValue_;\r\n\r\nGLTFCubicSplineInterpolant.prototype.afterEnd_ = GLTFCubicSplineInterpolant.prototype.copySampleValue_;\r\n\r\nGLTFCubicSplineInterpolant.prototype.interpolate_ = function ( i1, t0, t, t1 ) {\r\n\r\n    var result = this.resultBuffer;\r\n    var values = this.sampleValues;\r\n    var stride = this.valueSize;\r\n\r\n    var stride2 = stride * 2;\r\n    var stride3 = stride * 3;\r\n\r\n    var td = t1 - t0;\r\n\r\n    var p = ( t - t0 ) / td;\r\n    var pp = p * p;\r\n    var ppp = pp * p;\r\n\r\n    var offset1 = i1 * stride3;\r\n    var offset0 = offset1 - stride3;\r\n\r\n    var s2 = - 2 * ppp + 3 * pp;\r\n    var s3 = ppp - pp;\r\n    var s0 = 1 - s2;\r\n    var s1 = s3 - pp + p;\r\n\r\n    // Layout of keyframe output values for CUBICSPLINE animations:\r\n    //   [ inTangent_1, splineVertex_1, outTangent_1, inTangent_2, splineVertex_2, ... ]\r\n    for ( var i = 0; i !== stride; i ++ ) {\r\n\r\n        var p0 = values[ offset0 + i + stride ]; // splineVertex_k\r\n        var m0 = values[ offset0 + i + stride2 ] * td; // outTangent_k * (t_k+1 - t_k)\r\n        var p1 = values[ offset1 + i + stride ]; // splineVertex_k+1\r\n        var m1 = values[ offset1 + i ] * td; // inTangent_k+1 * (t_k+1 - t_k)\r\n\r\n        result[ i ] = s0 * p0 + s1 * m0 + s2 * p1 + s3 * m1;\r\n\r\n    }\r\n\r\n    return result;\r\n\r\n};\r\n\r\n/*********************************/\r\n/********** INTERNALS ************/\r\n/*********************************/\r\n\r\n/* CONSTANTS */\r\n\r\nvar WEBGL_CONSTANTS = {\r\n    FLOAT: 5126,\r\n    //FLOAT_MAT2: 35674,\r\n    FLOAT_MAT3: 35675,\r\n    FLOAT_MAT4: 35676,\r\n    FLOAT_VEC2: 35664,\r\n    FLOAT_VEC3: 35665,\r\n    FLOAT_VEC4: 35666,\r\n    LINEAR: 9729,\r\n    REPEAT: 10497,\r\n    SAMPLER_2D: 35678,\r\n    POINTS: 0,\r\n    LINES: 1,\r\n    LINE_LOOP: 2,\r\n    LINE_STRIP: 3,\r\n    TRIANGLES: 4,\r\n    TRIANGLE_STRIP: 5,\r\n    TRIANGLE_FAN: 6,\r\n    UNSIGNED_BYTE: 5121,\r\n    UNSIGNED_SHORT: 5123\r\n};\r\n\r\nvar WEBGL_TYPE = {\r\n    5126: Number,\r\n    //35674: THREE.Matrix2,\r\n    35675: THREE.Matrix3,\r\n    35676: THREE.Matrix4,\r\n    35664: THREE.Vector2,\r\n    35665: THREE.Vector3,\r\n    35666: THREE.Vector4,\r\n    35678: THREE.Texture\r\n};\r\n\r\nvar WEBGL_COMPONENT_TYPES = {\r\n    5120: Int8Array,\r\n    5121: Uint8Array,\r\n    5122: Int16Array,\r\n    5123: Uint16Array,\r\n    5125: Uint32Array,\r\n    5126: Float32Array\r\n};\r\n\r\nvar WEBGL_FILTERS = {\r\n    9728: THREE.NearestFilter,\r\n    9729: THREE.LinearFilter,\r\n    9984: THREE.NearestMipMapNearestFilter,\r\n    9985: THREE.LinearMipMapNearestFilter,\r\n    9986: THREE.NearestMipMapLinearFilter,\r\n    9987: THREE.LinearMipMapLinearFilter\r\n};\r\n\r\nvar WEBGL_WRAPPINGS = {\r\n    33071: THREE.ClampToEdgeWrapping,\r\n    33648: THREE.MirroredRepeatWrapping,\r\n    10497: THREE.RepeatWrapping\r\n};\r\n\r\nvar WEBGL_SIDES = {\r\n    1028: THREE.BackSide, // Culling front\r\n    1029: THREE.FrontSide // Culling back\r\n    //1032: THREE.NoSide   // Culling front and back, what to do?\r\n};\r\n\r\nvar WEBGL_DEPTH_FUNCS = {\r\n    512: THREE.NeverDepth,\r\n    513: THREE.LessDepth,\r\n    514: THREE.EqualDepth,\r\n    515: THREE.LessEqualDepth,\r\n    516: THREE.GreaterEqualDepth,\r\n    517: THREE.NotEqualDepth,\r\n    518: THREE.GreaterEqualDepth,\r\n    519: THREE.AlwaysDepth\r\n};\r\n\r\nvar WEBGL_BLEND_EQUATIONS = {\r\n    32774: THREE.AddEquation,\r\n    32778: THREE.SubtractEquation,\r\n    32779: THREE.ReverseSubtractEquation\r\n};\r\n\r\nvar WEBGL_BLEND_FUNCS = {\r\n    0: THREE.ZeroFactor,\r\n    1: THREE.OneFactor,\r\n    768: THREE.SrcColorFactor,\r\n    769: THREE.OneMinusSrcColorFactor,\r\n    770: THREE.SrcAlphaFactor,\r\n    771: THREE.OneMinusSrcAlphaFactor,\r\n    772: THREE.DstAlphaFactor,\r\n    773: THREE.OneMinusDstAlphaFactor,\r\n    774: THREE.DstColorFactor,\r\n    775: THREE.OneMinusDstColorFactor,\r\n    776: THREE.SrcAlphaSaturateFactor\r\n    // The followings are not supported by Three.js yet\r\n    //32769: CONSTANT_COLOR,\r\n    //32770: ONE_MINUS_CONSTANT_COLOR,\r\n    //32771: CONSTANT_ALPHA,\r\n    //32772: ONE_MINUS_CONSTANT_COLOR\r\n};\r\n\r\nvar WEBGL_TYPE_SIZES = {\r\n    'SCALAR': 1,\r\n    'VEC2': 2,\r\n    'VEC3': 3,\r\n    'VEC4': 4,\r\n    'MAT2': 4,\r\n    'MAT3': 9,\r\n    'MAT4': 16\r\n};\r\n\r\nvar ATTRIBUTES = {\r\n    POSITION: 'position',\r\n    NORMAL: 'normal',\r\n    TANGENT: 'tangent',\r\n    TEXCOORD_0: 'uv',\r\n    TEXCOORD_1: 'uv2',\r\n    COLOR_0: 'color',\r\n    WEIGHTS_0: 'skinWeight',\r\n    JOINTS_0: 'skinIndex',\r\n};\r\n\r\nvar PATH_PROPERTIES = {\r\n    scale: 'scale',\r\n    translation: 'position',\r\n    rotation: 'quaternion',\r\n    weights: 'morphTargetInfluences'\r\n};\r\n\r\nvar INTERPOLATION = {\r\n    CUBICSPLINE: THREE.InterpolateSmooth, // We use custom interpolation GLTFCubicSplineInterpolation for CUBICSPLINE.\r\n                                            // KeyframeTrack.optimize() can't handle glTF Cubic Spline output values layout,\r\n                                            // using THREE.InterpolateSmooth for KeyframeTrack instantiation to prevent optimization.\r\n                                            // See KeyframeTrack.optimize() for the detail.\r\n    LINEAR: THREE.InterpolateLinear,\r\n    STEP: THREE.InterpolateDiscrete\r\n};\r\n\r\nvar STATES_ENABLES = {\r\n    2884: 'CULL_FACE',\r\n    2929: 'DEPTH_TEST',\r\n    3042: 'BLEND',\r\n    3089: 'SCISSOR_TEST',\r\n    32823: 'POLYGON_OFFSET_FILL',\r\n    32926: 'SAMPLE_ALPHA_TO_COVERAGE'\r\n};\r\n\r\nvar ALPHA_MODES = {\r\n    OPAQUE: 'OPAQUE',\r\n    MASK: 'MASK',\r\n    BLEND: 'BLEND'\r\n};\r\n\r\nvar MIME_TYPE_FORMATS = {\r\n    'image/png': THREE.RGBAFormat,\r\n    'image/jpeg': THREE.RGBFormat\r\n};\r\n\r\n/* UTILITY FUNCTIONS */\r\n\r\nfunction resolveURL( url, path ) {\r\n\r\n    // Invalid URL\r\n    if ( typeof url !== 'string' || url === '' ) return '';\r\n\r\n    // Absolute URL http://,https://,//\r\n    if ( /^(https?:)?\\/\\//i.test( url ) ) return url;\r\n\r\n    // Data URI\r\n    if ( /^data:.*,.*$/i.test( url ) ) return url;\r\n\r\n    // Blob URL\r\n    if ( /^blob:.*$/i.test( url ) ) return url;\r\n\r\n    // Relative URL\r\n    return path + url;\r\n\r\n}\r\n\r\n/**\r\n * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#default-material\r\n */\r\nfunction createDefaultMaterial() {\r\n\r\n    return new THREE.MeshStandardMaterial( {\r\n        color: 0xFFFFFF,\r\n        emissive: 0x000000,\r\n        metalness: 1,\r\n        roughness: 1,\r\n        transparent: false,\r\n        depthTest: true,\r\n        side: THREE.FrontSide\r\n    } );\r\n\r\n}\r\n\r\nfunction addUnknownExtensionsToUserData( knownExtensions, object, objectDef ) {\r\n\r\n    // Add unknown glTF extensions to an object's userData.\r\n\r\n    for ( var name in objectDef.extensions ) {\r\n\r\n        if ( knownExtensions[ name ] === undefined ) {\r\n\r\n            object.userData.gltfExtensions = object.userData.gltfExtensions || {};\r\n            object.userData.gltfExtensions[ name ] = objectDef.extensions[ name ];\r\n\r\n        }\r\n\r\n    }\r\n\r\n}\r\n\r\n/**\r\n * @param {THREE.Object3D|THREE.Material|THREE.BufferGeometry} object\r\n * @param {GLTF.definition} gltfDef\r\n */\r\nfunction assignExtrasToUserData( object, gltfDef ) {\r\n\r\n    if ( gltfDef.extras !== undefined ) {\r\n\r\n        if ( typeof gltfDef.extras === 'object' ) {\r\n\r\n            object.userData = gltfDef.extras;\r\n\r\n        } else {\r\n\r\n            console.warn( 'THREE.GLTFLoader: Ignoring primitive type .extras, ' + gltfDef.extras );\r\n\r\n        }\r\n\r\n    }\r\n\r\n}\r\n\r\n/**\r\n * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#morph-targets\r\n *\r\n * @param {THREE.BufferGeometry} geometry\r\n * @param {Array<GLTF.Target>} targets\r\n * @param {GLTFParser} parser\r\n * @return {Promise<THREE.BufferGeometry>}\r\n */\r\nfunction addMorphTargets( geometry, targets, parser ) {\r\n\r\n    var hasMorphPosition = false;\r\n    var hasMorphNormal = false;\r\n\r\n    for ( var i = 0, il = targets.length; i < il; i ++ ) {\r\n\r\n        var target = targets[ i ];\r\n\r\n        if ( target.POSITION !== undefined ) hasMorphPosition = true;\r\n        if ( target.NORMAL !== undefined ) hasMorphNormal = true;\r\n\r\n        if ( hasMorphPosition && hasMorphNormal ) break;\r\n\r\n    }\r\n\r\n    if ( ! hasMorphPosition && ! hasMorphNormal ) return Promise.resolve( geometry );\r\n\r\n    var pendingPositionAccessors = [];\r\n    var pendingNormalAccessors = [];\r\n\r\n    for ( var i = 0, il = targets.length; i < il; i ++ ) {\r\n\r\n        var target = targets[ i ];\r\n\r\n        if ( hasMorphPosition ) {\r\n\r\n            // TODO: Error-prone use of a callback inside a loop.\r\n            var accessor = target.POSITION !== undefined\r\n                ? parser.getDependency( 'accessor', target.POSITION )\r\n                    .then( function ( accessor ) {\r\n\r\n                        // Cloning not to pollute original accessor below\r\n                        return cloneBufferAttribute( accessor );\r\n\r\n                    } )\r\n                : geometry.attributes.position;\r\n\r\n            pendingPositionAccessors.push( accessor );\r\n\r\n        }\r\n\r\n        if ( hasMorphNormal ) {\r\n\r\n            // TODO: Error-prone use of a callback inside a loop.\r\n            var accessor = target.NORMAL !== undefined\r\n                ? parser.getDependency( 'accessor', target.NORMAL )\r\n                    .then( function ( accessor ) {\r\n\r\n                        return cloneBufferAttribute( accessor );\r\n\r\n                    } )\r\n                : geometry.attributes.normal;\r\n\r\n            pendingNormalAccessors.push( accessor );\r\n\r\n        }\r\n\r\n    }\r\n\r\n    return Promise.all( [\r\n        Promise.all( pendingPositionAccessors ),\r\n        Promise.all( pendingNormalAccessors )\r\n    ] ).then( function ( accessors ) {\r\n\r\n        var morphPositions = accessors[ 0 ];\r\n        var morphNormals = accessors[ 1 ];\r\n\r\n        for ( var i = 0, il = targets.length; i < il; i ++ ) {\r\n\r\n            var target = targets[ i ];\r\n            var attributeName = 'morphTarget' + i;\r\n\r\n            if ( hasMorphPosition ) {\r\n\r\n                // Three.js morph position is absolute value. The formula is\r\n                //   basePosition\r\n                //     + weight0 * ( morphPosition0 - basePosition )\r\n                //     + weight1 * ( morphPosition1 - basePosition )\r\n                //     ...\r\n                // while the glTF one is relative\r\n                //   basePosition\r\n                //     + weight0 * glTFmorphPosition0\r\n                //     + weight1 * glTFmorphPosition1\r\n                //     ...\r\n                // then we need to convert from relative to absolute here.\r\n\r\n                if ( target.POSITION !== undefined ) {\r\n\r\n                    var positionAttribute = morphPositions[ i ];\r\n                    positionAttribute.name = attributeName;\r\n\r\n                    var position = geometry.attributes.position;\r\n\r\n                    for ( var j = 0, jl = positionAttribute.count; j < jl; j ++ ) {\r\n\r\n                        positionAttribute.setXYZ(\r\n                            j,\r\n                            positionAttribute.getX( j ) + position.getX( j ),\r\n                            positionAttribute.getY( j ) + position.getY( j ),\r\n                            positionAttribute.getZ( j ) + position.getZ( j )\r\n                        );\r\n\r\n                    }\r\n\r\n                }\r\n\r\n            }\r\n\r\n            if ( hasMorphNormal ) {\r\n\r\n                // see target.POSITION's comment\r\n\r\n                if ( target.NORMAL !== undefined ) {\r\n\r\n                    var normalAttribute = morphNormals[ i ];\r\n                    normalAttribute.name = attributeName;\r\n\r\n                    var normal = geometry.attributes.normal;\r\n\r\n                    for ( var j = 0, jl = normalAttribute.count; j < jl; j ++ ) {\r\n\r\n                        normalAttribute.setXYZ(\r\n                            j,\r\n                            normalAttribute.getX( j ) + normal.getX( j ),\r\n                            normalAttribute.getY( j ) + normal.getY( j ),\r\n                            normalAttribute.getZ( j ) + normal.getZ( j )\r\n                        );\r\n\r\n                    }\r\n\r\n                }\r\n\r\n            }\r\n\r\n        }\r\n\r\n        if ( hasMorphPosition ) geometry.morphAttributes.position = morphPositions;\r\n        if ( hasMorphNormal ) geometry.morphAttributes.normal = morphNormals;\r\n\r\n        return geometry;\r\n\r\n    } );\r\n\r\n}\r\n\r\n/**\r\n * @param {THREE.Mesh} mesh\r\n * @param {GLTF.Mesh} meshDef\r\n */\r\nfunction updateMorphTargets( mesh, meshDef ) {\r\n\r\n    mesh.updateMorphTargets();\r\n\r\n    if ( meshDef.weights !== undefined ) {\r\n\r\n        for ( var i = 0, il = meshDef.weights.length; i < il; i ++ ) {\r\n\r\n            mesh.morphTargetInfluences[ i ] = meshDef.weights[ i ];\r\n\r\n        }\r\n\r\n    }\r\n\r\n    // .extras has user-defined data, so check that .extras.targetNames is an array.\r\n    if ( meshDef.extras && Array.isArray( meshDef.extras.targetNames ) ) {\r\n\r\n        var targetNames = meshDef.extras.targetNames;\r\n\r\n        if ( mesh.morphTargetInfluences.length === targetNames.length ) {\r\n\r\n            mesh.morphTargetDictionary = {};\r\n\r\n            for ( var i = 0, il = targetNames.length; i < il; i ++ ) {\r\n\r\n                mesh.morphTargetDictionary[ targetNames[ i ] ] = i;\r\n\r\n            }\r\n\r\n        } else {\r\n\r\n            console.warn( 'THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.' );\r\n\r\n        }\r\n\r\n    }\r\n\r\n}\r\nfunction isObjectEqual( a, b ) {\r\n\r\n    if ( Object.keys( a ).length !== Object.keys( b ).length ) return false;\r\n\r\n    for ( var key in a ) {\r\n\r\n        if ( a[ key ] !== b[ key ] ) return false;\r\n\r\n    }\r\n\r\n    return true;\r\n\r\n}\r\n\r\nfunction createPrimitiveKey( primitiveDef ) {\r\n\r\n    var dracoExtension = primitiveDef.extensions && primitiveDef.extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ];\r\n    var geometryKey;\r\n\r\n    if ( dracoExtension ) {\r\n\r\n        geometryKey = 'draco:' + dracoExtension.bufferView\r\n            + ':' + dracoExtension.indices\r\n            + ':' + createAttributesKey( dracoExtension.attributes );\r\n\r\n    } else {\r\n\r\n        geometryKey = primitiveDef.indices + ':' + createAttributesKey( primitiveDef.attributes ) + ':' + primitiveDef.mode;\r\n\r\n    }\r\n\r\n    return geometryKey;\r\n\r\n}\r\n\r\nfunction createAttributesKey( attributes ) {\r\n\r\n    var attributesKey = '';\r\n\r\n    var keys = Object.keys( attributes ).sort();\r\n\r\n    for ( var i = 0, il = keys.length; i < il; i ++ ) {\r\n\r\n        attributesKey += keys[ i ] + ':' + attributes[ keys[ i ] ] + ';';\r\n\r\n    }\r\n\r\n    return attributesKey;\r\n\r\n}\r\n\r\nfunction createArrayKeyBufferGeometry( a ) {\r\n\r\n    var arrayKey = '';\r\n\r\n    for ( var i = 0, il = a.length; i < il; i ++ ) {\r\n\r\n        arrayKey += ':' + a[ i ].uuid;\r\n\r\n    }\r\n\r\n    return arrayKey;\r\n\r\n}\r\n\r\nfunction createMultiPassGeometryKey( geometry, primitives ) {\r\n\r\n    var key = geometry.uuid;\r\n\r\n    for ( var i = 0, il = primitives.length; i < il; i ++ ) {\r\n\r\n        key += i + createPrimitiveKey( primitives[ i ] );\r\n\r\n    }\r\n\r\n    return key;\r\n\r\n}\r\n\r\nfunction cloneBufferAttribute( attribute ) {\r\n\r\n    if ( attribute.isInterleavedBufferAttribute ) {\r\n\r\n        var count = attribute.count;\r\n        var itemSize = attribute.itemSize;\r\n        var array = attribute.array.slice( 0, count * itemSize );\r\n\r\n        for ( var i = 0, j = 0; i < count; ++ i ) {\r\n\r\n            array[ j ++ ] = attribute.getX( i );\r\n            if ( itemSize >= 2 ) array[ j ++ ] = attribute.getY( i );\r\n            if ( itemSize >= 3 ) array[ j ++ ] = attribute.getZ( i );\r\n            if ( itemSize >= 4 ) array[ j ++ ] = attribute.getW( i );\r\n\r\n        }\r\n\r\n        return new THREE.BufferAttribute( array, itemSize, attribute.normalized );\r\n\r\n    }\r\n\r\n    return attribute.clone();\r\n\r\n}\r\n\r\n/**\r\n * Checks if we can build a single Mesh with MultiMaterial from multiple primitives.\r\n * Returns true if all primitives use the same attributes/morphAttributes/mode\r\n * and also have index. Otherwise returns false.\r\n *\r\n * @param {Array<GLTF.Primitive>} primitives\r\n * @return {Boolean}\r\n */\r\nfunction isMultiPassGeometry( primitives ) {\r\n\r\n    if ( primitives.length < 2 ) return false;\r\n\r\n    var primitive0 = primitives[ 0 ];\r\n    var targets0 = primitive0.targets || [];\r\n\r\n    if ( primitive0.indices === undefined ) return false;\r\n\r\n    for ( var i = 1, il = primitives.length; i < il; i ++ ) {\r\n\r\n        var primitive = primitives[ i ];\r\n\r\n        if ( primitive0.mode !== primitive.mode ) return false;\r\n        if ( primitive.indices === undefined ) return false;\r\n        if ( primitive.extensions && primitive.extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ] ) return false;\r\n        if ( ! isObjectEqual( primitive0.attributes, primitive.attributes ) ) return false;\r\n\r\n        var targets = primitive.targets || [];\r\n\r\n        if ( targets0.length !== targets.length ) return false;\r\n\r\n        for ( var j = 0, jl = targets0.length; j < jl; j ++ ) {\r\n\r\n            if ( ! isObjectEqual( targets0[ j ], targets[ j ] ) ) return false;\r\n\r\n        }\r\n\r\n    }\r\n\r\n    return true;\r\n\r\n}\r\n\r\n/* GLTF PARSER */\r\n\r\nfunction GLTFParser( json, extensions, options ) {\r\n\r\n    this.json = json || {};\r\n    this.extensions = extensions || {};\r\n    this.options = options || {};\r\n\r\n    // loader object cache\r\n    this.cache = new GLTFRegistry();\r\n\r\n    // BufferGeometry caching\r\n    this.primitiveCache = {};\r\n    this.multiplePrimitivesCache = {};\r\n    this.multiPassGeometryCache = {};\r\n\r\n    this.textureLoader = new THREE.TextureLoader( this.options.manager );\r\n    this.textureLoader.setCrossOrigin( this.options.crossOrigin );\r\n\r\n    this.fileLoader = new THREE.FileLoader( this.options.manager );\r\n    this.fileLoader.setResponseType( 'arraybuffer' );\r\n\r\n}\r\n\r\nGLTFParser.prototype.parse = function ( onLoad, onError ) {\r\n\r\n    var json = this.json;\r\n\r\n    // Clear the loader cache\r\n    this.cache.removeAll();\r\n\r\n    // Mark the special nodes/meshes in json for efficient parse\r\n    this.markDefs();\r\n\r\n    // Fire the callback on complete\r\n    this.getMultiDependencies( [\r\n\r\n        'scene',\r\n        'animation',\r\n        'camera'\r\n\r\n    ] ).then( function ( dependencies ) {\r\n\r\n        var scenes = dependencies.scenes || [];\r\n        var scene = scenes[ json.scene || 0 ];\r\n        var animations = dependencies.animations || [];\r\n        var cameras = dependencies.cameras || [];\r\n\r\n        onLoad( scene, scenes, cameras, animations, json );\r\n\r\n    } ).catch( onError );\r\n\r\n};\r\n\r\n/**\r\n * Marks the special nodes/meshes in json for efficient parse.\r\n */\r\nGLTFParser.prototype.markDefs = function () {\r\n\r\n    var nodeDefs = this.json.nodes || [];\r\n    var skinDefs = this.json.skins || [];\r\n    var meshDefs = this.json.meshes || [];\r\n\r\n    var meshReferences = {};\r\n    var meshUses = {};\r\n\r\n    // Nothing in the node definition indicates whether it is a Bone or an\r\n    // Object3D. Use the skins' joint references to mark bones.\r\n    for ( var skinIndex = 0, skinLength = skinDefs.length; skinIndex < skinLength; skinIndex ++ ) {\r\n\r\n        var joints = skinDefs[ skinIndex ].joints;\r\n\r\n        for ( var i = 0, il = joints.length; i < il; i ++ ) {\r\n\r\n            nodeDefs[ joints[ i ] ].isBone = true;\r\n\r\n        }\r\n\r\n    }\r\n\r\n    // Meshes can (and should) be reused by multiple nodes in a glTF asset. To\r\n    // avoid having more than one THREE.Mesh with the same name, count\r\n    // references and rename instances below.\r\n    //\r\n    // Example: CesiumMilkTruck sample model reuses \"Wheel\" meshes.\r\n    for ( var nodeIndex = 0, nodeLength = nodeDefs.length; nodeIndex < nodeLength; nodeIndex ++ ) {\r\n\r\n        var nodeDef = nodeDefs[ nodeIndex ];\r\n\r\n        if ( nodeDef.mesh !== undefined ) {\r\n\r\n            if ( meshReferences[ nodeDef.mesh ] === undefined ) {\r\n\r\n                meshReferences[ nodeDef.mesh ] = meshUses[ nodeDef.mesh ] = 0;\r\n\r\n            }\r\n\r\n            meshReferences[ nodeDef.mesh ] ++;\r\n\r\n            // Nothing in the mesh definition indicates whether it is\r\n            // a SkinnedMesh or Mesh. Use the node's mesh reference\r\n            // to mark SkinnedMesh if node has skin.\r\n            if ( nodeDef.skin !== undefined ) {\r\n\r\n                meshDefs[ nodeDef.mesh ].isSkinnedMesh = true;\r\n\r\n            }\r\n\r\n        }\r\n\r\n    }\r\n\r\n    this.json.meshReferences = meshReferences;\r\n    this.json.meshUses = meshUses;\r\n\r\n};\r\n\r\n/**\r\n * Requests the specified dependency asynchronously, with caching.\r\n * @param {string} type\r\n * @param {number} index\r\n * @return {Promise<THREE.Object3D|THREE.Material|THREE.Texture|THREE.AnimationClip|ArrayBuffer|Object>}\r\n */\r\nGLTFParser.prototype.getDependency = function ( type, index ) {\r\n    var cacheKey = type + ':' + index;\r\n    var dependency = this.cache.get( cacheKey );\r\n\r\n    if ( ! dependency ) {\r\n\r\n        switch ( type ) {\r\n\r\n            case 'scene':\r\n                dependency = this.loadScene( index );\r\n                break;\r\n\r\n            case 'node':\r\n                dependency = this.loadNode( index );\r\n                break;\r\n\r\n            case 'mesh':\r\n                dependency = this.loadMesh( index );\r\n                break;\r\n\r\n            case 'accessor':\r\n                dependency = this.loadAccessor( index );\r\n                break;\r\n\r\n            case 'bufferView':\r\n                dependency = this.loadBufferView( index );\r\n                break;\r\n\r\n            case 'buffer':\r\n                dependency = this.loadBuffer( index );\r\n                break;\r\n\r\n            case 'material':\r\n                dependency = this.loadMaterial( index );\r\n                break;\r\n\r\n            case 'texture':\r\n                dependency = this.loadTexture( index );\r\n                break;\r\n\r\n            case 'skin':\r\n                dependency = this.loadSkin( index );\r\n                break;\r\n\r\n            case 'animation':\r\n                dependency = this.loadAnimation( index );\r\n                break;\r\n\r\n            case 'camera':\r\n                dependency = this.loadCamera( index );\r\n                break;\r\n\r\n            case 'light':\r\n                dependency = this.extensions[ EXTENSIONS.KHR_LIGHTS_PUNCTUAL ].loadLight( index );\r\n                break;\r\n\r\n            default:\r\n                throw new Error( 'Unknown type: ' + type );\r\n\r\n        }\r\n\r\n        this.cache.add( cacheKey, dependency );\r\n\r\n    }\r\n\r\n    return dependency;\r\n\r\n};\r\n\r\n/**\r\n * Requests all dependencies of the specified type asynchronously, with caching.\r\n * @param {string} type\r\n * @return {Promise<Array<Object>>}\r\n */\r\nGLTFParser.prototype.getDependencies = function ( type ) {\r\n\r\n    var dependencies = this.cache.get( type );\r\n\r\n    if ( ! dependencies ) {\r\n\r\n        var parser = this;\r\n        var defs = this.json[ type + ( type === 'mesh' ? 'es' : 's' ) ] || [];\r\n\r\n        dependencies = Promise.all( defs.map( function ( def, index ) {\r\n\r\n            return parser.getDependency( type, index );\r\n\r\n        } ) );\r\n\r\n        this.cache.add( type, dependencies );\r\n\r\n    }\r\n\r\n    return dependencies;\r\n\r\n};\r\n\r\n/**\r\n * Requests all multiple dependencies of the specified types asynchronously, with caching.\r\n * @param {Array<string>} types\r\n * @return {Promise<Object<Array<Object>>>}\r\n */\r\nGLTFParser.prototype.getMultiDependencies = function ( types ) {\r\n\r\n    var results = {};\r\n    var pending = [];\r\n\r\n    for ( var i = 0, il = types.length; i < il; i ++ ) {\r\n\r\n        var type = types[ i ];\r\n        var value = this.getDependencies( type );\r\n\r\n        // TODO: Error-prone use of a callback inside a loop.\r\n        value = value.then( function ( key, value ) {\r\n\r\n            results[ key ] = value;\r\n\r\n        }.bind( this, type + ( type === 'mesh' ? 'es' : 's' ) ) );\r\n\r\n        pending.push( value );\r\n\r\n    }\r\n\r\n    return Promise.all( pending ).then( function () {\r\n\r\n        return results;\r\n\r\n    } );\r\n\r\n};\r\n\r\n/**\r\n * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\r\n * @param {number} bufferIndex\r\n * @return {Promise<ArrayBuffer>}\r\n */\r\nGLTFParser.prototype.loadBuffer = function ( bufferIndex ) {\r\n\r\n    var bufferDef = this.json.buffers[ bufferIndex ];\r\n    var loader = this.fileLoader;\r\n\r\n    if ( bufferDef.type && bufferDef.type !== 'arraybuffer' ) {\r\n\r\n        throw new Error( 'THREE.GLTFLoader: ' + bufferDef.type + ' buffer type is not supported.' );\r\n\r\n    }\r\n\r\n    // If present, GLB container is required to be the first buffer.\r\n    if ( bufferDef.uri === undefined && bufferIndex === 0 ) {\r\n\r\n        return Promise.resolve( this.extensions[ EXTENSIONS.KHR_BINARY_GLTF ].body );\r\n\r\n    }\r\n\r\n    var options = this.options;\r\n\r\n    return new Promise( function ( resolve, reject ) {\r\n\r\n        loader.load( resolveURL( bufferDef.uri, options.path ), resolve, undefined, function () {\r\n\r\n            reject( new Error( 'THREE.GLTFLoader: Failed to load buffer \"' + bufferDef.uri + '\".' ) );\r\n\r\n        } );\r\n\r\n    } );\r\n\r\n};\r\n\r\n/**\r\n * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\r\n * @param {number} bufferViewIndex\r\n * @return {Promise<ArrayBuffer>}\r\n */\r\nGLTFParser.prototype.loadBufferView = function ( bufferViewIndex ) {\r\n\r\n    var bufferViewDef = this.json.bufferViews[ bufferViewIndex ];\r\n\r\n    return this.getDependency( 'buffer', bufferViewDef.buffer ).then( function ( buffer ) {\r\n\r\n        var byteLength = bufferViewDef.byteLength || 0;\r\n        var byteOffset = bufferViewDef.byteOffset || 0;\r\n        return buffer.slice( byteOffset, byteOffset + byteLength );\r\n\r\n    } );\r\n\r\n};\r\n\r\n/**\r\n * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#accessors\r\n * @param {number} accessorIndex\r\n * @return {Promise<THREE.BufferAttribute|THREE.InterleavedBufferAttribute>}\r\n */\r\nGLTFParser.prototype.loadAccessor = function ( accessorIndex ) {\r\n\r\n    var parser = this;\r\n    var json = this.json;\r\n\r\n    var accessorDef = this.json.accessors[ accessorIndex ];\r\n\r\n    if ( accessorDef.bufferView === undefined && accessorDef.sparse === undefined ) {\r\n\r\n        // Ignore empty accessors, which may be used to declare runtime\r\n        // information about attributes coming from another source (e.g. Draco\r\n        // compression extension).\r\n        return Promise.resolve( null );\r\n\r\n    }\r\n\r\n    var pendingBufferViews = [];\r\n\r\n    if ( accessorDef.bufferView !== undefined ) {\r\n\r\n        pendingBufferViews.push( this.getDependency( 'bufferView', accessorDef.bufferView ) );\r\n\r\n    } else {\r\n\r\n        pendingBufferViews.push( null );\r\n\r\n    }\r\n\r\n    if ( accessorDef.sparse !== undefined ) {\r\n\r\n        pendingBufferViews.push( this.getDependency( 'bufferView', accessorDef.sparse.indices.bufferView ) );\r\n        pendingBufferViews.push( this.getDependency( 'bufferView', accessorDef.sparse.values.bufferView ) );\r\n\r\n    }\r\n\r\n    return Promise.all( pendingBufferViews ).then( function ( bufferViews ) {\r\n\r\n        var bufferView = bufferViews[ 0 ];\r\n\r\n        var itemSize = WEBGL_TYPE_SIZES[ accessorDef.type ];\r\n        var TypedArray = WEBGL_COMPONENT_TYPES[ accessorDef.componentType ];\r\n\r\n        // For VEC3: itemSize is 3, elementBytes is 4, itemBytes is 12.\r\n        var elementBytes = TypedArray.BYTES_PER_ELEMENT;\r\n        var itemBytes = elementBytes * itemSize;\r\n        var byteOffset = accessorDef.byteOffset || 0;\r\n        var byteStride = accessorDef.bufferView !== undefined ? json.bufferViews[ accessorDef.bufferView ].byteStride : undefined;\r\n        var normalized = accessorDef.normalized === true;\r\n        var array, bufferAttribute;\r\n\r\n        // The buffer is not interleaved if the stride is the item size in bytes.\r\n        if ( byteStride && byteStride !== itemBytes ) {\r\n\r\n            var ibCacheKey = 'InterleavedBuffer:' + accessorDef.bufferView + ':' + accessorDef.componentType;\r\n            var ib = parser.cache.get( ibCacheKey );\r\n\r\n            if ( ! ib ) {\r\n\r\n                // Use the full buffer if it's interleaved.\r\n                array = new TypedArray( bufferView );\r\n\r\n                // Integer parameters to IB/IBA are in array elements, not bytes.\r\n                ib = new THREE.InterleavedBuffer( array, byteStride / elementBytes );\r\n\r\n                parser.cache.add( ibCacheKey, ib );\r\n\r\n            }\r\n\r\n            bufferAttribute = new THREE.InterleavedBufferAttribute( ib, itemSize, byteOffset / elementBytes, normalized );\r\n\r\n        } else {\r\n\r\n            if ( bufferView === null ) {\r\n\r\n                array = new TypedArray( accessorDef.count * itemSize );\r\n\r\n            } else {\r\n\r\n                array = new TypedArray( bufferView, byteOffset, accessorDef.count * itemSize );\r\n\r\n            }\r\n\r\n            bufferAttribute = new THREE.BufferAttribute( array, itemSize, normalized );\r\n\r\n        }\r\n\r\n        // https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#sparse-accessors\r\n        if ( accessorDef.sparse !== undefined ) {\r\n\r\n            var itemSizeIndices = WEBGL_TYPE_SIZES.SCALAR;\r\n            var TypedArrayIndices = WEBGL_COMPONENT_TYPES[ accessorDef.sparse.indices.componentType ];\r\n\r\n            var byteOffsetIndices = accessorDef.sparse.indices.byteOffset || 0;\r\n            var byteOffsetValues = accessorDef.sparse.values.byteOffset || 0;\r\n\r\n            var sparseIndices = new TypedArrayIndices( bufferViews[ 1 ], byteOffsetIndices, accessorDef.sparse.count * itemSizeIndices );\r\n            var sparseValues = new TypedArray( bufferViews[ 2 ], byteOffsetValues, accessorDef.sparse.count * itemSize );\r\n\r\n            if ( bufferView !== null ) {\r\n\r\n                // Avoid modifying the original ArrayBuffer, if the bufferView wasn't initialized with zeroes.\r\n                bufferAttribute.setArray( bufferAttribute.array.slice() );\r\n\r\n            }\r\n\r\n            for ( var i = 0, il = sparseIndices.length; i < il; i ++ ) {\r\n\r\n                var index = sparseIndices[ i ];\r\n\r\n                bufferAttribute.setX( index, sparseValues[ i * itemSize ] );\r\n                if ( itemSize >= 2 ) bufferAttribute.setY( index, sparseValues[ i * itemSize + 1 ] );\r\n                if ( itemSize >= 3 ) bufferAttribute.setZ( index, sparseValues[ i * itemSize + 2 ] );\r\n                if ( itemSize >= 4 ) bufferAttribute.setW( index, sparseValues[ i * itemSize + 3 ] );\r\n                if ( itemSize >= 5 ) throw new Error( 'THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.' );\r\n\r\n            }\r\n\r\n        }\r\n\r\n        return bufferAttribute;\r\n\r\n    } );\r\n\r\n};\r\n\r\n/**\r\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#textures\r\n * @param {number} textureIndex\r\n * @return {Promise<THREE.Texture>}\r\n */\r\nGLTFParser.prototype.loadTexture = function ( textureIndex ) {\r\n\r\n    var parser = this;\r\n    var json = this.json;\r\n    var options = this.options;\r\n    var textureLoader = this.textureLoader;\r\n\r\n    var URL = window.URL || window.webkitURL;\r\n\r\n    var textureDef = json.textures[ textureIndex ];\r\n\r\n    var textureExtensions = textureDef.extensions || {};\r\n\r\n    var source;\r\n\r\n    if ( textureExtensions[ EXTENSIONS.MSFT_TEXTURE_DDS ] ) {\r\n\r\n        source = json.images[ textureExtensions[ EXTENSIONS.MSFT_TEXTURE_DDS ].source ];\r\n\r\n    } else {\r\n\r\n        source = json.images[ textureDef.source ];\r\n\r\n    }\r\n\r\n    var sourceURI = source.uri;\r\n    var isObjectURL = false;\r\n\r\n    if ( source.bufferView !== undefined ) {\r\n\r\n        // Load binary image data from bufferView, if provided.\r\n\r\n        sourceURI = parser.getDependency( 'bufferView', source.bufferView ).then( function ( bufferView ) {\r\n\r\n            isObjectURL = true;\r\n            var blob = new Blob( [ bufferView ], { type: source.mimeType } );\r\n            sourceURI = URL.createObjectURL( blob );\r\n            return sourceURI;\r\n\r\n        } );\r\n\r\n    }\r\n\r\n    return Promise.resolve( sourceURI ).then( function ( sourceURI ) {\r\n\r\n        // Load Texture resource.\r\n\r\n        var loader = THREE.Loader.Handlers.get( sourceURI );\r\n\r\n        if ( ! loader ) {\r\n\r\n            loader = textureExtensions[ EXTENSIONS.MSFT_TEXTURE_DDS ]\r\n                ? parser.extensions[ EXTENSIONS.MSFT_TEXTURE_DDS ].ddsLoader\r\n                : textureLoader;\r\n\r\n        }\r\n\r\n        return new Promise( function ( resolve, reject ) {\r\n\r\n            loader.load( resolveURL( sourceURI, options.path ), resolve, undefined, reject );\r\n\r\n        } );\r\n\r\n    } ).then( function ( texture ) {\r\n\r\n        // Clean up resources and configure Texture.\r\n\r\n        if ( isObjectURL === true ) {\r\n\r\n            URL.revokeObjectURL( sourceURI );\r\n\r\n        }\r\n\r\n        texture.flipY = false;\r\n\r\n        if ( textureDef.name !== undefined ) texture.name = textureDef.name;\r\n\r\n        // Ignore unknown mime types, like DDS files.\r\n        if ( source.mimeType in MIME_TYPE_FORMATS ) {\r\n\r\n            texture.format = MIME_TYPE_FORMATS[ source.mimeType ];\r\n\r\n        }\r\n\r\n        var samplers = json.samplers || {};\r\n        var sampler = samplers[ textureDef.sampler ] || {};\r\n\r\n        texture.magFilter = WEBGL_FILTERS[ sampler.magFilter ] || THREE.LinearFilter;\r\n        texture.minFilter = WEBGL_FILTERS[ sampler.minFilter ] || THREE.LinearMipMapLinearFilter;\r\n        texture.wrapS = WEBGL_WRAPPINGS[ sampler.wrapS ] || THREE.RepeatWrapping;\r\n        texture.wrapT = WEBGL_WRAPPINGS[ sampler.wrapT ] || THREE.RepeatWrapping;\r\n\r\n        return texture;\r\n\r\n    } );\r\n\r\n};\r\n\r\n/**\r\n * Asynchronously assigns a texture to the given material parameters.\r\n * @param {Object} materialParams\r\n * @param {string} mapName\r\n * @param {Object} mapDef\r\n * @return {Promise}\r\n */\r\nGLTFParser.prototype.assignTexture = function ( materialParams, mapName, mapDef ) {\r\n\r\n    var parser = this;\r\n\r\n    return this.getDependency( 'texture', mapDef.index ).then( function ( texture ) {\r\n\r\n        switch ( mapName ) {\r\n\r\n            case 'aoMap':\r\n            case 'emissiveMap':\r\n            case 'metalnessMap':\r\n            case 'normalMap':\r\n            case 'roughnessMap':\r\n                texture.format = THREE.RGBFormat;\r\n                break;\r\n\r\n        }\r\n\r\n        if ( parser.extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ] ) {\r\n\r\n            var transform = mapDef.extensions !== undefined ? mapDef.extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ] : undefined;\r\n\r\n            if ( transform ) {\r\n\r\n                texture = parser.extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ].extendTexture( texture, transform );\r\n\r\n            }\r\n\r\n        }\r\n\r\n        materialParams[ mapName ] = texture;\r\n\r\n    } );\r\n\r\n};\r\n\r\n/**\r\n * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#materials\r\n * @param {number} materialIndex\r\n * @return {Promise<THREE.Material>}\r\n */\r\nGLTFParser.prototype.loadMaterial = function ( materialIndex ) {\r\n\r\n    var parser = this;\r\n    var json = this.json;\r\n    var extensions = this.extensions;\r\n    var materialDef = json.materials[ materialIndex ];\r\n\r\n    var materialType;\r\n    var materialParams = {};\r\n    var materialExtensions = materialDef.extensions || {};\r\n\r\n    var pending = [];\r\n\r\n    if ( materialExtensions[ EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS ] ) {\r\n\r\n        var sgExtension = extensions[ EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS ];\r\n        materialType = sgExtension.getMaterialType( materialDef );\r\n        pending.push( sgExtension.extendParams( materialParams, materialDef, parser ) );\r\n\r\n    } else if ( materialExtensions[ EXTENSIONS.KHR_MATERIALS_UNLIT ] ) {\r\n\r\n        var kmuExtension = extensions[ EXTENSIONS.KHR_MATERIALS_UNLIT ];\r\n        materialType = kmuExtension.getMaterialType( materialDef );\r\n        pending.push( kmuExtension.extendParams( materialParams, materialDef, parser ) );\r\n\r\n    } else {\r\n\r\n        // Specification:\r\n        // https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#metallic-roughness-material\r\n\r\n        materialType = THREE.MeshStandardMaterial;\r\n\r\n        var metallicRoughness = materialDef.pbrMetallicRoughness || {};\r\n\r\n        materialParams.color = new THREE.Color( 1.0, 1.0, 1.0 );\r\n        materialParams.opacity = 1.0;\r\n\r\n        if ( Array.isArray( metallicRoughness.baseColorFactor ) ) {\r\n\r\n            var array = metallicRoughness.baseColorFactor;\r\n\r\n            materialParams.color.fromArray( array );\r\n            materialParams.opacity = array[ 3 ];\r\n\r\n        }\r\n\r\n        if ( metallicRoughness.baseColorTexture !== undefined ) {\r\n\r\n            pending.push( parser.assignTexture( materialParams, 'map', metallicRoughness.baseColorTexture ) );\r\n\r\n        }\r\n\r\n        materialParams.metalness = metallicRoughness.metallicFactor !== undefined ? metallicRoughness.metallicFactor : 1.0;\r\n        materialParams.roughness = metallicRoughness.roughnessFactor !== undefined ? metallicRoughness.roughnessFactor : 1.0;\r\n\r\n        if ( metallicRoughness.metallicRoughnessTexture !== undefined ) {\r\n\r\n            pending.push( parser.assignTexture( materialParams, 'metalnessMap', metallicRoughness.metallicRoughnessTexture ) );\r\n            pending.push( parser.assignTexture( materialParams, 'roughnessMap', metallicRoughness.metallicRoughnessTexture ) );\r\n\r\n        }\r\n\r\n    }\r\n\r\n    if ( materialDef.doubleSided === true ) {\r\n\r\n        materialParams.side = THREE.DoubleSide;\r\n\r\n    }\r\n\r\n    var alphaMode = materialDef.alphaMode || ALPHA_MODES.OPAQUE;\r\n\r\n    if ( alphaMode === ALPHA_MODES.BLEND ) {\r\n\r\n        materialParams.transparent = true;\r\n\r\n    } else {\r\n\r\n        materialParams.transparent = false;\r\n\r\n        if ( alphaMode === ALPHA_MODES.MASK ) {\r\n\r\n            materialParams.alphaTest = materialDef.alphaCutoff !== undefined ? materialDef.alphaCutoff : 0.5;\r\n\r\n        }\r\n\r\n    }\r\n\r\n    if ( materialDef.normalTexture !== undefined && materialType !== THREE.MeshBasicMaterial ) {\r\n\r\n        pending.push( parser.assignTexture( materialParams, 'normalMap', materialDef.normalTexture ) );\r\n\r\n        materialParams.normalScale = new THREE.Vector2( 1, 1 );\r\n\r\n        if ( materialDef.normalTexture.scale !== undefined ) {\r\n\r\n            materialParams.normalScale.set( materialDef.normalTexture.scale, materialDef.normalTexture.scale );\r\n\r\n        }\r\n\r\n    }\r\n\r\n    if ( materialDef.occlusionTexture !== undefined && materialType !== THREE.MeshBasicMaterial ) {\r\n\r\n        pending.push( parser.assignTexture( materialParams, 'aoMap', materialDef.occlusionTexture ) );\r\n\r\n        if ( materialDef.occlusionTexture.strength !== undefined ) {\r\n\r\n            materialParams.aoMapIntensity = materialDef.occlusionTexture.strength;\r\n\r\n        }\r\n\r\n    }\r\n\r\n    if ( materialDef.emissiveFactor !== undefined && materialType !== THREE.MeshBasicMaterial ) {\r\n\r\n        materialParams.emissive = new THREE.Color().fromArray( materialDef.emissiveFactor );\r\n\r\n    }\r\n\r\n    if ( materialDef.emissiveTexture !== undefined && materialType !== THREE.MeshBasicMaterial ) {\r\n\r\n        pending.push( parser.assignTexture( materialParams, 'emissiveMap', materialDef.emissiveTexture ) );\r\n\r\n    }\r\n\r\n    return Promise.all( pending ).then( function () {\r\n\r\n        var material;\r\n\r\n        if ( materialType === THREE.ShaderMaterial ) {\r\n\r\n            material = extensions[ EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS ].createMaterial( materialParams );\r\n\r\n        } else {\r\n\r\n            material = new materialType( materialParams );\r\n\r\n        }\r\n\r\n        if ( materialDef.name !== undefined ) material.name = materialDef.name;\r\n\r\n        // baseColorTexture, emissiveTexture, and specularGlossinessTexture use sRGB encoding.\r\n        if ( material.map ) material.map.encoding = THREE.sRGBEncoding;\r\n        if ( material.emissiveMap ) material.emissiveMap.encoding = THREE.sRGBEncoding;\r\n        if ( material.specularMap ) material.specularMap.encoding = THREE.sRGBEncoding;\r\n\r\n        assignExtrasToUserData( material, materialDef );\r\n\r\n        if ( materialDef.extensions ) addUnknownExtensionsToUserData( extensions, material, materialDef );\r\n\r\n        return material;\r\n\r\n    } );\r\n\r\n};\r\n\r\n/**\r\n * @param {THREE.BufferGeometry} geometry\r\n * @param {GLTF.Primitive} primitiveDef\r\n * @param {GLTFParser} parser\r\n * @return {Promise<THREE.BufferGeometry>}\r\n */\r\nfunction addPrimitiveAttributes( geometry, primitiveDef, parser ) {\r\n\r\n    var attributes = primitiveDef.attributes;\r\n\r\n    var pending = [];\r\n\r\n    function assignAttributeAccessor( accessorIndex, attributeName ) {\r\n\r\n        return parser.getDependency( 'accessor', accessorIndex )\r\n            .then( function ( accessor ) {\r\n\r\n                geometry.addAttribute( attributeName, accessor );\r\n\r\n            } );\r\n\r\n    }\r\n\r\n    for ( var gltfAttributeName in attributes ) {\r\n\r\n        var threeAttributeName = ATTRIBUTES[ gltfAttributeName ];\r\n\r\n        if ( ! threeAttributeName ) continue;\r\n\r\n        // Skip attributes already provided by e.g. Draco extension.\r\n        if ( threeAttributeName in geometry.attributes ) continue;\r\n\r\n        pending.push( assignAttributeAccessor( attributes[ gltfAttributeName ], threeAttributeName ) );\r\n\r\n    }\r\n\r\n    if ( primitiveDef.indices !== undefined && ! geometry.index ) {\r\n\r\n        var accessor = parser.getDependency( 'accessor', primitiveDef.indices ).then( function ( accessor ) {\r\n\r\n            geometry.setIndex( accessor );\r\n\r\n        } );\r\n\r\n        pending.push( accessor );\r\n\r\n    }\r\n\r\n    assignExtrasToUserData( geometry, primitiveDef );\r\n\r\n    return Promise.all( pending ).then( function () {\r\n\r\n        return primitiveDef.targets !== undefined\r\n            ? addMorphTargets( geometry, primitiveDef.targets, parser )\r\n            : geometry;\r\n\r\n    } );\r\n\r\n}\r\n\r\n/**\r\n * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#geometry\r\n *\r\n * Creates BufferGeometries from primitives.\r\n * If we can build a single BufferGeometry with .groups from multiple primitives, returns one BufferGeometry.\r\n * Otherwise, returns BufferGeometries without .groups as many as primitives.\r\n *\r\n * @param {Array<GLTF.Primitive>} primitives\r\n * @return {Promise<Array<THREE.BufferGeometry>>}\r\n */\r\nGLTFParser.prototype.loadGeometries = function ( primitives ) {\r\n\r\n    var parser = this;\r\n    var extensions = this.extensions;\r\n    var cache = this.primitiveCache;\r\n\r\n    var isMultiPass = isMultiPassGeometry( primitives );\r\n    var originalPrimitives;\r\n\r\n    if ( isMultiPass ) {\r\n\r\n        originalPrimitives = primitives; // save original primitives and use later\r\n\r\n        // We build a single BufferGeometry with .groups from multiple primitives\r\n        // because all primitives share the same attributes/morph/mode and have indices.\r\n\r\n        primitives = [ primitives[ 0 ] ];\r\n\r\n        // Sets .groups and combined indices to a geometry later in this method.\r\n\r\n    }\r\n\r\n    function createDracoPrimitive( primitive ) {\r\n\r\n        return extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ]\r\n            .decodePrimitive( primitive, parser )\r\n            .then( function ( geometry ) {\r\n\r\n                return addPrimitiveAttributes( geometry, primitive, parser );\r\n\r\n            } );\r\n\r\n    }\r\n\r\n    var pending = [];\r\n\r\n    for ( var i = 0, il = primitives.length; i < il; i ++ ) {\r\n\r\n        var primitive = primitives[ i ];\r\n        var cacheKey = createPrimitiveKey( primitive );\r\n\r\n        // See if we've already created this geometry\r\n        var cached = cache[ cacheKey ];\r\n\r\n        if ( cached ) {\r\n\r\n            // Use the cached geometry if it exists\r\n            pending.push( cached.promise );\r\n\r\n        } else {\r\n\r\n            var geometryPromise;\r\n\r\n            if ( primitive.extensions && primitive.extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ] ) {\r\n\r\n                // Use DRACO geometry if available\r\n                geometryPromise = createDracoPrimitive( primitive );\r\n\r\n            } else {\r\n\r\n                // Otherwise create a new geometry\r\n                geometryPromise = addPrimitiveAttributes( new THREE.BufferGeometry(), primitive, parser );\r\n\r\n            }\r\n\r\n            // Cache this geometry\r\n            cache[ cacheKey ] = { primitive: primitive, promise: geometryPromise };\r\n\r\n            pending.push( geometryPromise );\r\n\r\n        }\r\n\r\n    }\r\n\r\n    return Promise.all( pending ).then( function ( geometries ) {\r\n\r\n        if ( isMultiPass ) {\r\n\r\n            var baseGeometry = geometries[ 0 ];\r\n\r\n            // See if we've already created this combined geometry\r\n            var cache = parser.multiPassGeometryCache;\r\n            var cacheKey = createMultiPassGeometryKey( baseGeometry, originalPrimitives );\r\n            var cached = cache[ cacheKey ];\r\n\r\n            if ( cached !== null ) return [ cached.geometry ];\r\n\r\n            // Cloning geometry because of index override.\r\n            // Attributes can be reused so cloning by myself here.\r\n            var geometry = new THREE.BufferGeometry();\r\n\r\n            geometry.name = baseGeometry.name;\r\n            geometry.userData = baseGeometry.userData;\r\n\r\n            for ( var key in baseGeometry.attributes ) geometry.addAttribute( key, baseGeometry.attributes[ key ] );\r\n            for ( var key in baseGeometry.morphAttributes ) geometry.morphAttributes[ key ] = baseGeometry.morphAttributes[ key ];\r\n\r\n            var pendingIndices = [];\r\n\r\n            for ( var i = 0, il = originalPrimitives.length; i < il; i ++ ) {\r\n\r\n                pendingIndices.push( parser.getDependency( 'accessor', originalPrimitives[ i ].indices ) );\r\n\r\n            }\r\n\r\n            return Promise.all( pendingIndices ).then( function ( accessors ) {\r\n\r\n                var indices = [];\r\n                var offset = 0;\r\n\r\n                for ( var i = 0, il = originalPrimitives.length; i < il; i ++ ) {\r\n\r\n                    var accessor = accessors[ i ];\r\n\r\n                    for ( var j = 0, jl = accessor.count; j < jl; j ++ ) indices.push( accessor.array[ j ] );\r\n\r\n                    geometry.addGroup( offset, accessor.count, i );\r\n\r\n                    offset += accessor.count;\r\n\r\n                }\r\n\r\n                geometry.setIndex( indices );\r\n\r\n                cache[ cacheKey ] = { geometry: geometry, baseGeometry: baseGeometry, primitives: originalPrimitives };\r\n\r\n                return [ geometry ];\r\n\r\n            } );\r\n\r\n        } else if ( geometries.length > 1 && THREE.BufferGeometryUtils !== undefined ) {\r\n\r\n            // Tries to merge geometries with BufferGeometryUtils if possible\r\n\r\n            for ( var i = 1, il = primitives.length; i < il; i ++ ) {\r\n\r\n                // can't merge if draw mode is different\r\n                if ( primitives[ 0 ].mode !== primitives[ i ].mode ) return geometries;\r\n\r\n            }\r\n\r\n            // See if we've already created this combined geometry\r\n            var cache = parser.multiplePrimitivesCache;\r\n            var cacheKey = createArrayKeyBufferGeometry( geometries );\r\n            var cached = cache[ cacheKey ];\r\n\r\n            if ( cached ) {\r\n\r\n                if ( cached.geometry !== null ) return [ cached.geometry ];\r\n\r\n            } else {\r\n\r\n                var geometry = THREE.BufferGeometryUtils.mergeBufferGeometries( geometries, true );\r\n\r\n                cache[ cacheKey ] = { geometry: geometry, baseGeometries: geometries };\r\n\r\n                if ( geometry !== null ) return [ geometry ];\r\n\r\n            }\r\n\r\n        }\r\n\r\n        return geometries;\r\n\r\n    } );\r\n\r\n};\r\n\r\n/**\r\n * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#meshes\r\n * @param {number} meshIndex\r\n * @return {Promise<THREE.Group|THREE.Mesh|THREE.SkinnedMesh>}\r\n */\r\nGLTFParser.prototype.loadMesh = function ( meshIndex ) {\r\n\r\n    var parser = this;\r\n    var json = this.json;\r\n    var extensions = this.extensions;\r\n\r\n    var meshDef = json.meshes[ meshIndex ];\r\n    var primitives = meshDef.primitives;\r\n\r\n    var pending = [];\r\n\r\n    for ( var i = 0, il = primitives.length; i < il; i ++ ) {\r\n\r\n        var material = primitives[ i ].material === undefined\r\n            ? createDefaultMaterial()\r\n            : this.getDependency( 'material', primitives[ i ].material );\r\n\r\n        pending.push( material );\r\n\r\n    }\r\n\r\n    return Promise.all( pending ).then( function ( originalMaterials ) {\r\n\r\n        return parser.loadGeometries( primitives ).then( function ( geometries ) {\r\n\r\n            var isMultiMaterial = geometries.length === 1 && geometries[ 0 ].groups.length > 0;\r\n\r\n            var meshes = [];\r\n\r\n            for ( var i = 0, il = geometries.length; i < il; i ++ ) {\r\n\r\n                var geometry = geometries[ i ];\r\n                var primitive = primitives[ i ];\r\n\r\n                // 1. create Mesh\r\n\r\n                var mesh;\r\n\r\n                var material = isMultiMaterial ? originalMaterials : originalMaterials[ i ];\r\n\r\n                if ( primitive.mode === WEBGL_CONSTANTS.TRIANGLES ||\r\n                    primitive.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP ||\r\n                    primitive.mode === WEBGL_CONSTANTS.TRIANGLE_FAN ||\r\n                    primitive.mode === undefined ) {\r\n\r\n                    // .isSkinnedMesh isn't in glTF spec. See .markDefs()\r\n                    mesh = meshDef.isSkinnedMesh === true\r\n                        ? new THREE.SkinnedMesh( geometry, material )\r\n                        : new THREE.Mesh( geometry, material );\r\n\r\n                    if ( mesh.isSkinnedMesh === true ) mesh.normalizeSkinWeights(); // #15319\r\n\r\n                    if ( primitive.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP ) {\r\n\r\n                        mesh.drawMode = THREE.TriangleStripDrawMode;\r\n\r\n                    } else if ( primitive.mode === WEBGL_CONSTANTS.TRIANGLE_FAN ) {\r\n\r\n                        mesh.drawMode = THREE.TriangleFanDrawMode;\r\n\r\n                    }\r\n\r\n                } else if ( primitive.mode === WEBGL_CONSTANTS.LINES ) {\r\n\r\n                    mesh = new THREE.LineSegments( geometry, material );\r\n\r\n                } else if ( primitive.mode === WEBGL_CONSTANTS.LINE_STRIP ) {\r\n\r\n                    mesh = new THREE.Line( geometry, material );\r\n\r\n                } else if ( primitive.mode === WEBGL_CONSTANTS.LINE_LOOP ) {\r\n\r\n                    mesh = new THREE.LineLoop( geometry, material );\r\n\r\n                } else if ( primitive.mode === WEBGL_CONSTANTS.POINTS ) {\r\n\r\n                    mesh = new THREE.Points( geometry, material );\r\n\r\n                } else {\r\n\r\n                    throw new Error( 'THREE.GLTFLoader: Primitive mode unsupported: ' + primitive.mode );\r\n\r\n                }\r\n\r\n                if ( Object.keys( mesh.geometry.morphAttributes ).length > 0 ) {\r\n\r\n                    updateMorphTargets( mesh, meshDef );\r\n\r\n                }\r\n\r\n                mesh.name = meshDef.name || ( 'mesh_' + meshIndex );\r\n\r\n                if ( geometries.length > 1 ) mesh.name += '_' + i;\r\n\r\n                assignExtrasToUserData( mesh, meshDef );\r\n\r\n                meshes.push( mesh );\r\n\r\n                // 2. update Material depending on Mesh and BufferGeometry\r\n\r\n                var materials = isMultiMaterial ? mesh.material : [ mesh.material ];\r\n\r\n                var useVertexTangents = geometry.attributes.tangent !== undefined;\r\n                var useVertexColors = geometry.attributes.color !== undefined;\r\n                var useFlatShading = geometry.attributes.normal === undefined;\r\n                var useSkinning = mesh.isSkinnedMesh === true;\r\n                var useMorphTargets = Object.keys( geometry.morphAttributes ).length > 0;\r\n                var useMorphNormals = useMorphTargets && geometry.morphAttributes.normal !== undefined;\r\n\r\n                for ( var j = 0, jl = materials.length; j < jl; j ++ ) {\r\n\r\n                    var material = materials[ j ];\r\n\r\n                    if ( mesh.isPoints ) {\r\n\r\n                        var cacheKey = 'PointsMaterial:' + material.uuid;\r\n\r\n                        var pointsMaterial = parser.cache.get( cacheKey );\r\n\r\n                        if ( ! pointsMaterial ) {\r\n\r\n                            pointsMaterial = new THREE.PointsMaterial();\r\n                            THREE.Material.prototype.copy.call( pointsMaterial, material );\r\n                            pointsMaterial.color.copy( material.color );\r\n                            pointsMaterial.map = material.map;\r\n                            pointsMaterial.lights = false; // PointsMaterial doesn't support lights yet\r\n\r\n                            parser.cache.add( cacheKey, pointsMaterial );\r\n\r\n                        }\r\n\r\n                        material = pointsMaterial;\r\n\r\n                    } else if ( mesh.isLine ) {\r\n\r\n                        var cacheKey = 'LineBasicMaterial:' + material.uuid;\r\n\r\n                        var lineMaterial = parser.cache.get( cacheKey );\r\n\r\n                        if ( ! lineMaterial ) {\r\n\r\n                            lineMaterial = new THREE.LineBasicMaterial();\r\n                            THREE.Material.prototype.copy.call( lineMaterial, material );\r\n                            lineMaterial.color.copy( material.color );\r\n                            lineMaterial.lights = false; // LineBasicMaterial doesn't support lights yet\r\n\r\n                            parser.cache.add( cacheKey, lineMaterial );\r\n\r\n                        }\r\n\r\n                        material = lineMaterial;\r\n\r\n                    }\r\n\r\n                    // Clone the material if it will be modified\r\n                    if ( useVertexTangents || useVertexColors || useFlatShading || useSkinning || useMorphTargets ) {\r\n\r\n                        var cacheKey = 'ClonedMaterial:' + material.uuid + ':';\r\n\r\n                        if ( material.isGLTFSpecularGlossinessMaterial ) cacheKey += 'specular-glossiness:';\r\n                        if ( useSkinning ) cacheKey += 'skinning:';\r\n                        if ( useVertexTangents ) cacheKey += 'vertex-tangents:';\r\n                        if ( useVertexColors ) cacheKey += 'vertex-colors:';\r\n                        if ( useFlatShading ) cacheKey += 'flat-shading:';\r\n                        if ( useMorphTargets ) cacheKey += 'morph-targets:';\r\n                        if ( useMorphNormals ) cacheKey += 'morph-normals:';\r\n\r\n                        var cachedMaterial = parser.cache.get( cacheKey );\r\n\r\n                        if ( ! cachedMaterial ) {\r\n\r\n                            cachedMaterial = material.isGLTFSpecularGlossinessMaterial\r\n                                ? extensions[ EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS ].cloneMaterial( material )\r\n                                : material.clone();\r\n\r\n                            if ( useSkinning ) cachedMaterial.skinning = true;\r\n                            if ( useVertexTangents ) cachedMaterial.vertexTangents = true;\r\n                            if ( useVertexColors ) cachedMaterial.vertexColors = THREE.VertexColors;\r\n                            if ( useFlatShading ) cachedMaterial.flatShading = true;\r\n                            if ( useMorphTargets ) cachedMaterial.morphTargets = true;\r\n                            if ( useMorphNormals ) cachedMaterial.morphNormals = true;\r\n\r\n                            parser.cache.add( cacheKey, cachedMaterial );\r\n\r\n                        }\r\n\r\n                        material = cachedMaterial;\r\n\r\n                    }\r\n\r\n                    materials[ j ] = material;\r\n\r\n                    // workarounds for mesh and geometry\r\n\r\n                    if ( material.aoMap && geometry.attributes.uv2 === undefined && geometry.attributes.uv !== undefined ) {\r\n\r\n                        console.log( 'THREE.GLTFLoader: Duplicating UVs to support aoMap.' );\r\n                        geometry.addAttribute( 'uv2', new THREE.BufferAttribute( geometry.attributes.uv.array, 2 ) );\r\n\r\n                    }\r\n\r\n                    if ( material.isGLTFSpecularGlossinessMaterial ) {\r\n\r\n                        // for GLTFSpecularGlossinessMaterial(ShaderMaterial) uniforms runtime update\r\n                        mesh.onBeforeRender = extensions[ EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS ].refreshUniforms;\r\n\r\n                    }\r\n\r\n                }\r\n\r\n                mesh.material = isMultiMaterial ? materials : materials[ 0 ];\r\n\r\n            }\r\n\r\n            if ( meshes.length === 1 ) {\r\n\r\n                return meshes[ 0 ];\r\n\r\n            }\r\n\r\n            var group = new THREE.Group();\r\n\r\n            for ( var i = 0, il = meshes.length; i < il; i ++ ) {\r\n\r\n                group.add( meshes[ i ] );\r\n\r\n            }\r\n\r\n            return group;\r\n\r\n        } );\r\n\r\n    } );\r\n\r\n};\r\n\r\n/**\r\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#cameras\r\n * @param {number} cameraIndex\r\n * @return {Promise<THREE.Camera>}\r\n */\r\nGLTFParser.prototype.loadCamera = function ( cameraIndex ) {\r\n\r\n    var camera;\r\n    var cameraDef = this.json.cameras[ cameraIndex ];\r\n    var params = cameraDef[ cameraDef.type ];\r\n\r\n    if ( ! params ) {\r\n\r\n        console.warn( 'THREE.GLTFLoader: Missing camera parameters.' );\r\n        return;\r\n\r\n    }\r\n\r\n    if ( cameraDef.type === 'perspective' ) {\r\n\r\n        camera = new THREE.PerspectiveCamera( THREE.Math.radToDeg( params.yfov ), params.aspectRatio || 1, params.znear || 1, params.zfar || 2e6 );\r\n\r\n    } else if ( cameraDef.type === 'orthographic' ) {\r\n\r\n        camera = new THREE.OrthographicCamera( params.xmag / - 2, params.xmag / 2, params.ymag / 2, params.ymag / - 2, params.znear, params.zfar );\r\n\r\n    }\r\n\r\n    if ( cameraDef.name !== undefined ) camera.name = cameraDef.name;\r\n\r\n    assignExtrasToUserData( camera, cameraDef );\r\n\r\n    return Promise.resolve( camera );\r\n\r\n};\r\n\r\n/**\r\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#skins\r\n * @param {number} skinIndex\r\n * @return {Promise<Object>}\r\n */\r\nGLTFParser.prototype.loadSkin = function ( skinIndex ) {\r\n\r\n    var skinDef = this.json.skins[ skinIndex ];\r\n\r\n    var skinEntry = { joints: skinDef.joints };\r\n\r\n    if ( skinDef.inverseBindMatrices === undefined ) {\r\n\r\n        return Promise.resolve( skinEntry );\r\n\r\n    }\r\n\r\n    return this.getDependency( 'accessor', skinDef.inverseBindMatrices ).then( function ( accessor ) {\r\n\r\n        skinEntry.inverseBindMatrices = accessor;\r\n\r\n        return skinEntry;\r\n\r\n    } );\r\n\r\n};\r\n\r\n/**\r\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#animations\r\n * @param {number} animationIndex\r\n * @return {Promise<THREE.AnimationClip>}\r\n */\r\nGLTFParser.prototype.loadAnimation = function ( animationIndex ) {\r\n\r\n    var json = this.json;\r\n\r\n    var animationDef = json.animations[ animationIndex ];\r\n\r\n    var pendingNodes = [];\r\n    var pendingInputAccessors = [];\r\n    var pendingOutputAccessors = [];\r\n    var pendingSamplers = [];\r\n    var pendingTargets = [];\r\n\r\n    for ( var i = 0, il = animationDef.channels.length; i < il; i ++ ) {\r\n\r\n        var channel = animationDef.channels[ i ];\r\n        var sampler = animationDef.samplers[ channel.sampler ];\r\n        var target = channel.target;\r\n        var name = target.node !== undefined ? target.node : target.id; // NOTE: target.id is deprecated.\r\n        var input = animationDef.parameters !== undefined ? animationDef.parameters[ sampler.input ] : sampler.input;\r\n        var output = animationDef.parameters !== undefined ? animationDef.parameters[ sampler.output ] : sampler.output;\r\n\r\n        pendingNodes.push( this.getDependency( 'node', name ) );\r\n        pendingInputAccessors.push( this.getDependency( 'accessor', input ) );\r\n        pendingOutputAccessors.push( this.getDependency( 'accessor', output ) );\r\n        pendingSamplers.push( sampler );\r\n        pendingTargets.push( target );\r\n\r\n    }\r\n\r\n    return Promise.all( [\r\n\r\n        Promise.all( pendingNodes ),\r\n        Promise.all( pendingInputAccessors ),\r\n        Promise.all( pendingOutputAccessors ),\r\n        Promise.all( pendingSamplers ),\r\n        Promise.all( pendingTargets )\r\n\r\n    ] ).then( function ( dependencies ) {\r\n\r\n        var nodes = dependencies[ 0 ];\r\n        var inputAccessors = dependencies[ 1 ];\r\n        var outputAccessors = dependencies[ 2 ];\r\n        var samplers = dependencies[ 3 ];\r\n        var targets = dependencies[ 4 ];\r\n\r\n        var tracks = [];\r\n\r\n        for ( var i = 0, il = nodes.length; i < il; i ++ ) {\r\n\r\n            var node = nodes[ i ];\r\n            var inputAccessor = inputAccessors[ i ];\r\n            var outputAccessor = outputAccessors[ i ];\r\n            var sampler = samplers[ i ];\r\n            var target = targets[ i ];\r\n\r\n            if ( node === undefined ) continue;\r\n\r\n            node.updateMatrix();\r\n            node.matrixAutoUpdate = true;\r\n\r\n            var TypedKeyframeTrack;\r\n\r\n            switch ( PATH_PROPERTIES[ target.path ] ) {\r\n\r\n                case PATH_PROPERTIES.weights:\r\n\r\n                    TypedKeyframeTrack = THREE.NumberKeyframeTrack;\r\n                    break;\r\n\r\n                case PATH_PROPERTIES.rotation:\r\n\r\n                    TypedKeyframeTrack = THREE.QuaternionKeyframeTrack;\r\n                    break;\r\n\r\n                case PATH_PROPERTIES.position:\r\n                case PATH_PROPERTIES.scale:\r\n                default:\r\n\r\n                    TypedKeyframeTrack = THREE.VectorKeyframeTrack;\r\n                    break;\r\n\r\n            }\r\n\r\n            var targetName = node.name ? node.name : node.uuid;\r\n\r\n            var interpolation = sampler.interpolation !== undefined ? INTERPOLATION[ sampler.interpolation ] : THREE.InterpolateLinear;\r\n\r\n            var targetNames = [];\r\n\r\n            if ( PATH_PROPERTIES[ target.path ] === PATH_PROPERTIES.weights ) {\r\n\r\n                // node can be THREE.Group here but\r\n                // PATH_PROPERTIES.weights(morphTargetInfluences) should be\r\n                // the property of a mesh object under group.\r\n\r\n                node.traverse( function ( object ) {\r\n\r\n                    if ( object.isMesh === true && object.morphTargetInfluences ) {\r\n\r\n                        targetNames.push( object.name ? object.name : object.uuid );\r\n\r\n                    }\r\n\r\n                } );\r\n\r\n            } else {\r\n\r\n                targetNames.push( targetName );\r\n\r\n            }\r\n\r\n            // KeyframeTrack.optimize() will modify given 'times' and 'values'\r\n            // buffers before creating a truncated copy to keep. Because buffers may\r\n            // be reused by other tracks, make copies here.\r\n            for ( var j = 0, jl = targetNames.length; j < jl; j ++ ) {\r\n\r\n                var track = new TypedKeyframeTrack(\r\n                    targetNames[ j ] + '.' + PATH_PROPERTIES[ target.path ],\r\n                    THREE.AnimationUtils.arraySlice( inputAccessor.array, 0 ),\r\n                    THREE.AnimationUtils.arraySlice( outputAccessor.array, 0 ),\r\n                    interpolation\r\n                );\r\n\r\n                // Here is the trick to enable custom interpolation.\r\n                // Overrides .createInterpolant in a factory method which creates custom interpolation.\r\n                if ( sampler.interpolation === 'CUBICSPLINE' ) {\r\n\r\n                    track.createInterpolant = function InterpolantFactoryMethodGLTFCubicSpline( result ) {\r\n\r\n                        // A CUBICSPLINE keyframe in glTF has three output values for each input value,\r\n                        // representing inTangent, splineVertex, and outTangent. As a result, track.getValueSize()\r\n                        // must be divided by three to get the interpolant's sampleSize argument.\r\n\r\n                        return new GLTFCubicSplineInterpolant( this.times, this.values, this.getValueSize() / 3, result );\r\n\r\n                    };\r\n\r\n                    // Workaround, provide an alternate way to know if the interpolant type is cubis spline to track.\r\n                    // track.getInterpolation() doesn't return valid value for custom interpolant.\r\n                    track.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline = true;\r\n\r\n                }\r\n\r\n                tracks.push( track );\r\n\r\n            }\r\n\r\n        }\r\n\r\n        var name = animationDef.name !== undefined ? animationDef.name : 'animation_' + animationIndex;\r\n\r\n        return new THREE.AnimationClip( name, undefined, tracks );\r\n\r\n    } );\r\n\r\n};\r\n\r\n/**\r\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#nodes-and-hierarchy\r\n * @param {number} nodeIndex\r\n * @return {Promise<THREE.Object3D>}\r\n */\r\nGLTFParser.prototype.loadNode = function ( nodeIndex ) {\r\n\r\n    var json = this.json;\r\n    var extensions = this.extensions;\r\n    var parser = this;\r\n\r\n    var meshReferences = json.meshReferences;\r\n    var meshUses = json.meshUses;\r\n\r\n    var nodeDef = json.nodes[ nodeIndex ];\r\n\r\n    return ( function () {\r\n\r\n        // .isBone isn't in glTF spec. See .markDefs\r\n        if ( nodeDef.isBone === true ) {\r\n\r\n            return Promise.resolve( new THREE.Bone() );\r\n\r\n        } else if ( nodeDef.mesh !== undefined ) {\r\n\r\n            return parser.getDependency( 'mesh', nodeDef.mesh ).then( function ( mesh ) {\r\n\r\n                var node;\r\n\r\n                if ( meshReferences[ nodeDef.mesh ] > 1 ) {\r\n\r\n                    var instanceNum = meshUses[ nodeDef.mesh ] ++;\r\n\r\n                    node = mesh.clone();\r\n                    node.name += '_instance_' + instanceNum;\r\n\r\n                    // onBeforeRender copy for Specular-Glossiness\r\n                    node.onBeforeRender = mesh.onBeforeRender;\r\n\r\n                    for ( var i = 0, il = node.children.length; i < il; i ++ ) {\r\n\r\n                        node.children[ i ].name += '_instance_' + instanceNum;\r\n                        node.children[ i ].onBeforeRender = mesh.children[ i ].onBeforeRender;\r\n\r\n                    }\r\n\r\n                } else {\r\n\r\n                    node = mesh;\r\n\r\n                }\r\n\r\n                // if weights are provided on the node, override weights on the mesh.\r\n                if ( nodeDef.weights !== undefined ) {\r\n\r\n                    node.traverse( function ( o ) {\r\n\r\n                        if ( ! o.isMesh ) return;\r\n\r\n                        for ( var i = 0, il = nodeDef.weights.length; i < il; i ++ ) {\r\n\r\n                            o.morphTargetInfluences[ i ] = nodeDef.weights[ i ];\r\n\r\n                        }\r\n\r\n                    } );\r\n\r\n                }\r\n\r\n                return node;\r\n\r\n            } );\r\n\r\n        } else if ( nodeDef.camera !== undefined ) {\r\n\r\n            return parser.getDependency( 'camera', nodeDef.camera );\r\n\r\n        } else if ( nodeDef.extensions\r\n            && nodeDef.extensions[ EXTENSIONS.KHR_LIGHTS_PUNCTUAL ]\r\n            && nodeDef.extensions[ EXTENSIONS.KHR_LIGHTS_PUNCTUAL ].light !== undefined ) {\r\n\r\n            return parser.getDependency( 'light', nodeDef.extensions[ EXTENSIONS.KHR_LIGHTS_PUNCTUAL ].light );\r\n\r\n        } else {\r\n\r\n            return Promise.resolve( new THREE.Object3D() );\r\n\r\n        }\r\n\r\n    }() ).then( function ( node ) {\r\n\r\n        if ( nodeDef.name !== undefined ) {\r\n\r\n            node.name = THREE.PropertyBinding.sanitizeNodeName( nodeDef.name );\r\n\r\n        }\r\n\r\n        assignExtrasToUserData( node, nodeDef );\r\n\r\n        if ( nodeDef.extensions ) addUnknownExtensionsToUserData( extensions, node, nodeDef );\r\n\r\n        if ( nodeDef.matrix !== undefined ) {\r\n\r\n            var matrix = new THREE.Matrix4();\r\n            matrix.fromArray( nodeDef.matrix );\r\n            node.applyMatrix( matrix );\r\n\r\n        } else {\r\n\r\n            if ( nodeDef.translation !== undefined ) {\r\n\r\n                node.position.fromArray( nodeDef.translation );\r\n\r\n            }\r\n\r\n            if ( nodeDef.rotation !== undefined ) {\r\n\r\n                node.quaternion.fromArray( nodeDef.rotation );\r\n\r\n            }\r\n\r\n            if ( nodeDef.scale !== undefined ) {\r\n\r\n                node.scale.fromArray( nodeDef.scale );\r\n\r\n            }\r\n\r\n        }\r\n\r\n        return node;\r\n\r\n    } );\r\n\r\n};\r\n\r\n/**\r\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#scenes\r\n * @param {number} sceneIndex\r\n * @return {Promise<THREE.Scene>}\r\n */\r\nGLTFParser.prototype.loadScene = function () {\r\n\r\n    // scene node hierachy builder\r\n\r\n    function buildNodeHierachy( nodeId, parentObject, json, parser ) {\r\n\r\n        var nodeDef = json.nodes[ nodeId ];\r\n\r\n        return parser.getDependency( 'node', nodeId ).then( function ( node ) {\r\n\r\n            if ( nodeDef.skin === undefined ) return node;\r\n\r\n            // build skeleton here as well\r\n\r\n            var skinEntry;\r\n\r\n            return parser.getDependency( 'skin', nodeDef.skin ).then( function ( skin ) {\r\n\r\n                skinEntry = skin;\r\n\r\n                var pendingJoints = [];\r\n\r\n                for ( var i = 0, il = skinEntry.joints.length; i < il; i ++ ) {\r\n\r\n                    pendingJoints.push( parser.getDependency( 'node', skinEntry.joints[ i ] ) );\r\n\r\n                }\r\n\r\n                return Promise.all( pendingJoints );\r\n\r\n            } ).then( function ( jointNodes ) {\r\n\r\n                var meshes = node.isGroup === true ? node.children : [ node ];\r\n\r\n                for ( var i = 0, il = meshes.length; i < il; i ++ ) {\r\n\r\n                    var mesh = meshes[ i ];\r\n\r\n                    var bones = [];\r\n                    var boneInverses = [];\r\n\r\n                    for ( var j = 0, jl = jointNodes.length; j < jl; j ++ ) {\r\n\r\n                        var jointNode = jointNodes[ j ];\r\n\r\n                        if ( jointNode ) {\r\n\r\n                            bones.push( jointNode );\r\n\r\n                            var mat = new THREE.Matrix4();\r\n\r\n                            if ( skinEntry.inverseBindMatrices !== undefined ) {\r\n\r\n                                mat.fromArray( skinEntry.inverseBindMatrices.array, j * 16 );\r\n\r\n                            }\r\n\r\n                            boneInverses.push( mat );\r\n\r\n                        } else {\r\n\r\n                            console.warn( 'THREE.GLTFLoader: Joint \"%s\" could not be found.', skinEntry.joints[ j ] );\r\n\r\n                        }\r\n\r\n                    }\r\n\r\n                    mesh.bind( new THREE.Skeleton( bones, boneInverses ), mesh.matrixWorld );\r\n\r\n                }\r\n\r\n                return node;\r\n\r\n            } );\r\n\r\n        } ).then( function ( node ) {\r\n\r\n            // build node hierachy\r\n\r\n            parentObject.add( node );\r\n\r\n            var pending = [];\r\n\r\n            if ( nodeDef.children ) {\r\n\r\n                var children = nodeDef.children;\r\n\r\n                for ( var i = 0, il = children.length; i < il; i ++ ) {\r\n\r\n                    var child = children[ i ];\r\n                    pending.push( buildNodeHierachy( child, node, json, parser ) );\r\n\r\n                }\r\n\r\n            }\r\n\r\n            return Promise.all( pending );\r\n\r\n        } );\r\n\r\n    }\r\n\r\n    //return function loadScene( sceneIndex ) {\r\n        const sceneIndex = 0;\r\n\r\n        var json = this.json;\r\n        var extensions = this.extensions;\r\n        var sceneDef = this.json.scenes[ sceneIndex ];\r\n        var parser = this;\r\n\r\n        var scene = new THREE.Scene();\r\n        if ( sceneDef.name !== undefined ) scene.name = sceneDef.name;\r\n\r\n        assignExtrasToUserData( scene, sceneDef );\r\n\r\n        if ( sceneDef.extensions ) addUnknownExtensionsToUserData( extensions, scene, sceneDef );\r\n\r\n        var nodeIds = sceneDef.nodes || [];\r\n\r\n        var pending = [];\r\n\r\n        for ( var i = 0, il = nodeIds.length; i < il; i ++ ) {\r\n\r\n            pending.push( buildNodeHierachy( nodeIds[ i ], scene, json, parser ) );\r\n\r\n        }\r\n\r\n        return Promise.all( pending ).then( function () {\r\n\r\n            return scene;\r\n\r\n        } );\r\n\r\n    //};\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/gltfloader.js","import App from './js/app';\nimport Game from './js/game';\n\nfunction initApp() {\n  const app = new App();\n  const game = new Game();\n\n  const canvas = document.getElementById(\"canvas\");\n\n  game.init(canvas);\n  app.setGame(game);\n\n  // 게임을 시작한다\n  $('#foreground').click(function (event) {\n    // 마우스 상태정보를 업데이트한다\n    // TODO : 일괄 코드로 변경필요\n    var gamePos = $('#canvas').offset();\n\n    const mouse = {};\n    mouse.x = event.pageX - gamePos.left;\n    mouse.y = event.pageY - gamePos.top;\n          \n    game.click(mouse.x, mouse.y);\n  });\n\n  window.addEventListener('keydown', (e) => {\n    game.keyDown(e.keyCode);\n  },false);\n\n  // 플레이 버튼을 누르면 시작하게 해야 하지만... 일단은 그냥하자\n  app.start(\"TEST\");\n}\n\ninitApp();\n\n\n// WEBPACK FOOTER //\n// ./src/main.js","module.exports = {\"id\":\"spectre\",\"width\":34,\"height\":34,\"animations\":{\"atk_right\":{\"length\":8,\"row\":0},\"walk_right\":{\"length\":4,\"row\":1},\"idle_right\":{\"length\":2,\"row\":2},\"atk_up\":{\"length\":6,\"row\":3},\"walk_up\":{\"length\":8,\"row\":4},\"idle_up\":{\"length\":8,\"row\":5},\"atk_down\":{\"length\":6,\"row\":6},\"walk_down\":{\"length\":4,\"row\":7},\"idle_down\":{\"length\":2,\"row\":8}},\"offset_x\":-9,\"offset_y\":-13}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/spectre.json\n// module id = NxES\n// module chunks = 1","const EasingFunction = {\r\n    linear(w) {\r\n        return w\r\n    },\r\n\r\n    outCubic(w) {\r\n        w = w -1\r\n        return w*w*w + 1\r\n    },\r\n\r\n    inCubic(w) {\r\n        return w*w*w\r\n    },\r\n\r\n    inOutCubic(w) {\r\n        w = w * 2\r\n        if (w < 1) {\r\n            return w*w*w / 2\r\n        } else {\r\n            w = w - 2\r\n            return (w*w*w + 2) / 2\r\n        }\r\n    },\r\n\r\n    inOutSine(w) {\r\n        return (1 - Math.cos(Math.PI * w)) / 2\r\n    },\r\n\r\n    outExponential(w) {\r\n        if (w < 1) {\r\n            return 1- Math.pow(2, -10*w)\r\n        } else {\r\n            return 1\r\n        }\r\n    },\r\n\r\n    outBounce(w) {\r\n        if (w < 4/11.0) {\r\n            return (121 * w * w) / 16.0\r\n        } else if (w < 8/11.0) {\r\n            return  (363 / 40.0 * w * w) - (99 / 10.0 * w) + 17/5.0\r\n        } else if (w < 9/10.0) {\r\n            return (4356 / 361.0 * w * w) - (35442 / 1805.0 * w) + 16061/1805.0\r\n        } else {\r\n            return (54 / 5.0 * w * w) - (513 / 25.0 * w) + 268/25.0\r\n        }\r\n    },\r\n\r\n    outBack(w) {\r\n        const s = 1.70158\r\n        w = w - 1\r\n        return w*w*((s+1)*w+s) + 1\r\n    }\r\n};\r\n\r\n/*export declare interface MovieClipTween{\r\n    target: string\r\n    from: number\r\n    to: number\r\n    easing: Function\r\n}\r\n\r\n\r\nexport declare interface MovieClipTimeline {\r\n    start: number,\r\n    end: number,\r\n    sprite: Sprite,\r\n    tweens: MovieClipTween[]\r\n}*/\r\n\r\nconst MoveClipPlayMode = {\r\n    Loop: 1,\r\n    Stop: 2,\r\n    Destory: 3\r\n}\r\n\r\nexport default class MovieClip {\r\n    static Timeline(startFrame, endFrame, mesh, tweens) {\r\n        if (!Array.isArray(tweens)) {\r\n            tweens = [tweens]\r\n        }\r\n\r\n        return {\r\n            startFrame: startFrame,\r\n            endFrame: endFrame,\r\n            mesh: mesh,\r\n            tweens: tweens\r\n        }\r\n    }\r\n\r\n    constructor(...timelines) {\r\n\r\n        if (!Array.isArray(timelines)) {\r\n            timelines = [timelines]\r\n        }\r\n        \r\n        this._timelines = timelines\r\n        this._frame = 0\r\n        this._playing = false\r\n        this._stopHandler = null\r\n        this._mode = MoveClipPlayMode.Stop // 마지막에 정지가 가장 기본 모드이다\r\n\r\n        // 마지막 프레임을 찾는다\r\n        let lastFrame = 0\r\n        for(const tl of timelines) {\r\n            lastFrame = Math.max(lastFrame, tl.endFrame)\r\n        }\r\n        this._lastFrame = lastFrame\r\n    }\r\n    \r\n    playAndStop(handler) {\r\n        // 가장 기본적인 실행을 한다\r\n        // 마지막 프레임이 지나면 정지를 한다\r\n        this._playing = true\r\n        this._mode = MoveClipPlayMode.Stop\r\n        this._stopHandler = handler\r\n    }\r\n\r\n    playAndDestroy(handler) {\r\n        this._playing = true\r\n        this._mode = MoveClipPlayMode.Destory\r\n        this._stopHandler = handler\r\n    }\r\n\r\n    playLoop() {\r\n        this._playing = true\r\n        this._mode = MoveClipPlayMode.Loop\r\n    }\r\n\r\n    update() {\r\n        this._frame++\r\n        if (this._playing) {\r\n            if (this._frame >= this._lastFrame) {\r\n                // 플레이모드에 따라서 루프, 정지, 파괴를 선택한다\r\n                switch(this._mode) {\r\n                    case MoveClipPlayMode.Loop: {\r\n                        this._frame = 1\r\n                        break\r\n                    }\r\n                    case  MoveClipPlayMode.Destory: {\r\n                        if (this._stopHandler) {\r\n                            this._stopHandler()\r\n                        }\r\n                        return\r\n                    }\r\n                    default: {\r\n                        // 정지시킨다\r\n                        this._playing = false\r\n                        this._frame = this._lastFrame\r\n                        if (this._stopHandler) {\r\n                            this._stopHandler()\r\n                        }\r\n                        break\r\n                    }\r\n                }\r\n            }\r\n\r\n            for(const timeline of this._timelines) {\r\n                // 각각의 액션을 실행한다\r\n                if (this._frame < timeline.startFrame || timeline.endFrame < this._frame) {\r\n                    continue\r\n                }\r\n\r\n                const dist = timeline.endFrame - timeline.startFrame\r\n                const weight = dist > 0 ? (this._frame - timeline.startFrame) / dist : 0\r\n                const mesh = timeline.mesh;\r\n\r\n                for(const tween of timeline.tweens) {\r\n                    const target = tween[0];\r\n                    const from = tween[1];\r\n                    const to = tween[2];\r\n                    const easing = EasingFunction[tween[3]];\r\n\r\n                    const value = easing(weight) * (to - from) + from\r\n                    switch(target) {\r\n                        case \"scaleX\": {\r\n                            //mesh.setScale(value, image.scale.y)\r\n                            break\r\n                        }\r\n                        case \"scaleY\": {\r\n                            //image.setScale(image.scale.x, value)\r\n                            break\r\n                        }\r\n                        case \"scale\": {\r\n                            ///image.setScale(value, value)\r\n                            break\r\n                        }\r\n                        case \"x\": {\r\n                            //image.setPosition(value, image.y)\r\n                            mesh.position.x = value;\r\n                            break\r\n                        }\r\n                        case \"y\": {\r\n                            //image.setPosition(image.x, value)\r\n                            mesh.position.y = value;\r\n                            break\r\n                        }\r\n                        case \"alpha\": {\r\n                            mesh.material.transparent = true;\r\n                            mesh.material.opacity = value;\r\n                            break\r\n                        }\r\n                        case \"rotation\": {\r\n                            image.setRotation(value)\r\n                            break\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/movieclip.js","module.exports = {\"id\":\"deathknight\",\"width\":42,\"height\":42,\"animations\":{\"atk_right\":{\"length\":5,\"row\":0},\"walk_right\":{\"length\":4,\"row\":1},\"idle_right\":{\"length\":2,\"row\":2},\"atk_up\":{\"length\":5,\"row\":3},\"walk_up\":{\"length\":4,\"row\":4},\"idle_up\":{\"length\":2,\"row\":5},\"atk_down\":{\"length\":5,\"row\":6},\"walk_down\":{\"length\":4,\"row\":7},\"idle_down\":{\"length\":2,\"row\":8}},\"offset_x\":-13,\"offset_y\":-17}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/deathknight.json\n// module id = Oy9j\n// module chunks = 1","module.exports = {\"id\":\"eye\",\"width\":40,\"height\":48,\"animations\":{\"atk_right\":{\"length\":6,\"row\":0},\"walk_right\":{\"length\":4,\"row\":1},\"idle_right\":{\"length\":14,\"row\":2},\"atk_up\":{\"length\":4,\"row\":3},\"walk_up\":{\"length\":4,\"row\":4},\"idle_up\":{\"length\":14,\"row\":5},\"atk_down\":{\"length\":8,\"row\":6},\"walk_down\":{\"length\":4,\"row\":7},\"idle_down\":{\"length\":14,\"row\":8}},\"offset_x\":-12,\"offset_y\":-18}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/eye.json\n// module id = PznX\n// module chunks = 1","module.exports = {\"1.3.132.0.10\":\"secp256k1\",\"1.3.132.0.33\":\"p224\",\"1.2.840.10045.3.1.1\":\"p192\",\"1.2.840.10045.3.1.7\":\"p256\",\"1.3.132.0.34\":\"p384\",\"1.3.132.0.35\":\"p521\"}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/browserify-sign/browser/curves.json\n// module id = QDfD\n// module chunks = 1","module.exports = {\"id\":\"target\",\"width\":16,\"height\":16,\"animations\":{\"move\":{\"length\":4,\"row\":0},\"atk\":{\"length\":4,\"row\":1}}}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/target.json\n// module id = Qyla\n// module chunks = 1","module.exports = {\"id\":\"redarmor\",\"width\":32,\"height\":32,\"animations\":{\"atk_right\":{\"length\":5,\"row\":0},\"walk_right\":{\"length\":4,\"row\":1},\"idle_right\":{\"length\":2,\"row\":2},\"atk_up\":{\"length\":5,\"row\":3},\"walk_up\":{\"length\":4,\"row\":4},\"idle_up\":{\"length\":2,\"row\":5},\"atk_down\":{\"length\":5,\"row\":6},\"walk_down\":{\"length\":4,\"row\":7},\"idle_down\":{\"length\":2,\"row\":8}},\"offset_x\":-8,\"offset_y\":-12}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/redarmor.json\n// module id = RVzG\n// module chunks = 1","module.exports = {\"id\":\"item-redsword\",\"width\":16,\"height\":16,\"animations\":{\"idle\":{\"length\":6,\"row\":0}},\"offset_x\":0,\"offset_y\":0}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/item-redsword.json\n// module id = RZ8U\n// module chunks = 1","module.exports = {\"id\":\"item-flask\",\"width\":16,\"height\":16,\"animations\":{\"idle\":{\"length\":6,\"row\":0}},\"offset_x\":0,\"offset_y\":0}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/item-flask.json\n// module id = RgGw\n// module chunks = 1","import DisplayObject from './DisplayObject.js';\n\n/**\n * BitmapText\n * @extends ThreeUI.DisplayObject\n *\n * Used internally by ThreeUI, shouldn't be used directly\n * Use ThreeUI.createBitmapText instead to create text\n *\n * @param {ThreeUI} ui\n * @param {string} text\n * @param {float} scale\n * @param {int} x\n * @param {int} y\n */\n\nvar fallbackWidth = 6;\nvar fallbackHeight = 6;\n\nvar BitmapText = function(ui, text, scale, x, y, sheetImagePath, sheetDataPath) {\n\tthis.parseSheet(sheetImagePath, sheetDataPath);\n\n\tthis.scale = typeof scale !== 'undefined' ? scale : 1;\n\n\tthis.setText(text);\n\n\tvar x = typeof x !== 'undefined' ? x : 0;\n\tvar y = typeof y !== 'undefined' ? y : 0;\n\n\tvar dimensions = this.calculateDimensions();\n\n\t// Run DisplayObject constructor on this object\n\tDisplayObject.bind(this)(ui, x, y, dimensions.width, dimensions.height);\n\n\tthis.pivot.x = 0;\n\tthis.pivot.y = 0;\n};\n\nBitmapText.prototype = Object.create(DisplayObject.prototype);\n\n/**\n * Set the text of this BitmapText\n *\n * @param {string} text\n */\n\nBitmapText.prototype.setText = function(text) {\n\tif (this.text === text) return; // Safe-guard for update text spam\n\n\tthis.text = typeof text !== 'undefined' ? text.toString() : '';\n\tthis.characters = this.text.split('');\n\n\tvar dimensions = this.calculateDimensions();\n\tthis.width = dimensions.width;\n\tthis.height = dimensions.height;\n};\n\n/**\n * Parse a sheet from its image and data\n *\n * @param {string} sheetImagePath\n * @param {string} sheetDataPath\n */\n\nBitmapText.prototype.parseSheet = function(sheetImagePath, sheetDataPath) {\n\tif(typeof sheetImagePath === 'undefined' && !this.sheet) {\n\t\tthrow new Error('Sheet image path missing when creating sprite from sheet');\n\t}\n\n\tif(typeof sheetDataPath === 'undefined' && !this.sheetData) {\n\t\tthrow new Error('Sheet data path missing when creating sprite from sheet');\n\t}\n\n\tif (sheetImagePath || !this.sheet) {\n\t\tthis.sheet = AssetLoader.getAssetById(sheetImagePath);\n\t}\n\n\tif (sheetDataPath || !this.sheetData) {\n\t\tthis.sheetData = AssetLoader.getAssetById(sheetDataPath);\n\t}\n\n\tif (typeof this.sheetData !== 'object') {\n\t\tthrow new Error('Invalid sheet data ' + sheetDataPath + ' -- not an object');\n\t}\n\n\t// Parse all characters\n\tthis.characterData = {};\n\tvar keys = Object.keys(this.sheetData);\n\tvar length = keys.length;\n\tfor (var i = 0;i < length;i++) {\n\t\tvar char = keys[i];\n\t\tvar data = this.sheetData[char];\n\n\t\t// Make sure coords are within bounds\n\t\tdata['uv0'][0] = Math.min(1, Math.max(0, data['uv0'][0]));\n\t\tdata['uv0'][1] = Math.min(1, Math.max(0, data['uv0'][1]));\n\t\tdata['uv1'][0] = Math.min(1, Math.max(0, data['uv1'][0]));\n\t\tdata['uv1'][1] = Math.min(1, Math.max(0, data['uv1'][1]));\n\n\t\t// Calculate pixel coordinates\n\t\tthis.characterData[char] = {\n\t\t\tx: Math.round(data['uv0'][0] * this.sheet.width),\n\t\t\ty: Math.round((1 - data['uv0'][1]) * this.sheet.height),\n\t\t\twidth: Math.round((data['uv1'][0] - data['uv0'][0]) * this.sheet.width),\n\t\t\theight: Math.round((data['uv0'][1] - data['uv1'][1]) * this.sheet.height),\n\t\t};\n\n\t\t// Width and height need to be bigger than 0 or some browsers will break\n\t\tvar cData = this.characterData[char];\n\t\tcData.width = Math.max(0.00001, cData.width);\n\t\tcData.height = Math.max(0.00001, cData.height);\n\t}\n};\n\n/**\n * Calculates the dimensions of this BitmapText\n * Internal use only\n *\n * @return {object} {width, height}\n */\n\nBitmapText.prototype.calculateDimensions = function() {\n\tvar dimensions = {\n\t\twidth: 0,\n\t\theight: 0,\n\t};\n\n\tvar length = this.characters.length;\n\tfor (var i = 0;i < length;i++) {\n\t\tvar character = this.characters[i];\n\t\tif (!this.characterData[character]) {\n\t\t\t// Take dimensions of first existing character instead\n\t\t\tcharacter = Object.keys(this.characterData)[0];\n\t\t}\n\n\t\tvar data = this.characterData[character];\n\t\tdimensions.width += data ? data.width : 0;\n\t\tdimensions.height = Math.max(dimensions.height, data ? data.height : 0);\n\t}\n\n\tdimensions.width *= this.scale;\n\tdimensions.height *= this.scale;\n\n\treturn dimensions;\n};\n\n/**\n * Draw this BitmapText onto the provided context\n * Used internally by DisplayObject.render\n *\n * @param {CanvasRenderingContext2D} context\n * @param {int} x\n * @param {int} y\n */\n\nBitmapText.prototype.draw = function(context, x, y) {\n\tvar length = this.characters.length;\n\tfor (var i = 0;i < length;i++) {\n\t\tvar character = this.characters[i];\n\t\tvar bounds = this.drawCharacter(context, character, x, y);\n\n\t\t// Move up coordinates for the next character\n\t\tx = bounds.x + bounds.width;\n\t\ty = bounds.y;\n\t}\n};\n\n/**\n * Draw give character BitmapText onto the provided context\n * Used internally by DisplayObject.render\n *\n * @param {CanvasRenderingContext2D} context\n * @param {int} x\n * @param {int} y\n * @return {object} {x,y, width, height} returns bounding box\n */\n\nBitmapText.prototype.drawCharacter = function(context, character, x, y) {\n\tvar data = this.characterData[character];\n\tvar skipDraw = false;\n\n\tif (typeof data === 'undefined') { // Character does not exist in this BitmapText\n\t\tdata = {\n\t\t\twidth: fallbackWidth,\n\t\t\theight: fallbackHeight,\n\t\t};\n\t\tskipDraw = true;\n\t}\n\n\tvar width = data.width * this.scale;\n\tvar height = data.height * this.scale;\n\n\tif (!skipDraw) {\n\t\tcontext.drawImage(this.sheet, data.x, data.y, data.width, data.height, x, y, width, height);\n\t}\n\n\treturn {\n\t\tx: x,\n\t\ty: y,\n\t\twidth: width,\n\t\theight: height,\n\t};\n};\n\n\n// Export BitmapText as module\nexport default BitmapText;\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/three-ui/BitmapText.js","module.exports = {\"id\":\"item-goldenarmor\",\"width\":16,\"height\":16,\"animations\":{\"idle\":{\"length\":6,\"row\":0}},\"offset_x\":0,\"offset_y\":0}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/item-goldenarmor.json\n// module id = SML3\n// module chunks = 1","module.exports = {\"id\":\"death\",\"width\":24,\"height\":24,\"animations\":{\"death\":{\"length\":6,\"row\":0}},\"offset_x\":-4,\"offset_y\":-4}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/death.json\n// module id = Sqs0\n// module chunks = 1","\r\n export default class Transition {\r\n    constructor() {\r\n        this.startValue = 0;\r\n        this.endValue = 0;\r\n        this.duration = 0;\r\n        this.inProgress = false;\r\n    }\r\n\r\n    start(currentTime, updateFunction, stopFunction, startValue, endValue, duration) {\r\n        this.startTime = currentTime;\r\n        this.updateFunction = updateFunction;\r\n        this.stopFunction = stopFunction;\r\n        this.startValue = startValue;\r\n        this.endValue = endValue;\r\n        this.duration = duration;\r\n        this.inProgress = true;\r\n        this.count = 0;\r\n    }\r\n\r\n    step(currentTime) {\r\n        if(this.inProgress) {\r\n            if(this.count > 0) {\r\n                this.count -= 1;\r\n                log.debug(currentTime + \": jumped frame\");\r\n            }\r\n            else {\r\n                var elapsed = currentTime - this.startTime;\r\n        \r\n                if(elapsed > this.duration) {\r\n                    elapsed = this.duration;\r\n                }\r\n    \r\n                var diff = this.endValue - this.startValue;\r\n                var i = this.startValue + ((diff / this.duration) * elapsed);\r\n        \r\n                i = Math.round(i);\r\n        \r\n                if(elapsed === this.duration || i === this.endValue) {\r\n                    this.stop();\r\n                    if(this.stopFunction) {\r\n                        this.stopFunction();\r\n                    }\r\n                }\r\n                else if(this.updateFunction) {\r\n                    this.updateFunction(i);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    restart(currentTime, startValue, endValue) {\r\n        this.start(currentTime, this.updateFunction, this.stopFunction, startValue, endValue, this.duration);\r\n        this.step(currentTime);\r\n    }\r\n\r\n    stop() {\r\n        this.inProgress = false;\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/transition.js","module.exports = {\"id\":\"lavanpc\",\"width\":24,\"height\":24,\"animations\":{\"idle_down\":{\"length\":2,\"row\":0}},\"offset_x\":-4,\"offset_y\":-8}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/lavanpc.json\n// module id = Tb6K\n// module chunks = 1","module.exports = {\"id\":\"goldenarmor\",\"width\":32,\"height\":32,\"animations\":{\"atk_right\":{\"length\":5,\"row\":0},\"walk_right\":{\"length\":4,\"row\":1},\"idle_right\":{\"length\":2,\"row\":2},\"atk_up\":{\"length\":5,\"row\":3},\"walk_up\":{\"length\":4,\"row\":4},\"idle_up\":{\"length\":2,\"row\":5},\"atk_down\":{\"length\":5,\"row\":6},\"walk_down\":{\"length\":4,\"row\":7},\"idle_down\":{\"length\":2,\"row\":8}},\"offset_x\":-8,\"offset_y\":-12}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/goldenarmor.json\n// module id = UStB\n// module chunks = 1","module.exports = {\"id\":\"crab\",\"width\":32,\"height\":32,\"animations\":{\"death\":{\"length\":8,\"row\":0},\"atk_right\":{\"length\":7,\"row\":1},\"walk_right\":{\"length\":6,\"row\":2},\"idle_right\":{\"length\":4,\"row\":3},\"atk_up\":{\"length\":8,\"row\":4},\"idle_up\":{\"length\":4,\"row\":5},\"walk_up\":{\"length\":6,\"row\":6},\"atk_down\":{\"length\":8,\"row\":7},\"walk_down\":{\"length\":6,\"row\":8},\"idle_down\":{\"length\":7,\"row\":9}},\"offset_x\":-8,\"offset_y\":-8}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/crab.json\n// module id = UcV4\n// module chunks = 1","import Types from '../share/gametypes';\nimport Prop from './prop';\nimport Chest from './chest';\nimport Character from './character';\n\nclass EntityFactory {\n    static builders = [];\n    static createEntity(kind, id, name) {\n        if(!kind) {\n          \n            return;\n        }\n    \n        if(!_.isFunction(EntityFactory.builders[kind])) {\n            throw Error(kind + \" is not a valid Entity type\");\n        }\n        return EntityFactory.builders[kind](id, name);\n    };\n}\n\nEntityFactory.builders[Types.Entities.DEATHKNIGHT] = function(id) {\n    const entity = new Character(id, Types.Entities.DEATHKNIGHT);\n    return entity;\n};\n\nEntityFactory.builders[Types.Entities.CHEST] = function(id) {\n    return new Chest(id);\n};\n\nEntityFactory.builders[Types.Entities.FIRE] = function(id) {\n    const prop= new Prop(id, Types.Entities.FIRE);\n    prop.attachPointLight(0xffc0a0, 1);\n    return prop;\n};\n\nexport default EntityFactory;\n\n\n// WEBPACK FOOTER //\n// ./src/js/entityfactory.js","import anchors from './anchors.js';\n\n/**\n * DisplayObject\n *\n * Used internally by ThreeUI, shouldn't be used directly\n * Use ThreeUI.createSprite and ThreeUI.createRectangle methods instead\n *\n * @param {ThreeUI} ui\n * @param {string} assetId\n * @param {int} x\n * @param {int} y\n */\n\nvar DisplayObject = function(ui, x, y, width, height) {\n\tthis.ui = ui;\n\tthis.x = typeof x !== 'undefined' ? x : 0;\n\tthis.y = typeof y !== 'undefined' ? y : 0;\n\tthis.width = typeof width !== 'undefined' ? width : 0;\n\tthis.height = typeof height !== 'undefined' ? height : 0;\n\tthis.rotation = 0;\n\tthis.alpha = 1;\n\tthis.visible = true;\n\tthis.pivot = {\n\t\tx: 0.5,\n\t\ty: 0.5\n\t};\n\tthis.anchor = {\n\t\tx: anchors.left,\n\t\ty: anchors.top\n\t};\n\tthis.smoothing = true;\n\tthis.stretch = {\n\t\tx: false,\n\t\ty: false\n\t};\n\tthis.offset = {\n\t\tleft: 0,\n\t\ttop: 0,\n\t\tright: 0,\n\t\tbottom: 0\n\t};\n\tthis.parent = undefined;\n};\n\n/**\n * Get the bounds for the DisplayObject's position in the canvas\n *\n * @return {Object} position {x, y, width, height}\n */\n\nDisplayObject.prototype.getBounds = function() {\n\tvar position = this.determinePositionInCanvas();\n\tvar dimensions = this.determineDimensionsInCanvas();\n\n\treturn {\n\t\tx: position.x,\n\t\ty: position.y,\n\t\twidth: dimensions.width,\n\t\theight: dimensions.height\n\t};\n};\n\n/**\n * Get the bounds for this DisplayObject's parent\n *\n * @return {Object} position {x, y, width, height}\n */\n\nDisplayObject.prototype.getParentBounds = function () {\n\tif (typeof this.parent === 'undefined') {\n\t\treturn {\n\t\t\tx: 0,\n\t\t\ty: 0,\n\t\t\twidth: this.ui.width,\n\t\t\theight: this.ui.height\n\t\t};\n\t} else if (this.parent instanceof DisplayObject) {\n\t\treturn this.parent.getBounds();\n\t} else {\n\t\tthrow new Error('DisplayObject.parent should always be an instance of DisplayObject');\n\t}\n};\n\n/**\n * Determine the DisplayObject's actual position in the canvas based on anchor and pivot\n *\n * @return {Object} position {x, y}\n */\n\nDisplayObject.prototype.determinePositionInCanvas = function() {\n\tvar position = {\n\t\tx: typeof this.x === 'number' ? this.x : 0,\n\t\ty: typeof this.y === 'number' ? this.y : 0\n\t};\n\n\tposition = this.adjustPositionForAnchor(position.x, position.y);\n\tposition = this.adjustPositionForPivot(position.x, position.y);\n\n\treturn position;\n};\n\n/**\n * Determine the DisplayObject's actual dimensions in the canvas based on stretching\n *\n * @return {Object} dimensions {width, height}\n */\n\nDisplayObject.prototype.determineDimensionsInCanvas = function() {\n\tvar dimensions = {\n\t\twidth: typeof this.width === 'number' ? this.width : 0,\n\t\theight: typeof this.height === 'number' ? this.height : 0\n\t};\n\t\n\treturn dimensions;\n};\n\n\n/**\n * Adjust given position for anchor\n *\n * @param {int} x\n * @param {int} y\n * @return {Object} position {x, y}\n */\n\nDisplayObject.prototype.adjustPositionForAnchor = function(x , y) {\n\tvar parentBounds = this.getParentBounds();\n\n\t// Adjust position for X anchor\n\tif (this.anchor.x === anchors.left) {\n\t\tx += parentBounds.x;\n\t} else if (this.anchor.x === anchors.right) {\n\t\tx += (parentBounds.x + parentBounds.width - this.width);\n\t} else if (this.anchor.x === anchors.center) {\n\t\tx += (parentBounds.x + parentBounds.width/2 - this.width/2);\n\t}\n\n\n\t// Adjust position for Y anchor\n\tif (this.anchor.y === anchors.top) {\n\t\ty += parentBounds.y;\n\t} else if (this.anchor.y === anchors.bottom) {\n\t\ty += parentBounds.y + parentBounds.height - this.height;\n\t} else if (this.anchor.y === anchors.center) {\n\t\ty += parentBounds.y + parentBounds.height/2 - this.height/2;\n\t}\n\n\treturn {\n\t\tx: x,\n\t\ty: y\n\t};\n};\n\n/**\n * Gets calculated offset in canvas space\n *\n * @return {Object} offset {x, y}\n */\n\nDisplayObject.prototype.getOffsetInCanvas = function() {\n\tvar offset = {\n\t\tleft: this.offset.left,\n\t\ttop: this.offset.top,\n\t\tright: this.offset.right,\n\t\tbottom: this.offset.bottom,\n\t};\n\n\t// Transform percentage offsets to numbers\n\tvar parentBounds;\n\n\tvar keys = Object.keys(offset);\n\tvar length = keys.length;\n\tfor (var i = 0;i < length;i++) {\n\t\tvar key = keys[i];\n\t\tvar value = offset[key];\n\t\tif (typeof value !== 'number') {\n\t\t\tparentBounds = parentBounds || this.getParentBounds();\n\n\t\t\tvar percValue = parseFloat(value.match(/^([0-9\\.]+)%$/)[1]);\n\t\t\toffset[key] = percValue / 100 * parentBounds.width;\n\t\t}\n\t}\n\n\treturn offset;\n};\n\n/**\n * Adjust given position for pivot\n *\n * @param {int} x\n * @param {int} y\n * @return {Object} position {x, y}\n */\n\nDisplayObject.prototype.adjustPositionForPivot = function(x , y) {\n\t// Adjust position for pivot\n\tx = x - this.width * this.pivot.x;\n\ty = y - this.height * this.pivot.y;\n\n\treturn {\n\t\tx: x,\n\t\ty: y\n\t};\n};\n\n/**\n * Should this DisplayObject receive events in its current state?\n */\n\nDisplayObject.prototype.shouldReceiveEvents = function() {\n\treturn this.visible;\n};\n\n/**\n * Attach a click event handler to this DisplayObject\n *\n * @param {Function} callback\n */\n\nDisplayObject.prototype.onClick = function(callback) {\n\tthis.ui.addEventListener('click', callback, this);\n};\n\n/**\n * Render this DisplayObject onto the provided context\n *\n * @param {CanvasRenderingContext2D} context\n */\n\nDisplayObject.prototype.render = function(context) {\n\tif (!this.visible) return;\n\n\tcontext.save();\n\n\tvar bounds = this.getBounds();\n\n\t/*if (this.rotation) { // Rotation is in degrees\n\t\tvar radians = (Math.PI / 180) * this.rotation;\n\n\t\tvar pivotAdjustment = this.adjustPositionForPivot(0, 0);\n\t\tvar moveX = bounds.x - pivotAdjustment.x;\n \t\tvar moveY = bounds.y - pivotAdjustment.y;\n\n\t\tcontext.translate(moveX, moveY);\n\t\tcontext.rotate(radians);\n\t\tcontext.translate(-moveX, -moveY);\n\t}*/\n\n\tcontext.globalAlpha = this.alpha;\n\n\tif (typeof context['mozImageSmoothingEnabled'] !== 'undefined') context['mozImageSmoothingEnabled'] = this.smoothing;\n\tif (typeof context['webkitImageSmoothingEnabled'] !== 'undefined') context['webkitImageSmoothingEnabled'] = this.smoothing;\n\tif (typeof context['msImageSmoothingEnabled'] !== 'undefined') context['msImageSmoothingEnabled'] = this.smoothing;\n\tif (typeof context['imageSmoothingEnabled'] !== 'undefined') context['imageSmoothingEnabled'] = this.smoothing;\n\n\tthis.draw(context, bounds.x, bounds.y, bounds.width, bounds.height);\n\n\tcontext.restore();\n};\n\n/**\n * Draw the current sprite on the provided context, varies per DisplayObject type\n *\n * @param {CanvasRenderingContext2D} context\n * @param {int} x\n * @param {int} y\n * @param {int} width\n * @param {int} height\n */\n\nDisplayObject.draw = function(context, x, y, width, height) {\n\t// Override me\n};\n\n/**\n * Getter for visibility\n */\nObject.defineProperty(DisplayObject.prototype, '_proxied_visible', { // Set on proxied, as we're already observing\n\tget: function() {\n\t\tif (this.parent && this.parent !== this && !this.parent.visible) {\n\t\t\treturn false;\n\t\t} else {\n\t\t\treturn this._visible;\n\t\t}\n\t},\n\tset: function(toggle) {\n\t\treturn this._visible = toggle;\n\t},\n});\n\n\n// Export DisplayObject as module\nexport default DisplayObject;\n\n\n// WEBPACK FOOTER //\n// ./src/lib/three-ui/DisplayObject.js","export default class Phase {\n\n    begin() {\n        if (this.begin_callback) {\n            this.begin_callback();\n        }\n    }\n\n    end() {\n        if (this.end_callback) {\n            this.end_callback();\n        }\n    }\n\n    click(x, y) {\n        if (this.click_callback) {\n            this.click_callback(x, y);\n        }\n    }\n\n    onBegin(callback) {\n        this.begin_callback = callback;\n    }\n\n    onEnd(callback) {\n        this.end_callback = callback;\n    }\n\n    transitionTo(phase) {\n        // 현재 페이즈에서 다음 페이즈로 넘어간다\n    }\n\n    onClick(callback) {\n        this.click_callback = callback;\n    }\n\n    onUpdate(callback) {\n        this.update_callback = callback;\n    }\n\n    update() {\n        if (this.update_callback) {\n            this.update_callback();\n        }\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/phase.js","import Phase from \"./phase\";\r\nimport { timingSafeEqual } from \"crypto\";\r\n\r\nclass GameSprite {\r\n    constructor(image) {\r\n        this.image = image;\r\n        this.x = 0;\r\n        this.y = 0;\r\n        this.attackRange = 32;\r\n        this.moveSpeed = 1;\r\n        this.offset = { x: 0, y: 0};\r\n        this.target = null;\r\n\r\n        this.flipX = false;\r\n        \r\n        this.anims = {\r\n            \"idle\" : {\r\n                animRow:2,\r\n                animFrameCount:2,\r\n            },\r\n            \"walk\" : {\r\n                animRow:1,\r\n                animFrameCount:4,\r\n            },\r\n            \"attack\": {\r\n                animRow: 0,\r\n                animFrameCount:5,\r\n            }\r\n        }\r\n        this.currentFrame = 0;\r\n        this.currentFrameMax = 2;\r\n        this.currentRow = 2;\r\n        this.state = \"idle\";\r\n\r\n        this.utime = Date.now() + 200;\r\n        this.tilesize = 32;\r\n\r\n        this.health = 100;\r\n        this.Maxhealth = 100;\r\n    }\r\n\r\n    setAnim(name) {\r\n        if (this.state !== name) {\r\n            this.state = name;\r\n            this.currentFrame = 0;\r\n            this.currentRow = this.anims[name].animRow;\r\n            this.currentFrameMax = this.anims[name].animFrameCount;\r\n        }\r\n    }\r\n\r\n    render(ctx) {\r\n\r\n        ctx.save();\r\n        ctx.translate(this.x + this.offset.x, this.y + this.offset.y);\r\n        if (this.flipX) {\r\n            ctx.translate(this.tilesize, 0);\r\n            ctx.scale(-1, 1);\r\n        } \r\n        ctx.drawImage(this.image, this.currentFrame * this.tilesize, this.currentRow * this.tilesize, this.tilesize, this.tilesize, 0, 0, this.tilesize, this.tilesize);\r\n\r\n        // 헬스바를 그린다\r\n        // 길이는 32 전체 체력분의 비율을 표시한다\r\n        const healthbarSize = this.tilesize;\r\n        ctx.fillStyle = \"#000\";\r\n        ctx.fillRect(-1, -4, healthbarSize + 2, 4);\r\n        ctx.fillStyle = \"#F00\";\r\n        ctx.fillRect(0, -3, (healthbarSize * this.health / this.Maxhealth), 2);\r\n\r\n        ctx.restore();\r\n    }\r\n\r\n\r\n\r\n    update()  {\r\n        let hit = false;\r\n        if (this.utime <= Date.now()) {\r\n            this.utime += 200;\r\n            this.currentFrame = (this.currentFrame + 1) % this.currentFrameMax;\r\n\r\n            if (this.currentFrame == 3 && this.state === \"attack\") {\r\n                hit = true;\r\n            }\r\n        }\r\n\r\n        if (this.target) {\r\n\r\n            const dist = this.target.x - this.x;\r\n            if(Math.abs(dist) > this.attackRange) {\r\n                if (dist > 0) {\r\n                    this.x += this.moveSpeed;\r\n                } else {\r\n                    this.x -= this.moveSpeed;\r\n                }\r\n\r\n                this.setAnim(\"walk\");\r\n\r\n            } else {\r\n                this.setAnim(\"attack\");\r\n\r\n                if (hit) {\r\n                    this.animFrameCount\r\n                    this.target.health = Math.max(0, this.target.health - 10);\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nexport default class Battle extends Phase {\r\n    constructor(game) {\r\n        super();\r\n        const canvas = document.getElementById(\"foreground\");\r\n        const context = canvas.getContext('2d');\r\n\r\n        // 플레이어와 적을 2D Sprite 로 가져온다.\r\n        const player = new GameSprite(game.sprites[\"clotharmor\"].image);\r\n        const enemy = new GameSprite(game.sprites[\"deathknight\"].image);\r\n\r\n        player.x = 200;\r\n        player.y = 200\r\n        player.offset.y = 5;\r\n        player.target = enemy;\r\n\r\n        enemy.x = 600;\r\n        enemy.y = 200;\r\n        enemy.tilesize = 42;\r\n        enemy.target = player;\r\n        enemy.flipX = true;\r\n\r\n        this.onUpdate(() => {\r\n            player.update();\r\n            enemy.update();\r\n\r\n            const boarder = 3;\r\n            context.fillStyle = \"#ffffff\";\r\n            context.fillRect(150 - boarder, 120 - boarder, 500 + boarder*2, 200 + boarder*2);\r\n\r\n            // 여기서 2D 를 렌더링을 한다\r\n            context.fillStyle = \"#606060\";\r\n            context.fillRect(150, 120, 500, 200);\r\n            context.fillStyle = \"#101010\";\r\n            context.fillRect(150, 232, 500, 87);\r\n            player.render(context);\r\n            enemy.render(context);\r\n\r\n            \r\n            if (enemy.health === 0) {\r\n                // 승리\r\n                player.target = null;\r\n                player.setAnim(\"idle\");\r\n                context.font = \"50px Arial\";\r\n                context.fillStyle = \"white\";\r\n                context.textAlign  = \"center\";\r\n                context.fillText(\"Victory\", 400, 160);\r\n            }\r\n        });\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/battle2.js","import Phase from \"./phase\";\nimport Battle from \"./battle2\";\n\nexport default class Cutscene extends Phase {\n    constructor(game, kind) {\n        super();\n\n        this.game = game;\n        this.kind = kind;\n\n        this.onBegin(() => {\n            if (kind === \"enter\") {\n                // 플레이어를 위치에 옮기고 페이드인을 시도한다\n                game.player.mesh.visible = false;\n                this.skipFrame = 60;\n            }\n        });\n\n        this.onUpdate(() => {\n            if (kind === \"enter\") {\n                if (this.skipFrame > 0) {\n                    --this.skipFrame;\n                } else {\n                    if (game.player.mesh.visible) {\n                        if (!game.player.isFading) {\n                            // 여기서 다음 페이즈로 넘어간다\n                            ///game.nextPhase = new Battle(game);\n                        }\n                    } else {\n                        game.player.mesh.visible = true;\n                        game.player.spriteMesh.material.opacity = 0;\n                        game.player.fadeIn(game.currentTime);\n                    }\n                }\n            }\n            \n        });\n    }\n\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/cutscene.js","module.exports = {\"id\":\"item-bluesword\",\"width\":16,\"height\":16,\"animations\":{\"idle\":{\"length\":6,\"row\":0}},\"offset_x\":0,\"offset_y\":0}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/item-bluesword.json\n// module id = ZBgj\n// module chunks = 1","import Types from '../share/gametypes';\r\nimport Prop from \"./prop\";\r\n\r\nexport default class Chest extends Prop {\r\n    constructor(id) { \r\n        super(id, Types.Entities.CHEST);\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/chest.js","module.exports = {\"id\":\"forestnpc\",\"width\":24,\"height\":24,\"animations\":{\"idle_down\":{\"length\":2,\"row\":0}},\"offset_x\":-4,\"offset_y\":-8}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/forestnpc.json\n// module id = aNYQ\n// module chunks = 1","import DisplayObject from './DisplayObject.js';\n\n/**\n * Sprite\n * @extends ThreeUI.DisplayObject\n * \n * Used internally by ThreeUI, shouldn't be used directly\n * Use ThreeUI.createSprite instead to create sprites\n * \n * @param {ThreeUI} ui\n * @param {string} assetPath \n * @param {int} x \n * @param {int} y \n * @param {int} width\n * @param {int} height\n */\n\nvar Sprite = function(ui, assetPath, x, y, width, height, sheetImagePath, sheetDataPath) {\n\tthis.setAssetPath(assetPath, sheetImagePath, sheetDataPath);\n\n\tvar x = typeof x !== 'undefined' ? x : 0;\n\tvar y = typeof y !== 'undefined' ? y : 0;\n\tvar width = typeof width !== 'undefined' ? width : null;\n\tvar height = typeof height !== 'undefined' ? height : null;\n\n\tif (this.asset) {\n\t\twidth = width !== null ? width : this.asset.width;\n\t\theight = height !== null ? height : this.asset.height;\n\t} else if (this.sheet && this.sheetImageData) {\n\t\twidth = width !== null ? width : this.sheetImageData['frame']['w'];\n\t\theight = height !== null ? height : this.sheetImageData['frame']['h'];\n\t}\n\n\t// Run DisplayObject constructor on this object\n\tDisplayObject.bind(this)(ui, x, y, width, height);\n};\n\nSprite.prototype = Object.create(DisplayObject.prototype);\n\n/**\n * Draw this Sprite onto the provided context\n * Used internally by DisplayObject.render\n * \n * @param {CanvasRenderingContext2D} context\n * @param {int} x\n * @param {int} y\n * @param {int} width\n * @param {int} height\n */\n\nSprite.prototype.draw = function(context, x, y, width, height) {\n\tif (this.sheet && this.sheetImageData) {\n\t\t// We're handling a sprite from a sheet\n\t\tcontext.drawImage(this.sheet, this.sheetImageData['frame']['x'], this.sheetImageData['frame']['y'], this.sheetImageData['frame']['w'], this.sheetImageData['frame']['h'], x, y, width, height);\n\t} else {\n\t\tcontext.drawImage(this.asset, x, y, width, height);\n\t}\n};\n\n/**\n * Adjust the asset ID of this sprite\n * \n * @param {string} assetPath\n * @param {string} sheetImagePath\n * @param {string} sheetDataPath\n */\n\nSprite.prototype.setAssetPath = function(assetPath, sheetImagePath, sheetDataPath) {\n\tthis.assetPath = assetPath;\n\tif (typeof sheetImagePath === 'undefined' && !this.sheet) {\n\t\tthis.asset = AssetLoader.getAssetById(assetPath);\n\t\tthis.sheet = null;\n\t} else {\n\t\tthis.asset = null;\n\t\tthis.parseSheet(assetPath, sheetImagePath, sheetDataPath)\n\t}\n};\n\n/**\n * Parse a sheet from its image and data\n * \n * @param {string} sheetImagePath\n * @param {string} sheetDataPath\n */\n\nSprite.prototype.parseSheet = function(assetPath, sheetImagePath, sheetDataPath) {\n\tif(typeof sheetDataPath === 'undefined' && !this.sheetData) {\n\t\tthrow new Error('Sheet data path missing when creating sprite from sheet');\n\t}\n\n\tif (sheetImagePath || !this.sheet) {\n\t\tthis.sheet = AssetLoader.getAssetById(sheetImagePath);\n\t}\n\n\tif (sheetDataPath || !this.sheetData) {\n\t\tthis.sheetData = AssetLoader.getAssetById(sheetDataPath);\n\t}\n\n\tif (typeof this.sheetData !== 'object') {\n\t\tthrow new Error('Invalid sheet data ' + sheetDataPath + ' -- not an object');\n\t} else if(!this.sheetData['frames']) {\n\t\tthrow new Error('Invalid sheet data ' + sheetDataPath + ' -- does not have frames');\n\t}\n\n\tvar data;\n\tthis.sheetData['frames'].forEach(function(frame) {\n\t\tif (frame['filename'] === assetPath) {\n\t\t\tdata = frame;\n\t\t}\n\t});\t\n\n\tif (!data) {\n\t\tthrow new Error('Asset \"' + assetPath + '\" does not exist in sheet \"' + sheetDataPath + '\"');\n\t}\n\n\tthis.sheetImageData = data;\n};\n\n// Export Sprite as module\nexport default Sprite;\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/three-ui/Sprite.js","import Player from './player';\r\nimport Updater from './updater';\r\nimport Map from './map';\r\nimport Pathfinder from './pathfinder';\r\nimport Entity from './entity';\r\nimport EntityFactory from './entityfactory';\r\nimport GLTFLoader from './gltfloader';\r\nimport Types from '../share/gametypes';\r\n\r\nimport OrbitControls  from 'three-orbitcontrols';\r\nimport Chest from './chest';\r\nimport Cutscene from './cutscene';\r\n\r\nimport ThreeUI from '../lib/three-ui/ThreeUI';\r\nimport GameWorld from './gameworld';\r\n\r\nimport SpriteData from './sprites';\r\nimport '../lib/bokehshader2';\r\nimport Character from './character';\r\nimport MovieClip from './movieclip';\r\n\r\nexport default class Game {\r\n    init(canvas) {\r\n\r\n        const width = canvas.width;\r\n        const height = canvas.height;\r\n        this.canvas = canvas;\r\n\r\n        const renderer = new THREE.WebGLRenderer({canvas: canvas});\r\n        renderer.shadowMap.enabled = true;\r\n        renderer.setPixelRatio( window.devicePixelRatio );\r\n        renderer.setSize( width, height);\r\n        renderer.autoClear = false;\r\n\r\n        const camera = new THREE.PerspectiveCamera( 20, canvas.width / canvas.height, 1, 3000 );\r\n        /*const aspect = canvas.width / canvas.height;\r\n        const frustumSize = 250;\r\n        const camera = new THREE.OrthographicCamera( frustumSize * aspect / - 2, frustumSize * aspect / 2, frustumSize / 2, frustumSize / - 2, 1, 1000 );\r\n        camera.position.set( frustumSize, frustumSize, frustumSize );*/\r\n\r\n\r\n        const ui = new ThreeUI(canvas, height);\r\n\r\n        this.renderer = renderer;\r\n        this.camera = camera;\r\n        this.ui = ui;\r\n\r\n        //===========================\r\n        const scene = new THREE.Scene();\r\n        this.scene = scene;\r\n        \r\n        // TODO : 카메라 시선을 플레이어에 맞추어야 한다\r\n        //new OrbitControls(camera, renderer.domElement)\r\n\r\n        // 게임 정보\r\n        this.entities = {};\r\n        this.entityGrid = null;\r\n        this.phase = null;\r\n        this.nextPhase = null;\r\n\r\n        this.initPostprocessing(width, height);\r\n    }\r\n\r\n    initPostprocessing(width, height) {\r\n        const postprocessing = { enabled: true };\r\n\r\n        const depthShader = THREE.BokehDepthShader;\r\n        const materialDepth = new THREE.ShaderMaterial( {\r\n            uniforms: depthShader.uniforms,\r\n            vertexShader: depthShader.vertexShader,\r\n            fragmentShader: depthShader.fragmentShader\r\n        } );\r\n\r\n        materialDepth.uniforms[ 'mNear' ].value = this.camera.near;\r\n\t\tmaterialDepth.uniforms[ 'mFar' ].value = this.camera.far;\r\n        postprocessing.materialDepth = materialDepth;\r\n\r\n        const shaderSettings = {\r\n            rings: 3,\r\n            samples: 4\r\n        };\r\n        \r\n        postprocessing.scene = new THREE.Scene();\r\n        postprocessing.camera = new THREE.OrthographicCamera( width / - 2, width / 2, height / 2, height / - 2, - 10000, 10000 );\r\n        postprocessing.camera.position.z = 100;\r\n        postprocessing.scene.add( postprocessing.camera );\r\n        const pars = { minFilter: THREE.LinearFilter, magFilter: THREE.LinearFilter, format: THREE.RGBFormat };\r\n        postprocessing.rtTextureDepth = new THREE.WebGLRenderTarget( width, height, pars );\r\n        postprocessing.rtTextureColor = new THREE.WebGLRenderTarget( width, height, pars );\r\n\r\n        const bokeh_shader = THREE.BokehShader;\r\n        \r\n        postprocessing.bokeh_uniforms = THREE.UniformsUtils.clone( bokeh_shader.uniforms );\r\n        postprocessing.bokeh_uniforms[ 'tColor' ].value = postprocessing.rtTextureColor.texture;\r\n        postprocessing.bokeh_uniforms[ 'tDepth' ].value = postprocessing.rtTextureDepth.texture;\r\n        postprocessing.bokeh_uniforms[ 'textureWidth' ].value = width;\r\n        postprocessing.bokeh_uniforms[ 'textureHeight' ].value = height;\r\n        postprocessing.bokeh_uniforms[ 'znear' ].value = this.camera.near;\r\n        postprocessing.bokeh_uniforms[ 'zfar' ].value = this.camera.far;\r\n        postprocessing.bokeh_uniforms[ 'shaderFocus' ].value = false;\r\n        postprocessing.bokeh_uniforms[ 'focusCoords' ].value.set( 0.5, 0.5 );\r\n                    \r\n        postprocessing.materialBokeh = new THREE.ShaderMaterial( {\r\n            uniforms: postprocessing.bokeh_uniforms,\r\n            vertexShader: bokeh_shader.vertexShader,\r\n            fragmentShader: bokeh_shader.fragmentShader,\r\n            defines: {\r\n                RINGS: shaderSettings.rings,\r\n                SAMPLES: shaderSettings.samples\r\n            }\r\n        } );\r\n        postprocessing.quad = new THREE.Mesh( new THREE.PlaneBufferGeometry( width, height ), postprocessing.materialBokeh );\r\n        postprocessing.quad.position.z = - 500;\r\n        postprocessing.scene.add( postprocessing.quad );\r\n\r\n        this.postprocessing = postprocessing;\r\n    }\r\n\r\n    updateCamera() {\r\n        if (this.camera && this.player) {\r\n            // 카메라가 플레이어를 따라다니도록 한다\r\n            let lookTarget;\r\n            let cameraPos;\r\n            const reltiveOffset = new THREE.Vector3(0, 150, 500);\r\n            if (this.battlemode) {\r\n                // 전투에 참여하는 캐릭터들의 중간값을 본다.\r\n\r\n                // 전투 참여 캐릭터들을 일단 스프라이트 메쉬로 뽑아낸다\r\n                let center = new THREE.Vector3(0, 0, 0);\r\n                let count = 0;\r\n                this.forEachEntity((entity) => {\r\n                    if (entity.spriteMesh) {\r\n                        center = center.add(entity.mesh.position.clone());\r\n                        count ++;\r\n                    }\r\n                });\r\n\r\n                lookTarget = center.divideScalar(count);\r\n\r\n                if (this.battle_asset.zoom_effect) {\r\n                    // 거리를 줄인다\r\n                    reltiveOffset.z = 250;\r\n                    reltiveOffset.y = 75;\r\n                }\r\n\r\n            } else {\r\n                lookTarget = this.player.mesh.position.clone();;\r\n                lookTarget.y += 16;\r\n            }\r\n\r\n            \r\n            cameraPos = reltiveOffset.add(lookTarget);\r\n\r\n            \r\n            \r\n            // 카메라가 물체를 쫓아가야 한다.\r\n            const diff = cameraPos.sub(this.camera.position);\r\n            const speed = 5;\r\n\r\n            const scalar = Math.min(diff.length(), speed);\r\n            const offset = diff.normalize().multiplyScalar(scalar); \r\n         \r\n            this.camera.position.add(offset);\r\n            this.camera.lookAt(lookTarget);\r\n\r\n            // 캐릭터 엔티티는 모두 이와 같이 처리한다\r\n            this.forEachEntity((entity) => {\r\n                if (entity.spriteMesh) {\r\n                    entity.spriteMesh.lookAt(this.camera.position);\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    tick() {\r\n        this.currentTime = new Date().getTime();\r\n\r\n        // 로직 -> 렌더링 순서로 업데이트를 한다\r\n        this.updater.update();\r\n        this.ui.render();\r\n\r\n        // 배틀모드 특별처리\r\n        if (this.battle_asset) {\r\n            if (this.battle_asset.movie) {\r\n                this.battle_asset.movie.update();\r\n            }\r\n\r\n            if (this.battle_asset.update) {\r\n                this.battle_asset.update();\r\n            }\r\n        }\r\n\r\n\r\n        this.updateCamera();\r\n\r\n        if (this.postprocessing.enabled) {\r\n            const renderer = this.renderer;\r\n            const postprocessing = this.postprocessing;\r\n            \r\n\r\n            // 플레이어 카메라간의 거리를 구한다\r\n            const targetDistance = this.player.mesh.position.distanceTo(this.camera.position);\r\n            const zfar = this.camera.far;\r\n            const znear = this.camera.near;\r\n            \r\n            const v = Math.max( 0, Math.min( 1,( ( targetDistance - znear ) / ( zfar - znear ) )));\r\n            const sdepth =  v * v * (3 - 2 *v);\r\n            const ldepth =  - zfar * znear / ( (1 - sdepth) * ( zfar - znear ) - zfar );\r\n\r\n            //console.log(zfar, znear, targetDistance, v, sdepth, ldepth);\r\n            \r\n            postprocessing.bokeh_uniforms[ 'focalDepth' ].value = ldepth;\r\n\r\n\r\n\r\n            \r\n            renderer.clear();\r\n            // render scene into texture\r\n            renderer.setRenderTarget( postprocessing.rtTextureColor );\r\n            renderer.clear();\r\n            renderer.render( this.scene, this.camera );\r\n            // render depth into texture\r\n            this.scene.overrideMaterial = postprocessing.materialDepth;\r\n            renderer.setRenderTarget( postprocessing.rtTextureDepth );\r\n            renderer.clear();\r\n            renderer.render( this.scene, this.camera );\r\n            this.scene.overrideMaterial = null;\r\n            // render bokeh composite\r\n            renderer.setRenderTarget( null );\r\n            renderer.render( postprocessing.scene, postprocessing.camera );\r\n        } else {\r\n            // 기본 모드 처리\r\n            this.scene.overrideMaterial = null;\r\n            this.renderer.setRenderTarget(null);\r\n            this.renderer.clear();\r\n            this.renderer.render( this.scene, this.camera );\r\n        }\r\n        \r\n        \r\n        if (!this.isStopped) {\r\n            requestAnimationFrame(this.tick.bind(this));\r\n        }\r\n    }\r\n\r\n    start() {\r\n        this.tick();\r\n    }\r\n\r\n    stop() {\r\n        this.isStopped = true;\r\n    }\r\n\r\n    run(username) {\r\n        // 리소스를 로딩하고 끝날때까지 기다린다.\r\n        this.loadSprites();\r\n        this.loadMap();\r\n        this.loadModel();\r\n        this.updater = new Updater(this);\r\n\r\n        const wait = setInterval(() => {\r\n            if (this.map.isLoaded && this.isSpritesLoaded() && this.model) {\r\n                clearInterval(wait);\r\n\r\n                // 리소스 로딩이 끝나면 서버에 접속한다\r\n                // 접속이 완료되면 핸들러들을 연결하고 게임을 시작한다\r\n                // TODO : 서버 접속을 만들어야 한다\r\n\r\n                // 월드를 생성한다\r\n                // TODO : terrain 생성코드를 나중에 여기로 옮겨와야 한다\r\n                while (this.scene.children.length > 0) {\r\n                    this.scene.remove(this.scene.children[0]);\r\n                }\r\n\r\n                const world = new GameWorld(this, this.map);\r\n                this.world = world;\r\n                \r\n                    \r\n                // 맵을 초기화한다\r\n                // TODO: 맵을 여기서 초기화하도록 코드를 옮겨야 한다\r\n                this.scene.add(world.terrain);\r\n                this.scene.add(world.model);\r\n                this.initEntityGrid();\r\n                Entity.setGridSize(this.map.tilesize);\r\n\r\n                // 월드 라이트를 추가\r\n                // TODO : map에 따라서 라이트를 바꾸어야 한다\r\n                // 헤미스피어를 붙인다\r\n                /*const hemiLight = new THREE.HemisphereLight( 0xffffff, 0xffffff, 1 );\r\n                hemiLight.color.setHSL( 0.6, 1, 0.6 );\r\n                hemiLight.groundColor.setHSL( 0.095, 1, 0.75 );\r\n                hemiLight.position.set( 0, 50, 0 );\r\n                this.scene.add( hemiLight );*/\r\n                const ambient = new THREE.AmbientLight(0xffffff, 1.5);\r\n                this.scene.add( ambient );\r\n                \r\n                // 프랍을 배치한다\r\n                let id = 2;\r\n                for(const propData of this.map.props) {\r\n                    const propEntity = EntityFactory.createEntity(propData.kind, id++, \"\");\r\n                    // 배치할 좌표를 계산한다\r\n                    propEntity.setGridPosition(propData.x, propData.y);\r\n                    \r\n                    if (propEntity instanceof Chest) {\r\n                        propEntity.model =this.model; \r\n                        propEntity.mesh = propEntity.model.scene.clone();\r\n                        propEntity.mesh.scale.set(5, 5, 5);\r\n                        propEntity.mesh.rotation.y = Math.PI;\r\n                    }\r\n                    \r\n                    this.addEntity(propEntity);\r\n                    this.scene.add(propEntity.mesh);\r\n                }\r\n\r\n                // 몬스터를 배치한다.\r\n                \r\n\r\n\r\n                this.pathfinder = new Pathfinder(this.map.width, this.map.height)\r\n\r\n\r\n                // 플레이어를 선언한다\r\n                const player = new Player(1, username, \"\");\r\n                player.setSprite(this.sprites[\"test3\"]);\r\n                player.buildMesh();\r\n                player.onRequestPath((x, y) => {\r\n                    const path = this.findPath(player, x, y);\r\n                    return path;\r\n                });\r\n\r\n                player.onStopPathing((x, y) => {\r\n                    if(player.target instanceof Chest) {\r\n                        const chest = player.target;\r\n                        player.target = null;\r\n\r\n                        if (!chest.open) {\r\n                            chest.open = true;\r\n\r\n                            // 상자를 연다\r\n                            const mixer = new THREE.AnimationMixer(chest.mesh.children[0]);\r\n                            const clips = this.model.animations;\r\n                            const clip = THREE.AnimationClip.findByName( clips, 'Cube.001Action_Cube.001' );\r\n                            const action = mixer.clipAction( clip );\r\n                            action.setLoop(THREE.LoopOnce);\r\n                            action.clampWhenFinished = true;\r\n                            action.play();\r\n                            const update = setInterval(() => {\r\n                                mixer.update(0.05);\r\n                                if (!action.isRunning()){\r\n                                    clearInterval(update);\r\n                                }\r\n                            }, 10);\r\n                        }\r\n                    }\r\n                });\r\n\r\n                // TODO : 화면에 배치하고 보이지 않게 하여야 한다\r\n                player.setGridPosition(3, 3);\r\n                player.idle();\r\n                this.addEntity(player);\r\n                this.unregisterEntityPosition(player); // 플레이어를 엔티티에 포함시키지않기위한 특수처리\r\n                this.player = player;\r\n\r\n                // 게임 씬 페이즈를 선언한다.\r\n                // 등장컷신 -> 전투 -> (승리컷신) -> 탐험 -> 퇴장컷신 . 순으로 만들어진다.\r\n                // 등장 컷신 \r\n                this.nextPhase = new Cutscene(this, \"enter\");\r\n\r\n                // 월드에 추가를 한다\r\n                // TODO : entity 를 일괄로 처리할 수 있는 장치가 필요하다?>\r\n                this.scene.add(this.player.mesh);\r\n                this.start();\r\n            }\r\n        }, 100);\r\n\r\n    }\r\n\r\n    loadSprites() {\r\n        const sprites = {};\r\n        for (const data of SpriteData) {\r\n            const sprite = { data: data, image:null, isLoaded: false  };\r\n            sprites[data.id] = sprite;\r\n\r\n            const img = new Image();\r\n            img.src = `static/${data.id}.png`;\r\n            img.onload = function() {\r\n                sprite.image = img;\r\n                sprite.isLoaded = true;\r\n                sprite.width = img.width;\r\n                sprite.height = img.height;\r\n            }\r\n        }\r\n\r\n        this.sprites = sprites;\r\n    }\r\n\r\n    loadMap() {\r\n        this.map = new Map();\r\n    }\r\n\r\n    loadModel() {\r\n        //const modelNames = [\"treasure\"];\r\n        var loader = new GLTFLoader();\r\n        loader.load(\"static/box.gltf\", (gltf) => {\r\n            this.model = gltf; // 임시 코드... 모델을 어떻게 관리할까?\r\n        },undefined, function ( error ) {\r\n\r\n            console.error( error );\r\n        \r\n        });\r\n    }\r\n\r\n    isSpritesLoaded() {\r\n        if (_.any(this.sprites, function(sprite) { return !sprite.isLoaded; } )) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    initEntityGrid() {\r\n        this.entityGrid = [];\r\n        for(let i=0; i < this.map.height; i += 1) {\r\n            this.entityGrid[i] = [];\r\n            for(let j=0; j < this.map.width; j += 1) {\r\n                this.entityGrid[i][j] = {};\r\n            }\r\n        }\r\n    }\r\n\r\n    addEntity(entity) {\r\n        if(this.entities[entity.id] === undefined) {\r\n            this.entities[entity.id] = entity;\r\n            this.registerEntityPosition(entity);\r\n        }\r\n    }\r\n\r\n    removeEntity(entity) {\r\n        if(entity.id in this.entities) {\r\n            this.unregisterEntityPosition(entity);\r\n            delete this.entities[entity.id];\r\n        }\r\n    }\r\n  \r\n    registerEntityPosition(entity) {\r\n        const x = entity.gridX;\r\n        const y = entity.gridY;\r\n    \r\n        this.entityGrid[y][x][entity.id] = entity;\r\n    }\r\n\r\n    unregisterEntityPosition(entity) {\r\n        const x = entity.gridX;\r\n        const y = entity.gridY;\r\n\r\n        if(this.entityGrid[y][x][entity.id]) {\r\n            delete this.entityGrid[y][x][entity.id];\r\n        }\r\n    }\r\n\r\n    getEntityAt(x, y) {\r\n        if(this.map.isOutOfBounds(x, y) || !this.entityGrid) {\r\n            return null;\r\n        }\r\n        \r\n        const entities = this.entityGrid[y][x];\r\n        let entity = null;\r\n        if(_.size(entities) > 0) {\r\n            entity = entities[_.keys(entities)[0]];\r\n        } else {\r\n            // entity = this.getItemAt(x, y);\r\n        }\r\n        return entity;\r\n    }\r\n\r\n    getItemAt(x, y) {\r\n        return null;\r\n    }\r\n\r\n    getGridPosition(intersect, boundingbox) {\r\n        const ts = this.map.tilesize;\r\n        const xIndex = Math.floor((intersect.x - boundingbox.min.x) / ts );\r\n        const yIndex = Math.floor((intersect.z - boundingbox.min.y) / ts );\r\n        \r\n        return { x: xIndex, y: yIndex };\r\n    }\r\n\r\n    click(x, y) {\r\n        if (this.ui) {\r\n            const result = this.ui.clickHandler(x, y);\r\n            if (result) {\r\n                return;\r\n            }\r\n        }\r\n\r\n        if (this.phase) {\r\n            this.phase.click(x, y);\r\n        }\r\n\r\n        const size = new THREE.Vector2();\r\n        this.renderer.getSize(size);\r\n\r\n        const mouse = new THREE.Vector2();\r\n        mouse.x = (x / size.x) * 2 - 1;\r\n        mouse.y = -(y / size.y) * 2 + 1;\r\n\r\n        const raycaster = new THREE.Raycaster();\r\n        raycaster.setFromCamera( mouse, this.camera );\r\n        // 지형터치를 어떻게 만들지?\r\n        const intersects = raycaster.intersectObjects(this.scene.children);\r\n        for ( const inter of intersects) {\r\n            // TODO: 함수를 world 쪽에 만들어두어야 한다\r\n            const pos = this.getGridPosition(inter.point, this.world.terrain.geometry.boundingBox);\r\n\r\n            // 이제 여기서 무엇을 클릭했는지 조사한다\r\n            const entity = this.getEntityAt(pos.x, pos.y);\r\n            if (entity instanceof Chest) {\r\n                // 상자를 향해  이동한다\r\n                this.player.setTarget(entity);\r\n                this.player.follow(entity);\r\n            } else {\r\n                // 해당 위치로 플레이어를 이동시킨다\r\n                this.player.go(pos.x, pos.y);\r\n            }\r\n        }\r\n    }\r\n\r\n    keyDown(key) {\r\n        if (key === 66) {\r\n            // 전투모드를 활성화한다\r\n            this.battlemode = !this.battlemode;\r\n            if (this.battlemode) {\r\n                // ui 를 화면에 그린다\r\n                const uiimg = new Image();\r\n                uiimg.src = \"static/battleui.png\";\r\n                uiimg.onload = () => {\r\n                    const canvas = document.getElementById(\"foreground\");\r\n                    const ctx = canvas.getContext('2d');\r\n                    ctx.drawImage(uiimg, 0, 0);\r\n                };\r\n\r\n                // 적을 추가하고 카메라타겟을 둘의 중간으로 잡는다\r\n                const enemy = new Character(10, \"\");\r\n                enemy.setSprite(this.sprites[\"test4\"]);\r\n                enemy.buildMesh();\r\n                enemy.setGridPosition(3,5);\r\n                this.addEntity(enemy);\r\n                this.scene.add(enemy.mesh);\r\n                enemy.animate(\"attack_ready\", 200);\r\n\r\n                // 캐릭터도 강제로 이동시킨다\r\n                this.player.setGridPosition(12,5);\r\n                this.player.setOrientation(Types.Orientations.LEFT);\r\n                this.player.walk();\r\n\r\n                const battle_asset = {\r\n                    enemy: enemy,\r\n                    click: this.click,\r\n                };\r\n\r\n                this.click = () => {\r\n                    // 다른 함수로 대체\r\n                    // 캐릭터 앞까지 이동을 하고 그 다음에 공격을 한다.\r\n                    // 좌표는 일단 하드코딩을 한다\r\n                    if (!enemy.isAttacking) {\r\n                        const from = enemy.mesh.position.clone();\r\n                        const to = this.player.mesh.position.clone();\r\n\r\n                        // 타임아웃으로 컨트롤을 한다 \r\n                        const attackerMovie = new MovieClip(\r\n                            new MovieClip.Timeline(0, 40, enemy.mesh, [[\"x\", from.x, to.x-16, \"inOutSine\"], [\"z\", from.z, to.z, \"inOutSine\"]]),\r\n                            new MovieClip.Timeline(41, 100, enemy.mesh, [[\"x\", to.x-16, to.x-16, \"linear\"], [\"z\", to.z, to.z, \"linear\"]]),\r\n                            new MovieClip.Timeline(101, 130, enemy.mesh, [[\"x\", to.x-16, from.x, \"inOutSine\"], [\"z\", to.z, from.z, \"inOutSine\"]]),\r\n                        );\r\n\r\n                        attackerMovie.playAndDestroy(() => {\r\n                            enemy.isAttacking = false;\r\n                        });\r\n\r\n                        enemy.isAttacking = true;\r\n                        battle_asset.movie = attackerMovie;\r\n                        battle_asset.update = () => {\r\n                            if (attackerMovie._playing) {\r\n                                if (attackerMovie._frame > 100) {\r\n                                    // 이동 모션을 튼다\r\n                                    enemy.animate(\"attack_ready\", 200);\r\n                                    battle_asset.zoom_effect = false;\r\n                                } else if (attackerMovie._frame > 70) {\r\n                                    enemy.animate(\"attack\", 100); \r\n                                } else if (attackerMovie._frame > 40) {\r\n                                    battle_asset.zoom_effect = true;\r\n                                }\r\n                                \r\n                            }\r\n                        }\r\n                        \r\n                    }\r\n                };\r\n\r\n                this.battle_asset = battle_asset;\r\n                \r\n\r\n\r\n            } else {\r\n                const canvas = document.getElementById(\"foreground\");\r\n                const ctx = canvas.getContext('2d');\r\n                ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n\r\n                // 배틀리소스를 제거한다\r\n                if (this.battle_asset) {\r\n                    const enemy = this.battle_asset.enemy;\r\n                    this.removeEntity(enemy);\r\n                    this.scene.remove(enemy.mesh);\r\n                    this.click = this.battle_asset.click;\r\n                    if (this.battle_asset.timeout) {\r\n                        clearTimeout(this.battle_asset.timeout);\r\n                    }\r\n\r\n                    this.player.idle();\r\n\r\n                    this.battle_asset = null;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    forEachEntity(callback) {\r\n        _.each(this.entities, function(entity) {\r\n            callback(entity);\r\n        });\r\n    }\r\n\r\n   \r\n    findPath(character, x, y) {\r\n        const path = [];\r\n        if(this.map.isColliding(x, y)) {\r\n            // 해당 위치가 갈수 없는 곳이다\r\n            return path;\r\n        }\r\n    \r\n        if(this.pathfinder && character) {\r\n            const path = this.pathfinder.findPath(this.map.grid, character, x, y, false);\r\n            return path;\r\n        } \r\n        return [];\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/game.js","module.exports = {\"id\":\"chest\",\"width\":16,\"height\":16,\"animations\":{\"idle_down\":{\"length\":1,\"row\":0}},\"offset_x\":0,\"offset_y\":0}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/chest.json\n// module id = cKQl\n// module chunks = 1","// ux 와 게임 화면 구성을 여기서 연결한다\r\nexport default class App {\r\n    setGame(game) {\r\n        this.game = game;\r\n    }\r\n\r\n    center() {\r\n        window.scrollTo(0, 1);\r\n    }\r\n\r\n    start(username) {\r\n        // set option \r\n        this.center();\r\n        this.game.run();\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/app.js","module.exports = {\"id\":\"villager\",\"width\":24,\"height\":24,\"animations\":{\"idle_down\":{\"length\":2,\"row\":0}},\"offset_x\":-4,\"offset_y\":-8}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/villager.json\n// module id = e7Fs\n// module chunks = 1","module.exports = {\"id\":\"coder\",\"width\":24,\"height\":24,\"animations\":{\"idle_down\":{\"length\":2,\"row\":0}},\"offset_x\":-4,\"offset_y\":-7}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/coder.json\n// module id = eOxi\n// module chunks = 1","module.exports = {\"sha224WithRSAEncryption\":{\"sign\":\"rsa\",\"hash\":\"sha224\",\"id\":\"302d300d06096086480165030402040500041c\"},\"RSA-SHA224\":{\"sign\":\"ecdsa/rsa\",\"hash\":\"sha224\",\"id\":\"302d300d06096086480165030402040500041c\"},\"sha256WithRSAEncryption\":{\"sign\":\"rsa\",\"hash\":\"sha256\",\"id\":\"3031300d060960864801650304020105000420\"},\"RSA-SHA256\":{\"sign\":\"ecdsa/rsa\",\"hash\":\"sha256\",\"id\":\"3031300d060960864801650304020105000420\"},\"sha384WithRSAEncryption\":{\"sign\":\"rsa\",\"hash\":\"sha384\",\"id\":\"3041300d060960864801650304020205000430\"},\"RSA-SHA384\":{\"sign\":\"ecdsa/rsa\",\"hash\":\"sha384\",\"id\":\"3041300d060960864801650304020205000430\"},\"sha512WithRSAEncryption\":{\"sign\":\"rsa\",\"hash\":\"sha512\",\"id\":\"3051300d060960864801650304020305000440\"},\"RSA-SHA512\":{\"sign\":\"ecdsa/rsa\",\"hash\":\"sha512\",\"id\":\"3051300d060960864801650304020305000440\"},\"RSA-SHA1\":{\"sign\":\"rsa\",\"hash\":\"sha1\",\"id\":\"3021300906052b0e03021a05000414\"},\"ecdsa-with-SHA1\":{\"sign\":\"ecdsa\",\"hash\":\"sha1\",\"id\":\"\"},\"sha256\":{\"sign\":\"ecdsa\",\"hash\":\"sha256\",\"id\":\"\"},\"sha224\":{\"sign\":\"ecdsa\",\"hash\":\"sha224\",\"id\":\"\"},\"sha384\":{\"sign\":\"ecdsa\",\"hash\":\"sha384\",\"id\":\"\"},\"sha512\":{\"sign\":\"ecdsa\",\"hash\":\"sha512\",\"id\":\"\"},\"DSA-SHA\":{\"sign\":\"dsa\",\"hash\":\"sha1\",\"id\":\"\"},\"DSA-SHA1\":{\"sign\":\"dsa\",\"hash\":\"sha1\",\"id\":\"\"},\"DSA\":{\"sign\":\"dsa\",\"hash\":\"sha1\",\"id\":\"\"},\"DSA-WITH-SHA224\":{\"sign\":\"dsa\",\"hash\":\"sha224\",\"id\":\"\"},\"DSA-SHA224\":{\"sign\":\"dsa\",\"hash\":\"sha224\",\"id\":\"\"},\"DSA-WITH-SHA256\":{\"sign\":\"dsa\",\"hash\":\"sha256\",\"id\":\"\"},\"DSA-SHA256\":{\"sign\":\"dsa\",\"hash\":\"sha256\",\"id\":\"\"},\"DSA-WITH-SHA384\":{\"sign\":\"dsa\",\"hash\":\"sha384\",\"id\":\"\"},\"DSA-SHA384\":{\"sign\":\"dsa\",\"hash\":\"sha384\",\"id\":\"\"},\"DSA-WITH-SHA512\":{\"sign\":\"dsa\",\"hash\":\"sha512\",\"id\":\"\"},\"DSA-SHA512\":{\"sign\":\"dsa\",\"hash\":\"sha512\",\"id\":\"\"},\"DSA-RIPEMD160\":{\"sign\":\"dsa\",\"hash\":\"rmd160\",\"id\":\"\"},\"ripemd160WithRSA\":{\"sign\":\"rsa\",\"hash\":\"rmd160\",\"id\":\"3021300906052b2403020105000414\"},\"RSA-RIPEMD160\":{\"sign\":\"rsa\",\"hash\":\"rmd160\",\"id\":\"3021300906052b2403020105000414\"},\"md5WithRSAEncryption\":{\"sign\":\"rsa\",\"hash\":\"md5\",\"id\":\"3020300c06082a864886f70d020505000410\"},\"RSA-MD5\":{\"sign\":\"rsa\",\"hash\":\"md5\",\"id\":\"3020300c06082a864886f70d020505000410\"}}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/browserify-sign/browser/algorithms.json\n// module id = ejIc\n// module chunks = 1","module.exports = {\"id\":\"test1\",\"width\":32,\"height\":32,\"animations\":{\"atk_right\":{\"length\":3,\"row\":3},\"walk_right\":{\"length\":3,\"row\":2},\"idle_right\":{\"length\":3,\"row\":2},\"walk_up\":{\"length\":3,\"row\":1},\"idle_up\":{\"length\":3,\"row\":1},\"walk_down\":{\"length\":3,\"row\":0},\"idle_down\":{\"length\":3,\"row\":0}},\"offset_x\":0,\"offset_y\":-12}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/test1.json\n// module id = esNN\n// module chunks = 1","import Character from \"./character\";\r\nimport Types from '../share/gametypes';\r\n\r\nexport default class Updater {\r\n    constructor(game) {\r\n        this.game = game;\r\n    }\r\n\r\n    update() {\r\n        this.updateEntities();\r\n        this.updateTransitions();\r\n        this.updatePhase();\r\n    }\r\n\r\n    updateEntities() {\r\n        this.game.forEachEntity((entity) => {\r\n            const isCharacter = entity instanceof Character;\r\n            if (isCharacter) {\r\n                this.updateCharacter(entity);\r\n                this.updateAnimation(entity);\r\n            }\r\n            this.updateEntityFading(entity);\r\n        });\r\n    }\r\n\r\n    updateCharacter(c) {\r\n        // 캐릭터의 이동 위치를 업데이트한다\r\n        const fps = 60;\r\n        const tick = Math.round(16 / Math.round((c.moveSpeed / (1000 / fps))));\r\n    \r\n        if(c.isMoving() && c.movement.inProgress === false) {\r\n            if(c.orientation === Types.Orientations.LEFT) {\r\n                c.movement.start(this.game.currentTime,\r\n                                function(x) {\r\n                                    c.x = x;\r\n                                    c.hasMoved();\r\n                                },\r\n                                function() {\r\n                                    c.x = c.movement.endValue;\r\n                                    c.hasMoved();\r\n                                    c.nextStep();\r\n                                },\r\n                                c.x - tick,\r\n                                c.x - 16,\r\n                                c.moveSpeed);\r\n            }\r\n            else if(c.orientation === Types.Orientations.RIGHT) {\r\n                c.movement.start(this.game.currentTime,\r\n                                function(x) {\r\n                                    c.x = x;\r\n                                    c.hasMoved();\r\n                                },\r\n                                function() {\r\n                                    c.x = c.movement.endValue;\r\n                                    c.hasMoved();\r\n                                    c.nextStep();\r\n                                },\r\n                                c.x + tick,\r\n                                c.x + 16,\r\n                                c.moveSpeed);\r\n            }\r\n            else if(c.orientation === Types.Orientations.UP) {\r\n                c.movement.start(this.game.currentTime,\r\n                                function(y) {\r\n                                    c.y = y;\r\n                                    c.hasMoved();\r\n                                },\r\n                                function() {\r\n                                    c.y = c.movement.endValue;\r\n                                    c.hasMoved();\r\n                                    c.nextStep();\r\n                                },\r\n                                c.y - tick,\r\n                                c.y - 16,\r\n                                c.moveSpeed);\r\n            }\r\n            else if(c.orientation === Types.Orientations.DOWN) {\r\n                c.movement.start(this.game.currentTime,\r\n                                function(y) {\r\n                                    c.y = y;\r\n                                    c.hasMoved();\r\n                                },\r\n                                function() {\r\n                                    c.y = c.movement.endValue;\r\n                                    c.hasMoved();\r\n                                    c.nextStep();\r\n                                },\r\n                                c.y + tick,\r\n                                c.y + 16,\r\n                                c.moveSpeed);\r\n            }\r\n        }\r\n    }\r\n\r\n    updateAnimation(entity) {\r\n        const anim = entity.currentAnimation;\r\n                \r\n        if(anim) {\r\n            if (anim.update(this.game.currentTime)) {\r\n                // 매터리얼을 변경한다\r\n                if (anim.currentFrame) {\r\n                    if ((entity.flipSpriteX && entity.texture.repeat.x > 0) || \r\n                        (!entity.flipSpriteX && entity.texture.repeat.x < 0)) {\r\n                        entity.texture.repeat.x = -entity.texture.repeat.x;\r\n                    }\r\n\r\n                    if (entity.texture.repeat.x > 0) {\r\n                        entity.texture.offset.set(\r\n                            anim.currentFrame.x / entity.sprite.width, \r\n                            (entity.sprite.height - anim.currentFrame.y - anim.height)/ entity.sprite.height);\r\n                            //anim.currentFrame.y / entity.sprite.height);\r\n                            \r\n                    } else {\r\n                        entity.texture.offset.set(\r\n                            -(entity.sprite.width - anim.currentFrame.x - anim.width) / entity.sprite.width, \r\n                            (entity.sprite.height - anim.currentFrame.y - anim.height)/ entity.sprite.height);\r\n                            //anim.currentFrame.y / entity.sprite.height);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    updateTransitions() {\r\n        // 타일의 중앙으로 옮겨놓는다\r\n        const offsetX = this.game.map.offset.x + this.game.map.tilesize / 2;\r\n        const offsetY = 0;\r\n        const offsetZ = this.game.map.offset.y + this.game.map.tilesize / 2;\r\n\r\n        this.game.forEachEntity((entity) => {\r\n            const m = entity.movement;\r\n            if (m) {\r\n                if (m.inProgress) {\r\n                    m.step(this.game.currentTime)\r\n                }\r\n            }\r\n\r\n            // 엔티티의 실제 위치를 2d (x, y) 에서 3d(x,y,z) 으로 변경한다\r\n            if (entity.mesh) {\r\n                entity.mesh.position.set(\r\n                    offsetX + entity.x + entity.offset.x , \r\n                    offsetY + entity.offset.y, \r\n                    offsetZ + entity.y + entity.offset.z);\r\n            }\r\n\r\n            // 쉐터 박스를 테스트 한다\r\n            if (entity.shatters) {\r\n                for (const block of entity.shatters) {\r\n                    if (!block._pos_init) {\r\n                        block.position.x += entity.mesh.position.x;\r\n                        block.position.z += entity.mesh.position.z;\r\n                        block._pos_init = true;\r\n\r\n                        block.shatterTick = Math.random() * 100;\r\n                    }\r\n               \r\n                    const d = 1;\r\n                    --block.shatterTick;\r\n                    if (block.shatterTick < 0) {\r\n\r\n                        if (Math.abs(entity.mesh.position.x - block.position.x) < d) { block.position.x = entity.mesh.position.x; }\r\n                        else { block.position.x += d/(entity.mesh.position.x - block.position.x); }\r\n\r\n                        if (Math.abs(entity.mesh.position.y - block.position.y) < d*3) { block.position.y = entity.mesh.position.y; }\r\n                        else { block.position.y += d*3/(entity.mesh.position.y - block.position.y); }\r\n\r\n                        if (Math.abs(entity.mesh.position.z - block.position.z) < d) { block.position.z = entity.mesh.position.z; }\r\n                        else { block.position.z += d/(entity.mesh.position.z - block.position.z); }\r\n                    }\r\n\r\n                }\r\n            }\r\n        })\r\n\r\n        if (this.game.mesh__) {\r\n            this.game.mesh__.position.copy(this.game.player.mesh.position);\r\n            this.game.mesh__.position.y = 11;\r\n        }\r\n    }\r\n\r\n    updateEntityFading(entity) {\r\n        if(entity && entity.isFading) {\r\n            const duration = 1000;\r\n            const t = this.game.currentTime;\r\n            const dt = t - entity.startFadingTime;\r\n        \r\n            if(dt > duration) {\r\n                entity.isFading = false;\r\n                if (entity.mesh) {\r\n                    entity.spriteMesh.material.opacity = 1;\r\n                }\r\n\r\n            } else {\r\n                if (entity.mesh) {\r\n                    entity.spriteMesh.material.opacity = dt / duration;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    updatePhase() {\r\n        if (this.game.nextPhase) {\r\n            if (this.game.phase) {\r\n                // 끝내고 다시 시작한다\r\n                this.game.phase.end();\r\n                this.game.phase = null;\r\n            } else {\r\n                this.game.phase = this.game.nextPhase;\r\n                this.game.nextPhase = null;\r\n\r\n                this.game.phase.begin();\r\n            }\r\n        }\r\n        \r\n        if (this.game.phase) {\r\n            this.game.phase.update();\r\n        }\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/updater.js","module.exports = {\"id\":\"goldensword\",\"width\":48,\"height\":48,\"animations\":{\"atk_right\":{\"length\":5,\"row\":0},\"walk_right\":{\"length\":4,\"row\":1},\"idle_right\":{\"length\":2,\"row\":2},\"atk_up\":{\"length\":5,\"row\":3},\"walk_up\":{\"length\":4,\"row\":4},\"idle_up\":{\"length\":2,\"row\":5},\"atk_down\":{\"length\":5,\"row\":6},\"walk_down\":{\"length\":4,\"row\":7},\"idle_down\":{\"length\":2,\"row\":8}},\"offset_x\":-16,\"offset_y\":-20}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/goldensword.json\n// module id = hemJ\n// module chunks = 1","module.exports = {\"id\":\"arrow\",\"width\":14,\"height\":14,\"animations\":{\"idle_down\":{\"length\":1,\"row\":0}}}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/arrow.json\n// module id = ijQv\n// module chunks = 1","module.exports = {\"id\":\"talk\",\"width\":14,\"height\":14,\"animations\":{\"idle_down\":{\"length\":1,\"row\":0}}}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/talk.json\n// module id = j8az\n// module chunks = 1","var isFirefox = function() {\n\treturn /firefox/i.test(navigator.userAgent);\n}();\n\nmodule.exports.isFirefox = isFirefox;\n\n\n// WEBPACK FOOTER //\n// ./src/lib/three-ui/utils/browserDetection.js","module.exports = {\"id\":\"skeleton2\",\"width\":48,\"height\":48,\"animations\":{\"atk_right\":{\"length\":3,\"row\":0},\"walk_right\":{\"length\":4,\"row\":1},\"idle_right\":{\"length\":2,\"row\":2},\"atk_up\":{\"length\":3,\"row\":3},\"walk_up\":{\"length\":4,\"row\":4},\"idle_up\":{\"length\":2,\"row\":5},\"atk_down\":{\"length\":3,\"row\":6},\"walk_down\":{\"length\":4,\"row\":7},\"idle_down\":{\"length\":3,\"row\":8}},\"offset_x\":-16,\"offset_y\":-20}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/skeleton2.json\n// module id = jgxY\n// module chunks = 1","module.exports = {\"id\":\"desertnpc\",\"width\":24,\"height\":24,\"animations\":{\"idle_down\":{\"length\":2,\"row\":0}},\"offset_x\":-4,\"offset_y\":-8}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/desertnpc.json\n// module id = lUAm\n// module chunks = 1","module.exports = {\"id\":\"octocat\",\"width\":32,\"height\":32,\"animations\":{\"idle_down\":{\"length\":4,\"row\":0}},\"offset_x\":-8,\"offset_y\":-12}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/octocat.json\n// module id = lgfl\n// module chunks = 1","export default class Entity {\r\n    constructor(id, kind) {\r\n        this.id = id;\r\n        this.kind = kind;\r\n        this.isLoaded = false;\r\n    }\r\n\r\n    static setGridSize(size) {\r\n        Entity.gridSize = size;\r\n    }\r\n\r\n    setPosition(x, y) {\r\n        this.x = x;\r\n        this.y = y;\r\n    }\r\n\r\n    setGridPosition(x, y) {\r\n        this.gridX = x;\r\n        this.gridY = y;\r\n    \r\n        this.setPosition(x * Entity.gridSize, y * Entity.gridSize);\r\n    }\r\n\r\n    fadeIn(currentTime) {\r\n        this.isFading = true;\r\n        this.startFadingTime = currentTime;\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/entity.js","module.exports = {\"id\":\"hand\",\"width\":14,\"height\":14,\"animations\":{\"idle_down\":{\"length\":1,\"row\":0}}}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/hand.json\n// module id = mJyv\n// module chunks = 1","module.exports = {\"id\":\"shadow16\",\"width\":16,\"height\":16}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/shadow16.json\n// module id = me95\n// module chunks = 1","module.exports = {\"id\":\"item-platearmor\",\"width\":16,\"height\":16,\"animations\":{\"idle\":{\"length\":6,\"row\":0}},\"offset_x\":0,\"offset_y\":0}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/item-platearmor.json\n// module id = n+Rf\n// module chunks = 1","module.exports = {\"id\":\"priest\",\"width\":24,\"height\":24,\"animations\":{\"idle_down\":{\"length\":2,\"row\":0}},\"offset_x\":-4,\"offset_y\":-8}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/priest.json\n// module id = ni5p\n// module chunks = 1","module.exports = {\"id\":\"bat\",\"width\":32,\"height\":48,\"animations\":{\"atk_right\":{\"length\":5,\"row\":0},\"walk_right\":{\"length\":5,\"row\":1},\"idle_right\":{\"length\":5,\"row\":2},\"atk_up\":{\"length\":5,\"row\":3},\"walk_up\":{\"length\":5,\"row\":4},\"idle_up\":{\"length\":5,\"row\":5},\"atk_down\":{\"length\":5,\"row\":6},\"walk_down\":{\"length\":5,\"row\":7},\"idle_down\":{\"length\":5,\"row\":8}},\"offset_x\":-8,\"offset_y\":-24}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/bat.json\n// module id = oxPP\n// module chunks = 1","module.exports = {\"id\":\"axe\",\"width\":48,\"height\":48,\"animations\":{\"atk_right\":{\"length\":5,\"row\":0},\"walk_right\":{\"length\":4,\"row\":1},\"idle_right\":{\"length\":2,\"row\":2},\"atk_up\":{\"length\":5,\"row\":3},\"walk_up\":{\"length\":4,\"row\":4},\"idle_up\":{\"length\":2,\"row\":5},\"atk_down\":{\"length\":5,\"row\":6},\"walk_down\":{\"length\":4,\"row\":7},\"idle_down\":{\"length\":2,\"row\":8}},\"offset_x\":-16,\"offset_y\":-20}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/axe.json\n// module id = q9QV\n// module chunks = 1","/**\n * @author zz85 / https://github.com/zz85 | twitter.com/blurspline\n *\n * Depth-of-field shader with bokeh\n * ported from GLSL shader by Martins Upitis\n * http://blenderartists.org/forum/showthread.php?237488-GLSL-depth-of-field-with-bokeh-v2-4-(update)\n *\n * Requires #define RINGS and SAMPLES integers\n */\n\n\n\nTHREE.BokehShader = {\n\n\tuniforms: {\n\n\t\t\"textureWidth\":  { value: 1.0 },\n\t\t\"textureHeight\":  { value: 1.0 },\n\n\t\t\"focalDepth\":   { value: 1.0 },\n\t\t\"focalLength\":   { value: 24.0 },\n\t\t\"fstop\": { value: 0.9 },\n\n\t\t\"tColor\":   { value: null },\n\t\t\"tDepth\":   { value: null },\n\n\t\t\"maxblur\":  { value: 1.0 },\n\n\t\t\"showFocus\":   { value: 0 },\n\t\t\"manualdof\":   { value: 0 },\n\t\t\"vignetting\":   { value: 0 },\n\t\t\"depthblur\":   { value: 0 },\n\n\t\t\"threshold\":  { value: 0.5 },\n\t\t\"gain\":  { value: 2.0 },\n\t\t\"bias\":  { value: 0.5 },\n\t\t\"fringe\":  { value: 0.7 },\n\n\t\t\"znear\":  { value: 0.1 },\n\t\t\"zfar\":  { value: 100 },\n\n\t\t\"noise\":  { value: 1 },\n\t\t\"dithering\":  { value: 0.0001 },\n\t\t\"pentagon\": { value: 0 },\n\n\t\t\"shaderFocus\":  { value: 1 },\n\t\t\"focusCoords\":  { value: new THREE.Vector2() }\n\n\n\t},\n\n\tvertexShader: [\n\n\t\t\"varying vec2 vUv;\",\n\n\t\t\"void main() {\",\n\n\t\t\t\"vUv = uv;\",\n\t\t\t\"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\n\n\t\t\"}\"\n\n\t].join( \"\\n\" ),\n\n\tfragmentShader: [\n\n\t\t\"#include <common>\",\n\n\t\t\"varying vec2 vUv;\",\n\n\t\t\"uniform sampler2D tColor;\",\n\t\t\"uniform sampler2D tDepth;\",\n\t\t\"uniform float textureWidth;\",\n\t\t\"uniform float textureHeight;\",\n\n\t\t\"uniform float focalDepth;  //focal distance value in meters, but you may use autofocus option below\",\n\t\t\"uniform float focalLength; //focal length in mm\",\n\t\t\"uniform float fstop; //f-stop value\",\n\t\t\"uniform bool showFocus; //show debug focus point and focal range (red = focal point, green = focal range)\",\n\n\t\t\"/*\",\n\t\t\"make sure that these two values are the same for your camera, otherwise distances will be wrong.\",\n\t\t\"*/\",\n\n\t\t\"uniform float znear; // camera clipping start\",\n\t\t\"uniform float zfar; // camera clipping end\",\n\n\t\t\"//------------------------------------------\",\n\t\t\"//user variables\",\n\n\t\t\"const int samples = SAMPLES; //samples on the first ring\",\n\t\t\"const int rings = RINGS; //ring count\",\n\n\t\t\"const int maxringsamples = rings * samples;\",\n\n\t\t\"uniform bool manualdof; // manual dof calculation\",\n\t\t\"float ndofstart = 1.0; // near dof blur start\",\n\t\t\"float ndofdist = 2.0; // near dof blur falloff distance\",\n\t\t\"float fdofstart = 1.0; // far dof blur start\",\n\t\t\"float fdofdist = 3.0; // far dof blur falloff distance\",\n\n\t\t\"float CoC = 0.03; //circle of confusion size in mm (35mm film = 0.03mm)\",\n\n\t\t\"uniform bool vignetting; // use optical lens vignetting\",\n\n\t\t\"float vignout = 1.3; // vignetting outer border\",\n\t\t\"float vignin = 0.0; // vignetting inner border\",\n\t\t\"float vignfade = 22.0; // f-stops till vignete fades\",\n\n\t\t\"uniform bool shaderFocus;\",\n\t\t\"// disable if you use external focalDepth value\",\n\n\t\t\"uniform vec2 focusCoords;\",\n\t\t\"// autofocus point on screen (0.0,0.0 - left lower corner, 1.0,1.0 - upper right)\",\n\t\t\"// if center of screen use vec2(0.5, 0.5);\",\n\n\t\t\"uniform float maxblur;\",\n\t\t\"//clamp value of max blur (0.0 = no blur, 1.0 default)\",\n\n\t\t\"uniform float threshold; // highlight threshold;\",\n\t\t\"uniform float gain; // highlight gain;\",\n\n\t\t\"uniform float bias; // bokeh edge bias\",\n\t\t\"uniform float fringe; // bokeh chromatic aberration / fringing\",\n\n\t\t\"uniform bool noise; //use noise instead of pattern for sample dithering\",\n\n\t\t\"uniform float dithering;\",\n\n\t\t\"uniform bool depthblur; // blur the depth buffer\",\n\t\t\"float dbsize = 1.25; // depth blur size\",\n\n\t\t\"/*\",\n\t\t\"next part is experimental\",\n\t\t\"not looking good with small sample and ring count\",\n\t\t\"looks okay starting from samples = 4, rings = 4\",\n\t\t\"*/\",\n\n\t\t\"uniform bool pentagon; //use pentagon as bokeh shape?\",\n\t\t\"float feather = 0.4; //pentagon shape feather\",\n\n\t\t\"//------------------------------------------\",\n\n\t\t\"float penta(vec2 coords) {\",\n\t\t\t\"//pentagonal shape\",\n\t\t\t\"float scale = float(rings) - 1.3;\",\n\t\t\t\"vec4  HS0 = vec4( 1.0,         0.0,         0.0,  1.0);\",\n\t\t\t\"vec4  HS1 = vec4( 0.309016994, 0.951056516, 0.0,  1.0);\",\n\t\t\t\"vec4  HS2 = vec4(-0.809016994, 0.587785252, 0.0,  1.0);\",\n\t\t\t\"vec4  HS3 = vec4(-0.809016994,-0.587785252, 0.0,  1.0);\",\n\t\t\t\"vec4  HS4 = vec4( 0.309016994,-0.951056516, 0.0,  1.0);\",\n\t\t\t\"vec4  HS5 = vec4( 0.0        ,0.0         , 1.0,  1.0);\",\n\n\t\t\t\"vec4  one = vec4( 1.0 );\",\n\n\t\t\t\"vec4 P = vec4((coords),vec2(scale, scale));\",\n\n\t\t\t\"vec4 dist = vec4(0.0);\",\n\t\t\t\"float inorout = -4.0;\",\n\n\t\t\t\"dist.x = dot( P, HS0 );\",\n\t\t\t\"dist.y = dot( P, HS1 );\",\n\t\t\t\"dist.z = dot( P, HS2 );\",\n\t\t\t\"dist.w = dot( P, HS3 );\",\n\n\t\t\t\"dist = smoothstep( -feather, feather, dist );\",\n\n\t\t\t\"inorout += dot( dist, one );\",\n\n\t\t\t\"dist.x = dot( P, HS4 );\",\n\t\t\t\"dist.y = HS5.w - abs( P.z );\",\n\n\t\t\t\"dist = smoothstep( -feather, feather, dist );\",\n\t\t\t\"inorout += dist.x;\",\n\n\t\t\t\"return clamp( inorout, 0.0, 1.0 );\",\n\t\t\"}\",\n\n\t\t\"float bdepth(vec2 coords) {\",\n\t\t\t\"// Depth buffer blur\",\n\t\t\t\"float d = 0.0;\",\n\t\t\t\"float kernel[9];\",\n\t\t\t\"vec2 offset[9];\",\n\n\t\t\t\"vec2 wh = vec2(1.0/textureWidth,1.0/textureHeight) * dbsize;\",\n\n\t\t\t\"offset[0] = vec2(-wh.x,-wh.y);\",\n\t\t\t\"offset[1] = vec2( 0.0, -wh.y);\",\n\t\t\t\"offset[2] = vec2( wh.x -wh.y);\",\n\n\t\t\t\"offset[3] = vec2(-wh.x,  0.0);\",\n\t\t\t\"offset[4] = vec2( 0.0,   0.0);\",\n\t\t\t\"offset[5] = vec2( wh.x,  0.0);\",\n\n\t\t\t\"offset[6] = vec2(-wh.x, wh.y);\",\n\t\t\t\"offset[7] = vec2( 0.0,  wh.y);\",\n\t\t\t\"offset[8] = vec2( wh.x, wh.y);\",\n\n\t\t\t\"kernel[0] = 1.0/16.0;   kernel[1] = 2.0/16.0;   kernel[2] = 1.0/16.0;\",\n\t\t\t\"kernel[3] = 2.0/16.0;   kernel[4] = 4.0/16.0;   kernel[5] = 2.0/16.0;\",\n\t\t\t\"kernel[6] = 1.0/16.0;   kernel[7] = 2.0/16.0;   kernel[8] = 1.0/16.0;\",\n\n\n\t\t\t\"for( int i=0; i<9; i++ ) {\",\n\t\t\t\t\"float tmp = texture2D(tDepth, coords + offset[i]).r;\",\n\t\t\t\t\"d += tmp * kernel[i];\",\n\t\t\t\"}\",\n\n\t\t\t\"return d;\",\n\t\t\"}\",\n\n\n\t\t\"vec3 color(vec2 coords,float blur) {\",\n\t\t\t\"//processing the sample\",\n\n\t\t\t\"vec3 col = vec3(0.0);\",\n\t\t\t\"vec2 texel = vec2(1.0/textureWidth,1.0/textureHeight);\",\n\n\t\t\t\"col.r = texture2D(tColor,coords + vec2(0.0,1.0)*texel*fringe*blur).r;\",\n\t\t\t\"col.g = texture2D(tColor,coords + vec2(-0.866,-0.5)*texel*fringe*blur).g;\",\n\t\t\t\"col.b = texture2D(tColor,coords + vec2(0.866,-0.5)*texel*fringe*blur).b;\",\n\n\t\t\t\"vec3 lumcoeff = vec3(0.299,0.587,0.114);\",\n\t\t\t\"float lum = dot(col.rgb, lumcoeff);\",\n\t\t\t\"float thresh = max((lum-threshold)*gain, 0.0);\",\n\t\t\t\"return col+mix(vec3(0.0),col,thresh*blur);\",\n\t\t\"}\",\n\n\t\t\"vec3 debugFocus(vec3 col, float blur, float depth) {\",\n\t\t\t\"float edge = 0.002*depth; //distance based edge smoothing\",\n\t\t\t\"float m = clamp(smoothstep(0.0,edge,blur),0.0,1.0);\",\n\t\t\t\"float e = clamp(smoothstep(1.0-edge,1.0,blur),0.0,1.0);\",\n\n\t\t\t\"col = mix(col,vec3(1.0,0.5,0.0),(1.0-m)*0.6);\",\n\t\t\t\"col = mix(col,vec3(0.0,0.5,1.0),((1.0-e)-(1.0-m))*0.2);\",\n\n\t\t\t\"return col;\",\n\t\t\"}\",\n\n\t\t\"float linearize(float depth) {\",\n\t\t\t\"return -zfar * znear / (depth * (zfar - znear) - zfar);\",\n\t\t\"}\",\n\n\n\t\t\"float vignette() {\",\n\t\t\t\"float dist = distance(vUv.xy, vec2(0.5,0.5));\",\n\t\t\t\"dist = smoothstep(vignout+(fstop/vignfade), vignin+(fstop/vignfade), dist);\",\n\t\t\t\"return clamp(dist,0.0,1.0);\",\n\t\t\"}\",\n\n\t\t\"float gather(float i, float j, int ringsamples, inout vec3 col, float w, float h, float blur) {\",\n\t\t\t\"float rings2 = float(rings);\",\n\t\t\t\"float step = PI*2.0 / float(ringsamples);\",\n\t\t\t\"float pw = cos(j*step)*i;\",\n\t\t\t\"float ph = sin(j*step)*i;\",\n\t\t\t\"float p = 1.0;\",\n\t\t\t\"if (pentagon) {\",\n\t\t\t\t\"p = penta(vec2(pw,ph));\",\n\t\t\t\"}\",\n\t\t\t\"col += color(vUv.xy + vec2(pw*w,ph*h), blur) * mix(1.0, i/rings2, bias) * p;\",\n\t\t\t\"return 1.0 * mix(1.0, i /rings2, bias) * p;\",\n\t\t\"}\",\n\n\t\t\"void main() {\",\n\t\t\t\"//scene depth calculation\",\n\n\t\t\t\"float depth = linearize(texture2D(tDepth,vUv.xy).x);\",\n\n\t\t\t\"// Blur depth?\",\n\t\t\t\"if ( depthblur ) {\",\n\t\t\t\t\"depth = linearize(bdepth(vUv.xy));\",\n\t\t\t\"}\",\n\n\t\t\t\"//focal plane calculation\",\n\n\t\t\t\"float fDepth = focalDepth;\",\n\n\t\t\t\"if (shaderFocus) {\",\n\n\t\t\t\t\"fDepth = linearize(texture2D(tDepth,focusCoords).x);\",\n\n\t\t\t\"}\",\n\n\t\t\t\"// dof blur factor calculation\",\n\n\t\t\t\"float blur = 0.0;\",\n\n\t\t\t\"if (manualdof) {\",\n\t\t\t\t\"float a = depth-fDepth; // Focal plane\",\n\t\t\t\t\"float b = (a-fdofstart)/fdofdist; // Far DoF\",\n\t\t\t\t\"float c = (-a-ndofstart)/ndofdist; // Near Dof\",\n\t\t\t\t\"blur = (a>0.0) ? b : c;\",\n\t\t\t\"} else {\",\n\t\t\t\t\"float f = focalLength; // focal length in mm\",\n\t\t\t\t\"float d = fDepth*1000.0; // focal plane in mm\",\n\t\t\t\t\"float o = depth*1000.0; // depth in mm\",\n\n\t\t\t\t\"float a = (o*f)/(o-f);\",\n\t\t\t\t\"float b = (d*f)/(d-f);\",\n\t\t\t\t\"float c = (d-f)/(d*fstop*CoC);\",\n\n\t\t\t\t\"blur = abs(a-b)*c;\",\n\t\t\t\"}\",\n\n\t\t\t\"blur = clamp(blur,0.0,1.0);\",\n\n\t\t\t\"// calculation of pattern for dithering\",\n\n\t\t\t\"vec2 noise = vec2(rand(vUv.xy), rand( vUv.xy + vec2( 0.4, 0.6 ) ) )*dithering*blur;\",\n\n\t\t\t\"// getting blur x and y step factor\",\n\n\t\t\t\"float w = (1.0/textureWidth)*blur*maxblur+noise.x;\",\n\t\t\t\"float h = (1.0/textureHeight)*blur*maxblur+noise.y;\",\n\n\t\t\t\"// calculation of final color\",\n\n\t\t\t\"vec3 col = vec3(0.0);\",\n\n\t\t\t\"if(blur < 0.05) {\",\n\t\t\t\t\"//some optimization thingy\",\n\t\t\t\t\"col = texture2D(tColor, vUv.xy).rgb;\",\n\t\t\t\"} else {\",\n\t\t\t\t\"col = texture2D(tColor, vUv.xy).rgb;\",\n\t\t\t\t\"float s = 1.0;\",\n\t\t\t\t\"int ringsamples;\",\n\n\t\t\t\t\"for (int i = 1; i <= rings; i++) {\",\n\t\t\t\t\t\"/*unboxstart*/\",\n\t\t\t\t\t\"ringsamples = i * samples;\",\n\n\t\t\t\t\t\"for (int j = 0 ; j < maxringsamples ; j++) {\",\n\t\t\t\t\t\t\"if (j >= ringsamples) break;\",\n\t\t\t\t\t\t\"s += gather(float(i), float(j), ringsamples, col, w, h, blur);\",\n\t\t\t\t\t\"}\",\n\t\t\t\t\t\"/*unboxend*/\",\n\t\t\t\t\"}\",\n\n\t\t\t\t\"col /= s; //divide by sample count\",\n\t\t\t\"}\",\n\n\t\t\t\"if (showFocus) {\",\n\t\t\t\t\"col = debugFocus(col, blur, depth);\",\n\t\t\t\"}\",\n\n\t\t\t\"if (vignetting) {\",\n\t\t\t\t\"col *= vignette();\",\n\t\t\t\"}\",\n\n\t\t\t\"gl_FragColor.rgb = col;\",\n\t\t\t\"gl_FragColor.a = 1.0;\",\n\t\t\"} \"\n\n\t].join( \"\\n\" )\n\n};\n\nTHREE.BokehDepthShader = {\n\n\tuniforms: {\n\n\t\t\"mNear\": { value: 1.0 },\n\t\t\"mFar\": { value: 1000.0 },\n\n\t},\n\n\tvertexShader: [\n\n\t\t\"varying float vViewZDepth;\",\n\n\t\t\"void main() {\",\n\n\t\t\"\t#include <begin_vertex>\",\n\t\t\"\t#include <project_vertex>\",\n\n\t\t\"\tvViewZDepth = - mvPosition.z;\",\n\n\t\t\"}\"\n\n\t].join( \"\\n\" ),\n\n\tfragmentShader: [\n\n\t\t\"uniform float mNear;\",\n\t\t\"uniform float mFar;\",\n\n\t\t\"varying float vViewZDepth;\",\n\n\t\t\"void main() {\",\n\n\t\t\"\tfloat color = 1.0 - smoothstep( mNear, mFar, vViewZDepth );\",\n\t\t\"\tgl_FragColor = vec4( vec3( color ), 1.0 );\",\n\n\t\t\"} \"\n\n\t].join( \"\\n\" )\n\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/bokehshader2.js","module.exports = {\"id\":\"test3\",\"width\":24,\"height\":48,\"animations\":{\"walk_right\":{\"length\":4,\"row\":2},\"idle_right\":{\"length\":1,\"row\":2},\"walk_up\":{\"length\":4,\"row\":1},\"idle_up\":{\"length\":1,\"row\":1},\"walk_down\":{\"length\":4,\"row\":0},\"idle_down\":{\"length\":1,\"row\":0},\"attack_ready\":{\"length\":4,\"row\":2}},\"offset_x\":0,\"offset_y\":-21}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/test3.json\n// module id = spbf\n// module chunks = 1","module.exports = {\"id\":\"scientist\",\"width\":24,\"height\":24,\"animations\":{\"idle_down\":{\"length\":2,\"row\":0}},\"offset_x\":-4,\"offset_y\":-8}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/scientist.json\n// module id = t0mp\n// module chunks = 1","module.exports = {\"id\":\"impact\",\"width\":16,\"height\":16,\"animations\":{\"idle\":{\"length\":1,\"row\":0}},\"offset_x\":0,\"offset_y\":0}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/impact.json\n// module id = t9nu\n// module chunks = 1","import DisplayObject from './DisplayObject.js';\n\n/**\n * Text\n * @extends DisplayObject\n *\n * Used internally by ThreeUI, shouldn't be used directly\n * Use ThreeUI.createText instead to create text\n *\n * @param {ThreeUI} ui\n * @param {string} text\n * @param {int} size\n * @param {string} font\n * @param {string} color\n * @param {int} x\n * @param {int} y\n */\n\nvar Text = function(ui, text, size, font, color, x, y) {\n\tthis.textAlign = 'left';\n\tthis.textBaseline = 'alphabetic';\n\n\tthis.text = typeof text !== 'undefined' ? text : '';\n\tthis.size = typeof size !== 'undefined' ? size : 12;\n\tthis.font = typeof font !== 'undefined' ? font : 'Arial';\n\tthis.color = typeof color !== 'undefined' ? color : '#000000';\n\tthis.lineHeight = 1; // Modifier on text size\n\n\tvar x = typeof x !== 'undefined' ? x : 0;\n\tvar y = typeof y !== 'undefined' ? y : 0;\n\n\t// Run DisplayObject constructor on this object\n\tDisplayObject.bind(this)(ui, x, y);\n};\n\nText.prototype = Object.create(DisplayObject.prototype);\n\n/**\n * Draw this Text onto the provided context\n * Used internally by DisplayObject.render\n *\n * @param {CanvasRenderingContext2D} context\n * @param {int} x\n * @param {int} y\n */\n\nText.prototype.draw = function(context, x, y) {\n\tcontext.font = this.size + 'px ' + this.font;\n\tcontext.fillStyle = this.color;\n\tcontext.textAlign = this.textAlign;\n\tcontext.textBaseline = this.textBaseline;\n\n\tvar lines = this.text.split('\\n');\n\n\tvar midLinePoint = 0; // Default to top\n\tif (this.textVerticalAlign === 'center') {\n\t\tmidLinePoint = lines.length / 2 - 0.5;\n\t} else if (this.textVerticalAlign === 'bottom') {\n\t\tmidLinePoint = lines.length - 1;\n\t}\n\n\tfor (var idx = 0;idx < lines.length;idx++) {\n\t\tvar line = lines[idx];\n\t\tvar lineY = y + (idx - midLinePoint) * (this.size * this.lineHeight);\n\t\tcontext.fillText(line, x, lineY);\n\t}\n};\n\n// Export Text as module\nexport default Text;\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/three-ui/Text.js","module.exports = {\"id\":\"boss\",\"width\":64,\"height\":72,\"animations\":{\"atk_right\":{\"length\":6,\"row\":0},\"walk_right\":{\"length\":3,\"row\":1},\"idle_right\":{\"length\":4,\"row\":2},\"atk_up\":{\"length\":5,\"row\":3},\"walk_up\":{\"length\":4,\"row\":4},\"idle_up\":{\"length\":4,\"row\":5},\"atk_down\":{\"length\":6,\"row\":6},\"walk_down\":{\"length\":4,\"row\":7},\"idle_down\":{\"length\":4,\"row\":8},\"Group 5\":{\"length\":3,\"row\":9}},\"offset_x\":-24,\"offset_y\":-36}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/boss.json\n// module id = taTb\n// module chunks = 1","/**\n * Different anchor types for positioning\n */\n\nexport default {\n\tcenter: 1,\n\tleft: 2,\n\tright: 3,\n\ttop: 4,\n\tbottom: 5\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/three-ui/anchors.js","module.exports = {\"id\":\"firefox\",\"width\":32,\"height\":32,\"animations\":{\"atk_right\":{\"length\":5,\"row\":0},\"walk_right\":{\"length\":4,\"row\":1},\"idle_right\":{\"length\":5,\"row\":2},\"atk_up\":{\"length\":5,\"row\":3},\"walk_up\":{\"length\":8,\"row\":4},\"idle_up\":{\"length\":2,\"row\":5},\"atk_down\":{\"length\":5,\"row\":6},\"walk_down\":{\"length\":4,\"row\":7},\"idle_down\":{\"length\":2,\"row\":8}},\"offset_x\":-8,\"offset_y\":-12}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/firefox.json\n// module id = ujQs\n// module chunks = 1","module.exports = {\"id\":\"sword1\",\"width\":32,\"height\":32,\"animations\":{\"atk_right\":{\"length\":5,\"row\":0},\"walk_right\":{\"length\":4,\"row\":1},\"idle_right\":{\"length\":2,\"row\":2},\"atk_up\":{\"length\":5,\"row\":3},\"walk_up\":{\"length\":4,\"row\":4},\"idle_up\":{\"length\":2,\"row\":5},\"atk_down\":{\"length\":5,\"row\":6},\"walk_down\":{\"length\":4,\"row\":7},\"idle_down\":{\"length\":2,\"row\":8}},\"offset_x\":-8,\"offset_y\":-12}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/sword1.json\n// module id = vm1t\n// module chunks = 1","\r\nvar mask = new Int32Array(4096);\r\n\r\nfunction mesher(volume, dims) {\r\n    var vertices = [], faces = []\r\n      , dimsX = dims[0]\r\n      , dimsY = dims[1]\r\n      , dimsXY = dimsX * dimsY;\r\n  \r\n    //Sweep over 3-axes\r\n    for(var d=0; d<3; ++d) {\r\n      var i, j, k, l, w, W, h, n, c\r\n        , u = (d+1)%3\r\n        , v = (d+2)%3\r\n        , x = [0,0,0]\r\n        , q = [0,0,0]\r\n        , du = [0,0,0]\r\n        , dv = [0,0,0]\r\n        , dimsD = dims[d]\r\n        , dimsU = dims[u]\r\n        , dimsV = dims[v]\r\n        , qdimsX, qdimsXY\r\n        , xd\r\n  \r\n      if (mask.length < dimsU * dimsV) {\r\n        mask = new Int32Array(dimsU * dimsV);\r\n      }\r\n  \r\n      q[d] =  1;\r\n      x[d] = -1;\r\n  \r\n      qdimsX  = dimsX  * q[1]\r\n      qdimsXY = dimsXY * q[2]\r\n  \r\n      // Compute mask\r\n      while (x[d] < dimsD) {\r\n        xd = x[d]\r\n        n = 0;\r\n  \r\n        for(x[v] = 0; x[v] < dimsV; ++x[v]) {\r\n          for(x[u] = 0; x[u] < dimsU; ++x[u], ++n) {\r\n            var a = xd >= 0      && volume[x[0]      + dimsX * x[1]          + dimsXY * x[2]          ]\r\n              , b = xd < dimsD-1 && volume[x[0]+q[0] + dimsX * x[1] + qdimsX + dimsXY * x[2] + qdimsXY]\r\n            if (a ? b : !b) {\r\n              mask[n] = 0; continue;\r\n            }\r\n            mask[n] = a ? a : -b;\r\n          }\r\n        }\r\n  \r\n        ++x[d];\r\n  \r\n        // Generate mesh for mask using lexicographic ordering\r\n        n = 0;\r\n        for (j=0; j < dimsV; ++j) {\r\n          for (i=0; i < dimsU; ) {\r\n            c = mask[n];\r\n            if (!c) {\r\n              i++;  n++; continue;\r\n            }\r\n  \r\n            //Compute width\r\n            w = 1;\r\n            while (c === mask[n+w] && i+w < dimsU) w++;\r\n  \r\n            //Compute height (this is slightly awkward)\r\n            for (h=1; j+h < dimsV; ++h) {\r\n              k = 0;\r\n              while (k < w && c === mask[n+k+h*dimsU]) k++\r\n              if (k < w) break;\r\n            }\r\n  \r\n            // Add quad\r\n            // The du/dv arrays are reused/reset\r\n            // for each iteration.\r\n            du[d] = 0; dv[d] = 0;\r\n            x[u]  = i;  x[v] = j;\r\n  \r\n            if (c > 0) {\r\n              dv[v] = h; dv[u] = 0;\r\n              du[u] = w; du[v] = 0;\r\n            } else {\r\n              c = -c;\r\n              du[v] = h; du[u] = 0;\r\n              dv[u] = w; dv[v] = 0;\r\n            }\r\n            var vertex_count = vertices.length;\r\n            vertices.push([x[0],             x[1],             x[2]            ]);\r\n            vertices.push([x[0]+du[0],       x[1]+du[1],       x[2]+du[2]      ]);\r\n            vertices.push([x[0]+du[0]+dv[0], x[1]+du[1]+dv[1], x[2]+du[2]+dv[2]]);\r\n            vertices.push([x[0]      +dv[0], x[1]      +dv[1], x[2]      +dv[2]]);\r\n            faces.push([vertex_count, vertex_count+1, vertex_count+2, vertex_count+3, c]);\r\n  \r\n            //Zero-out mask\r\n            W = n + w;\r\n            for(l=0; l<h; ++l) {\r\n              for(k=n; k<W; ++k) {\r\n                mask[k+l*dimsU] = 0;\r\n              }\r\n            }\r\n  \r\n            //Increment counters and continue\r\n            i += w; n += w;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return { vertices:vertices, faces:faces };\r\n\r\n}\r\n\r\nfunction mesher2(volume, dims) {\r\n \r\n    var vertices = [], faces = [], x = [0,0,0], n = 0;\r\n  for(x[2]=0; x[2]<dims[2]; ++x[2])\r\n  for(x[1]=0; x[1]<dims[1]; ++x[1])\r\n  for(x[0]=0; x[0]<dims[0]; ++x[0], ++n)\r\n  if(!!volume[n]) {\r\n   \r\n\r\n    for(var d=0; d<3; ++d) {\r\n      var t = [x[0], x[1], x[2]]\r\n        , u = [0,0,0]\r\n        , v = [0,0,0];\r\n      u[(d+1)%3] = 1;\r\n      v[(d+2)%3] = 1;\r\n      for(var s=0; s<2; ++s) {\r\n        t[d] = x[d] + s;\r\n       \r\n        var tmp = u;\r\n        u = v;\r\n        v = tmp;\r\n        var vertex_count = vertices.length;\r\n        vertices.push([t[0],           t[1],           t[2]          ]);\r\n        vertices.push([t[0]+u[0],      t[1]+u[1],      t[2]+u[2]     ]);\r\n        vertices.push([t[0]+u[0]+v[0], t[1]+u[1]+v[1], t[2]+u[2]+v[2]]);\r\n        vertices.push([t[0]     +v[0], t[1]     +v[1], t[2]     +v[2]]);\r\n        faces.push([vertex_count+0, vertex_count+1, vertex_count+2, vertex_count+3, volume[n]]);\r\n      }\r\n    }\r\n  }\r\n  return { vertices:vertices, faces:faces };\r\n}\r\n\r\nvar Voxel = function (lo, hi, fn) {\r\n  var dims = [hi[0]-lo[0], hi[1]-lo[1], hi[2]-lo[2]];\r\n  var data = new Array(dims[2] * dims[1] * dims[0]);\r\n\r\n  let n = 0;\r\n\r\n  for (var k = lo[2]; k < hi[2]; k++)\r\n    for (var j = lo[1]; j < hi[1]; j++)\r\n      for(var i = lo[0]; i < hi[0]; i++) {\r\n        data[n] =fn(i, j, k);\r\n        n++;\r\n      }\r\n\r\n  \r\n  return mesher(data, dims);\r\n    \r\n}\r\n\r\nvar Cube = function (lo, hi, fn) {\r\n  var dims = [hi[0]-lo[0], hi[1]-lo[1], hi[2]-lo[2]];\r\n  var data = new Array(dims[2] * dims[1] * dims[0]);\r\n\r\n  let n = 0;\r\n\r\n  for (var k = lo[2]; k < hi[2]; k++)\r\n    for (var j = lo[1]; j < hi[1]; j++)\r\n      for(var i = lo[0]; i < hi[0]; i++) {\r\n        data[n] =fn(i, j, k);\r\n        n++;\r\n      }\r\n\r\n  \r\n  return mesher2(data, dims);\r\n    \r\n}\r\n\r\nexport default {\r\n  build : Voxel,\r\n  buildCube : Cube,\r\n} \n\n\n// WEBPACK FOOTER //\n// ./src/lib/voxel.js","export default class Animation {\r\n    constructor(name, length, row, width, height) {\r\n        this.name = name;\r\n        this.length = length;\r\n        this.row = row;\r\n        this.width = width;\r\n        this.height = height;\r\n        this.reset();\r\n    }\r\n\r\n    tick() {\r\n        var i = this.currentFrame.index;\r\n    \r\n        i = (i < this.length - 1) ? i + 1 : 0;\r\n    \r\n        if(this.count > 0) {\r\n            if(i === 0) {\r\n                this.count -= 1;\r\n                if(this.count === 0) {\r\n                    this.currentFrame.index = 0;\r\n                    this.endcount_callback();\r\n                    return;\r\n                }\r\n            }\r\n        }\r\n\r\n        this.currentFrame.x = this.width * i;\r\n        this.currentFrame.y = this.height * this.row;\r\n        this.currentFrame.index = i;\r\n    }\r\n\r\n    setSpeed(speed) {\r\n        this.speed = speed;\r\n    }\r\n\r\n    setCount(count, onEndCount) {\r\n        this.count = count;\r\n        this.endcount_callback = onEndCount;\r\n    }\r\n\r\n    isTimeToAnimate(time) {\r\n        return (time - this.lastTime) > this.speed;\r\n    }\r\n\r\n    update(time) {\r\n        if(this.lastTime === 0 && this.name.substr(0, 3) === \"atk\") {\r\n            this.lastTime = time;\r\n        }\r\n    \r\n        if(this.isTimeToAnimate(time)) {\r\n            this.lastTime = time;\r\n            this.tick();\r\n            return true;\r\n        } else {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    reset() {\r\n        this.lastTime = 0;\r\n        this.currentFrame = { index: 0, x: 0, y: this.row * this.height };\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/animation.js","module.exports = {\"id\":\"sword\",\"width\":14,\"height\":14,\"animations\":{\"idle_down\":{\"length\":1,\"row\":0}}}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/sword.json\n// module id = wine\n// module chunks = 1","module.exports = {\"id\":\"item-burger\",\"width\":16,\"height\":16,\"animations\":{\"idle\":{\"length\":6,\"row\":0}},\"offset_x\":0,\"offset_y\":0}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/item-burger.json\n// module id = wzZJ\n// module chunks = 1","module.exports = {\"id\":\"loot\",\"width\":14,\"height\":14,\"animations\":{\"idle_down\":{\"length\":1,\"row\":0}}}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/loot.json\n// module id = ySG5\n// module chunks = 1","module.exports = {\"id\":\"bluesword\",\"width\":48,\"height\":48,\"animations\":{\"atk_right\":{\"length\":5,\"row\":0},\"walk_right\":{\"length\":4,\"row\":1},\"idle_right\":{\"length\":2,\"row\":2},\"atk_up\":{\"length\":5,\"row\":3},\"walk_up\":{\"length\":4,\"row\":4},\"idle_up\":{\"length\":2,\"row\":5},\"atk_down\":{\"length\":5,\"row\":6},\"walk_down\":{\"length\":4,\"row\":7},\"idle_down\":{\"length\":2,\"row\":8}},\"offset_x\":-16,\"offset_y\":-20}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/bluesword.json\n// module id = yWNk\n// module chunks = 1","export default {\r\n    Orientations: {\r\n        UP: 1,\r\n        DOWN: 2,\r\n        LEFT: 3,\r\n        RIGHT: 4\r\n    },\r\n\r\n    Entities: {\r\n        PLAYER: 1,\r\n        FIRE: 2,\r\n        CHEST: 3,\r\n\r\n        DEATHKNIGHT:4,\r\n    },\r\n\r\n    BattleState: {\r\n        BEGIN: 1,\r\n        MAIN: 2,\r\n        END: 3,\r\n    }\r\n}\r\n\r\n// 나중에 숫자랑 다 정리하자. 지금은 필요한대로 추가\n\n\n// WEBPACK FOOTER //\n// ./src/share/gametypes.js","module.exports = {\"id\":\"rat\",\"width\":48,\"height\":48,\"animations\":{\"death\":{\"length\":4,\"row\":0},\"atk_right\":{\"length\":6,\"row\":1},\"walk_right\":{\"length\":3,\"row\":2},\"idle_right\":{\"length\":2,\"row\":3},\"atk_up\":{\"length\":4,\"row\":4},\"walk_up\":{\"length\":4,\"row\":5},\"idle_up\":{\"length\":4,\"row\":6},\"atk_down\":{\"length\":4,\"row\":7},\"walk_down\":{\"length\":4,\"row\":8},\"idle_down\":{\"length\":4,\"row\":9}}}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/rat.json\n// module id = zRJz\n// module chunks = 1","import voxel from '../lib/voxel';\r\nimport Entity from './entity';\r\nimport Transition from './transition';\r\nimport Types from '../share/gametypes';\r\nimport Animation from './animation';\r\n\r\nconst getOrientationAsString = function(orientation) {\r\n    switch(orientation) {\r\n        case Types.Orientations.LEFT: return \"left\"; break;\r\n        case Types.Orientations.RIGHT: return \"right\"; break;\r\n        case Types.Orientations.UP: return \"up\"; break;\r\n        case Types.Orientations.DOWN: return \"down\"; break;\r\n    }\r\n};\r\n\r\nexport default class Character extends Entity{\r\n    constructor(id, kind) {\r\n        super(id, kind);\r\n        // position \r\n\r\n        // stat\r\n        \r\n        // position moving\r\n        this.nextGridX = -1;\r\n    \tthis.nextGridY = -1;\r\n        this.orientation = Types.Orientations.DOWN;\r\n\r\n        this.movement = new Transition();\r\n        this.path = null;\r\n        this.newDestination = null;\r\n    \tthis.adjacentTiles = {};\r\n\r\n        // animation speed\r\n        this.animations = {};\r\n        this.currentAnimation = null;\r\n        this.flipSpriteX = false;\r\n        this.flipSpriteY = false;\r\n\r\n        this.moveSpeed = 120;\r\n        this.walkSpeed = 100;\r\n        this.idleSpeed = 450;\r\n\r\n      \r\n        // combat \r\n\r\n        // build mesh\r\n        // 캐릭터는 이미지로부터 복셀을 빌드해서 가지고 있게 된다\r\n        \r\n\r\n    }\r\n\r\n    setSprite(sprite) {\r\n        this.sprite = sprite;\r\n\r\n        for(const name in sprite.data.animations) {\r\n            const a = sprite.data.animations[name];\r\n            this.animations[name] = new Animation(name, a.length, a.row, sprite.data.width, sprite.data.height);\r\n        }\r\n    }\r\n\r\n    getAnimationByName(name) {\r\n        if(name in this.animations) {\r\n            return this.animations[name];\r\n        }\r\n    }\r\n\r\n    setAnimation(name, speed, count, onEndCount) {\r\n        if(this.currentAnimation && this.currentAnimation.name === name) {\r\n            return;\r\n        }\r\n    \r\n        const a = this.getAnimationByName(name);\r\n\r\n        if(a) {\r\n            this.currentAnimation = a;\r\n            if(name.substr(0, 3) === \"atk\") {\r\n                this.currentAnimation.reset();\r\n            }\r\n            this.currentAnimation.setSpeed(speed);\r\n            this.currentAnimation.setCount(count ? count : 0, onEndCount || function() {\r\n                this.idle();\r\n            });\r\n        }\r\n    }\r\n\r\n    animate(animation, speed, count, onEndCount) {\r\n        const oriented = ['atk', 'walk', 'idle'];\r\n        const o = this.orientation;\r\n        \r\n        if(!(this.currentAnimation && this.currentAnimation.name === \"death\")) { // don't change animation if the character is dying\r\n            this.flipSpriteX = false;\r\n            this.flipSpriteY = false;\r\n    \r\n            if(_.indexOf(oriented, animation) >= 0) {\r\n                animation += \"_\" + (o === Types.Orientations.LEFT ? \"right\" : getOrientationAsString(o));\r\n                this.flipSpriteX = (this.orientation === Types.Orientations.LEFT) ? true : false;\r\n            }\r\n\r\n            this.setAnimation(animation, speed, count, onEndCount);\r\n        }\r\n    }\r\n\r\n    /*getFramePixelData() {\r\n        // 주어진 위치의 데이터를 복사해온다\r\n        const canvas = document.createElement('canvas');\r\n        canvas.width = this.sprite.width;\r\n        canvas.height = this.sprite.height;\r\n        \r\n        const context = canvas.getContext('2d');\r\n        context.translate(0, this.sprite.height);\r\n        context.scale(1, -1);\r\n\r\n        context.drawImage(this.sprite.image, 0, 0);\r\n        // 프레임 데이터를 가져온다\r\n        // 원래는 json 으로 가져와야 하는데.. 일단 이부분은 하드코딩해서 진행\r\n        const frameWidth = 32;\r\n        const frameheight = 32;\r\n        const data = context.getImageData(0, 0, frameWidth, frameheight);\r\n\r\n        return data;\r\n    }*/\r\n\r\n    buildMesh() {\r\n        if (this.sprite) {\r\n            /*const data = this.getFramePixelData();\r\n            const result = voxel.build([0,0,0], [data.width,data.height,1], function(x, y, z) {\r\n                const p = (x + y*data.width)*4;\r\n                const r = data.data[p + 0];\r\n                const g = data.data[p + 1];\r\n                const b = data.data[p + 2];\r\n                const a = data.data[p + 3];\r\n                \r\n                return a === 255 ? (r << 16) + (g << 8) + b : 0;\r\n            });\r\n\r\n            const geometry = new THREE.Geometry();\r\n            for(let i=0; i<result.vertices.length; ++i) {\r\n                const q = result.vertices[i];\r\n                geometry.vertices.push(new THREE.Vector3(q[0], q[1], q[2]));\r\n            }\r\n            for(let i=0; i<result.faces.length; ++i) {\r\n                const q = result.faces[i];\r\n                const color = new THREE.Color(q[4]);\r\n\r\n                const f1 = new THREE.Face3(q[0], q[1], q[2]);\r\n                f1.color = color;\r\n                f1.vertexColors = [color, color,color];\r\n                geometry.faces.push(f1);\r\n\r\n                const f2 = new THREE.Face3(q[2], q[3], q[0]);\r\n                f2.color = color;\r\n                f2.vertexColors = [color, color,color];\r\n                geometry.faces.push(f2);\r\n            }\r\n\r\n            geometry.computeFaceNormals();\r\n\r\n            geometry.verticesNeedUpdate = true;\r\n            geometry.elementsNeedUpdate = true;\r\n            geometry.normalsNeedUpdate = true;\r\n            \r\n            geometry.computeBoundingBox();\r\n\r\n            const material\t= new THREE.MeshLambertMaterial({\r\n                vertexColors: true\r\n            });\r\n\r\n            const mesh\t= new THREE.Mesh( geometry, material );\r\n            mesh.doubleSided = false;\r\n            mesh.castShadow = true;\r\n\r\n            // 바운딩 박스의 중앙으로 좌표를 옮긴다\r\n            const min = geometry.boundingBox.min;\r\n            const max = geometry.boundingBox.max;\r\n\r\n            // TODO : 오프셋도 나중에 데이터와 시켜야 한다\r\n            this.offset = {\r\n                x: -16,\r\n                y: -min.y,\r\n                z: 0,\r\n            }\r\n            \r\n            this.mesh = mesh;\r\n\r\n            // 쉐터링 객체를 만든다\r\n            const cubeData = voxel.buildCube([0,0,0], [data.width,data.height,1], function(x, y, z) {\r\n                const p = (x + y*data.width)*4;\r\n                const r = data.data[p + 0];\r\n                const g = data.data[p + 1];\r\n                const b = data.data[p + 2];\r\n                const a = data.data[p + 3];\r\n                \r\n                return a === 255 ? (r << 16) + (g << 8) + b : 0;\r\n            });\r\n\r\n            const shatters = [];\r\n            const _material = material.clone();\r\n            for (let j = 0; j < (cubeData.vertices.length/24); ++j) {\r\n                \r\n                const result = cubeData;\r\n                const voffset = j*24;\r\n                const geometry = new THREE.Geometry(); \r\n                for(let i=0; i<24; ++i) {\r\n                   \r\n                    const q = result.vertices[i + voffset];\r\n                    geometry.vertices.push(new THREE.Vector3(q[0], q[1], q[2]));\r\n                }\r\n                for(let i=0; i< 6; ++i) {\r\n                    const offset = j*6;\r\n                    const q = result.faces[i + offset];\r\n                    const color = new THREE.Color(q[4]);\r\n    \r\n                    const f1 = new THREE.Face3(q[0]-voffset, q[1]-voffset, q[2]-voffset);\r\n                    f1.color = color;\r\n                    f1.vertexColors = [color, color,color];\r\n                    geometry.faces.push(f1);\r\n    \r\n                    const f2 = new THREE.Face3(q[2]-voffset, q[3]-voffset, q[0]-voffset);\r\n                    f2.color = color;\r\n                    f2.vertexColors = [color, color,color];\r\n                    geometry.faces.push(f2);\r\n\r\n                    \r\n                }\r\n                geometry.computeFaceNormals();\r\n                geometry.computeBoundingBox();\r\n                \r\n                const mesh\t= new THREE.Mesh( geometry, _material );\r\n                mesh.castShadow = true;\r\n                shatters.push(mesh);\r\n\r\n                // 포지션을 반경 5 에 적절히 흩어놓자\r\n                const v = Math.random() * Math.PI * 2;\r\n                const r = Math.random() * 12;\r\n                mesh.position.set(r * Math.cos(v), -geometry.boundingBox.min.y,  r * Math.sin(v));\r\n                this.shatters = shatters;\r\n            }*/\r\n\r\n            const scale = 0.6;\r\n\r\n            const group = new THREE.Group();\r\n\r\n            const geometry = new THREE.PlaneGeometry( this.sprite.data.width, this.sprite.data.height );\r\n            geometry.computeFaceNormals();\r\n            geometry.computeBoundingBox();\r\n                    \r\n            const tex = new THREE.Texture();\r\n            tex.image = this.sprite.image;\r\n            tex.format = THREE.RGBAFormat;\r\n            tex.needsUpdate  = true;\r\n            tex.wrapS = tex.wrapT = THREE.RepeatWrapping;\r\n\r\n            const column = this.sprite.width / this.sprite.data.width;\r\n            const row = this.sprite.height / this.sprite.data.height;\r\n\r\n            tex.repeat.set(1/column, 1/row);\r\n            tex.magFilter = THREE.NearestFilter;\r\n            tex.minFilter = THREE.NearestMipMapNearestFilter ;\r\n\r\n            const material = new THREE.MeshStandardMaterial({ map: tex, transparent: true });\r\n            const mesh = new THREE.Mesh( geometry, material );\r\n            mesh.scale.x = scale;\r\n            mesh.scale.y = scale;\r\n            group.add(mesh);\r\n\r\n            /*// 그림자용 메쉬\r\n            const geometryShadow = new THREE.SphereGeometry( 1, 16, 16 );\r\n            const materialShadow = new THREE.MeshBasicMaterial({transparent: true, opacity: 0});\r\n            const shadow = new THREE.Mesh( geometryShadow, materialShadow );\r\n            shadow.scale.set( this.sprite.data.width/2.3, this.sprite.data.height/2.3, this.sprite.data.width/2.3);\r\n            shadow.castShadow = true;\r\n            mesh.add(shadow);*/\r\n\r\n            this.mesh = group;\r\n            this.texture = mesh.material.map;\r\n            this.spriteMesh = mesh;\r\n            \r\n            this.offset = {\r\n                x: 0,\r\n                y: -this.sprite.data.offset_y * scale || 0,\r\n                z: 0,\r\n            }\r\n        }\r\n    }\r\n\r\n    requestPathfindingTo(x, y) {\r\n        if(this.request_path_callback) {\r\n            return this.request_path_callback(x, y);\r\n        } else {\r\n            return [];  \r\n        }\r\n    }\r\n\r\n    onRequestPath(callback) {\r\n        this.request_path_callback = callback;\r\n    }\r\n\r\n    onStartPathing(callback) {\r\n        this.start_pathing_callback = callback;\r\n    }\r\n\r\n    onStopPathing(callback) {\r\n        this.stop_pathing_callback = callback;\r\n    }\r\n\r\n    onBeforeStep(callback) {\r\n        this.before_step_callback = callback;\r\n    }\r\n\r\n    onStep(callback) {\r\n        this.step_callback = callback;\r\n    }\r\n\r\n    isMoving() {\r\n        return !(this.path === null);\r\n    }\r\n\r\n    hasMoved() {\r\n        if(this.hasmoved_callback) {\r\n            this.hasmoved_callback(this);\r\n        }\r\n    }\r\n\r\n    hasNextStep() {\r\n        return (this.path.length - 1 > this.step);\r\n    }\r\n\r\n    hasChangedItsPath() {\r\n        return !(this.newDestination === null);\r\n    }\r\n\r\n    setOrientation(orientation) {\r\n        if(orientation) {\r\n            this.orientation = orientation;\r\n        }\r\n    }\r\n\r\n    idle(orientation) {\r\n        this.setOrientation(orientation);\r\n        this.animate(\"idle\", this.idleSpeed);\r\n    }\r\n\r\n    walk(orientation) {\r\n        this.setOrientation(orientation);\r\n        this.animate(\"walk\", this.walkSpeed);\r\n    }\r\n\r\n    go(x, y) {\r\n        if(this.followingMode) {\r\n            this.followingMode = false;\r\n            this.target = null;\r\n        }\r\n        this.moveTo(x, y);\r\n    }\r\n\r\n    follow(entity) {\r\n        if(entity) {\r\n            this.followingMode = true;\r\n            this.moveTo(entity.gridX, entity.gridY);\r\n        }\r\n    }\r\n\r\n    moveTo(x, y) {\r\n        this.destination = { gridX: x, gridY: y };\r\n\r\n        if(this.isMoving()) {\r\n            this.continueTo(x, y);\r\n        } else {\r\n            const path = this.requestPathfindingTo(x, y);\r\n            this.followPath(path);\r\n        }\r\n    }\r\n\r\n    stop() {\r\n        if(this.isMoving()) {\r\n            this.interrupted = true;\r\n        }\r\n    }\r\n\r\n    continueTo(x, y) {\r\n        this.newDestination = { x: x, y: y };\r\n    }\r\n\r\n    updateMovement() {\r\n        const p = this.path;\r\n        const i = this.step;\r\n    \r\n        if(p[i][0] < p[i-1][0]) {\r\n            this.walk(Types.Orientations.LEFT);\r\n        }\r\n        if(p[i][0] > p[i-1][0]) {\r\n            this.walk(Types.Orientations.RIGHT);\r\n        }\r\n        if(p[i][1] < p[i-1][1]) {\r\n            this.walk(Types.Orientations.UP);\r\n        }\r\n        if(p[i][1] > p[i-1][1]) {\r\n            this.walk(Types.Orientations.DOWN);\r\n        }\r\n    }\r\n\r\n    followPath(path) {\r\n        if(path.length > 1) { // Length of 1 means the player has clicked on himself\r\n            this.path = path;\r\n            this.step = 0;\r\n\r\n            if(this.followingMode) {\r\n                // 오브젝트를 향해 갈때는 제일 마지막 위치가 해당 오브젝트가 있는 위치이기 직전에서 멈추도록 한다\r\n                path.pop();\r\n            }\r\n        \r\n            if(this.start_pathing_callback) {\r\n                this.start_pathing_callback(path);\r\n            }\r\n            this.nextStep();\r\n        }\r\n    }\r\n\r\n    nextStep() {\r\n        let stop = false;\r\n        \r\n        if(this.isMoving()) {\r\n            if(this.before_step_callback) {\r\n                this.before_step_callback();\r\n            }\r\n        \r\n            this.updatePositionOnGrid();\r\n           \r\n            if(this.interrupted) { // if Character.stop() has been called\r\n                stop = true;\r\n                this.interrupted = false;\r\n            } \r\n            else {\r\n                if(this.hasNextStep()) {\r\n                    this.nextGridX = this.path[this.step+1][0];\r\n                    this.nextGridY = this.path[this.step+1][1];\r\n                }\r\n        \r\n                if(this.step_callback) {\r\n                    this.step_callback();\r\n                }\r\n            \r\n                if(this.hasChangedItsPath()) {\r\n                    const x = this.newDestination.x;\r\n                    const y = this.newDestination.y;\r\n                    const path = this.requestPathfindingTo(x, y);\r\n            \r\n                    this.newDestination = null;\r\n                    if(path.length < 2) {\r\n                        stop = true;\r\n                    }\r\n                    else {\r\n                        this.followPath(path);\r\n                    }\r\n                }\r\n                else if(this.hasNextStep()) {\r\n                    this.step += 1;\r\n                    this.updateMovement();\r\n                }\r\n                else {\r\n                    stop = true;\r\n                }\r\n            }\r\n        \r\n            if(stop) { // Path is complete or has been interrupted\r\n                this.path = null;\r\n                this.idle();\r\n            \r\n                if(this.stop_pathing_callback) {\r\n                    this.stop_pathing_callback(this.gridX, this.gridY);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    updatePositionOnGrid() {\r\n        this.setGridPosition(this.path[this.step][0], this.path[this.step][1]);\r\n    }\r\n\r\n    setTarget(target) {\r\n        if(this.target !== target) { // If it's not already set as the target\r\n            this.target = target;\r\n        }\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/character.js"],"sourceRoot":""}